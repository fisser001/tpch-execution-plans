-------------------------------------- CREATED PATH IF NOT EXIST ---------------------------------
-------------------------------------- CREATED PATH IF NOT EXIST ---------------------------------
-------------------------------------- drill_denormal_query_sf1_result_explain.txt ---------------------------------
-------------------------------------- drill_denormal_query_sf1_result_explain.txt ---------------------------------
-------------------------------------- DRILL QUERY DENORMAL ---------------------------------
-------------------------------------- DRILL QUERY DENORMAL ---------------------------------
13/04/2019 12:55:41.763

--------------------------------------STARTED QUERY 1. ---------------------------------
13/04/2019 12:55:41.771
Apr 13, 2019 12:55:42 PM org.jline.utils.Log logr
WARNING: Unable to create a system terminal, creating a dumb terminal (enable debug logging for more information)
Apache Drill 1.15.0
"Just Drill It."
0: jdbc:drill:zk=zookeeper:2181> explain plan for select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty,  sum(l_extendedprice) as sum_base_price,  sum(l_extendedprice*(1-l_discount)) as sum_disc_price,  sum(l_extendedprice*(1-l_discount)*(1+l_tax)) as sum_charge,  avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price,  avg(l_discount) as avg_disc, count(*)[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m[1m                                      text                                      [m[1;32m | [m[1m                                      json                                      [m[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m00-00    Screen
00-01      Project(l_returnflag=[$0], l_linestatus=[$1], sum_qty=[$2], sum_base_price=[$3], sum_disc_price=[$4], sum_charge=[$5], avg_qty=[$6], avg_price=[$7], avg_disc=[$8], count_order=[$9])
00-02        SingleMergeExchange(sort0=[0], sort1=[1])
01-01          OrderedMuxExchange(sort0=[0], sort1=[1])
02-01            SelectionVectorRemover
02-02              Sort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[ASC])
02-03                Project(l_returnflag=[$0], l_linestatus=[$1], sum_qty=[CASE(=($3, 0), null, $2)], sum_base_price=[CASE(=($5, 0), null, $4)], sum_disc_price=[CASE(=($7, 0), null, $6)], sum_charge=[CASE(=($9, 0), null, $8)], avg_qty=[divide(CastHigh(CASE(=($3, 0), null, $2)), $3)], avg_price=[divide(CastHigh(CASE(=($5, 0), null, $4)), $5)], avg_disc=[divide(CastHigh(CASE(=($11, 0), null, $10)), $11)], count_order=[$12])
02-04                  HashAgg(group=[{0, 1}], agg#0=[$SUM0($2)], agg#1=[$SUM0($3)], agg#2=[$SUM0($4)], agg#3=[$SUM0($5)], agg#4=[$SUM0($6)], agg#5=[$SUM0($7)], agg#6=[$SUM0($8)], agg#7=[$SUM0($9)], agg#8=[$SUM0($10)], agg#9=[$SUM0($11)], count_order=[$SUM0($12)])
02-05                    HashToRandomExchange(dist0=[[$0]], dist1=[[$1]])
03-01                      HashAgg(group=[{0, 1}], agg#0=[$SUM0($2)], agg#1=[COUNT($2)], agg#2=[$SUM0($3)], agg#3=[COUNT($3)], agg#4=[$SUM0($4)], agg#5=[COUNT($4)], agg#6=[$SUM0($5)], agg#7=[COUNT($5)], agg#8=[$SUM0($6)], agg#9=[COUNT($6)], count_order=[COUNT()])
03-02                        Project(l_returnflag=[$4], l_linestatus=[$5], l_quantity=[$0], l_extendedprice=[$1], $f4=[*($1, -(1, $2))], $f5=[*(*($1, -(1, $2)), +(1, $3))], l_discount=[$2])
03-03                          SelectionVectorRemover
03-04                            Filter(condition=[<=($6, 1998-09-02)])
03-05                              Project(l_quantity=[$0], l_extendedprice=[$1], l_discount=[$2], l_tax=[$3], l_returnflag=[$4], l_linestatus=[$5], l_shipdate=[$6])
03-06                                Scan(table=[[hive, denormalized_parquet]], groupscan=[HiveDrillNativeParquetScan [entries=[ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000000_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000001_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000002_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000003_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000004_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000005_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000006_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000007_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000008_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000009_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000010_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000011_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000012_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000013_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000014_0]], numFiles=15, numRowGroups=16, columns=[`l_quantity`, `l_extendedprice`, `l_discount`, `l_tax`, `l_returnflag`, `l_linestatus`, `l_shipdate`]]])
[1;32m | [m{
  "head" : {
    "version" : 1,
    "generator" : {
      "type" : "ExplainHandler",
      "info" : ""
    },
    "type" : "APACHE_DRILL_PHYSICAL",
    "options" : [ ],
    "queue" : 0,
    "hasResourcePlan" : false,
    "resultMode" : "EXEC"
  },
  "graph" : [ {
    "pop" : "hive-drill-native-parquet-scan",
    "@id" : 196614,
    "userName" : "root",
    "hiveStoragePluginConfig" : {
      "type" : "hive",
      "configProps" : {
        "hive.metastore.uris" : "thrift://hive-metastore:9083",
        "hive.metastore.sasl.enabled" : "false",
        "fs.default.name" : "hdfs://namenode"
      },
      "enabled" : true
    },
    "columns" : [ "`l_quantity`", "`l_extendedprice`", "`l_discount`", "`l_tax`", "`l_returnflag`", "`l_linestatus`", "`l_shipdate`" ],
    "entries" : [ {
      "path" : "/user/hive/warehouse/denormalized_parquet/000000_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000001_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000002_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000003_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000004_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000005_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000006_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000007_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000008_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000009_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000010_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000011_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000012_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000013_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000014_0"
    } ],
    "hivePartitionHolder" : {
      "keyToIndexMapper" : { },
      "partitionValues" : [ ]
    },
    "confProperties" : { },
    "cost" : 6051219.0
  }, {
    "pop" : "project",
    "@id" : 196613,
    "exprs" : [ {
      "ref" : "`l_quantity`",
      "expr" : "`l_quantity`"
    }, {
      "ref" : "`l_extendedprice`",
      "expr" : "`l_extendedprice`"
    }, {
      "ref" : "`l_discount`",
      "expr" : "`l_discount`"
    }, {
      "ref" : "`l_tax`",
      "expr" : "`l_tax`"
    }, {
      "ref" : "`l_returnflag`",
      "expr" : "`l_returnflag`"
    }, {
      "ref" : "`l_linestatus`",
      "expr" : "`l_linestatus`"
    }, {
      "ref" : "`l_shipdate`",
      "expr" : "`l_shipdate`"
    } ],
    "child" : 196614,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 6051219.0
  }, {
    "pop" : "filter",
    "@id" : 196612,
    "child" : 196613,
    "expr" : "less_than_or_equal_to(`l_shipdate`, cast( 904694400000 as DATE)) ",
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 3025609.5
  }, {
    "pop" : "selection-vector-remover",
    "@id" : 196611,
    "child" : 196612,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 3025609.5
  }, {
    "pop" : "project",
    "@id" : 196610,
    "exprs" : [ {
      "ref" : "`l_returnflag`",
      "expr" : "`l_returnflag`"
    }, {
      "ref" : "`l_linestatus`",
      "expr" : "`l_linestatus`"
    }, {
      "ref" : "`l_quantity`",
      "expr" : "`l_quantity`"
    }, {
      "ref" : "`l_extendedprice`",
      "expr" : "`l_extendedprice`"
    }, {
      "ref" : "`$f4`",
      "expr" : "multiply(`l_extendedprice`, subtract(1, `l_discount`) ) "
    }, {
      "ref" : "`$f5`",
      "expr" : "multiply(multiply(`l_extendedprice`, subtract(1, `l_discount`) ) , add(1, `l_tax`) ) "
    }, {
      "ref" : "`l_discount`",
      "expr" : "`l_discount`"
    } ],
    "child" : 196611,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 3025609.5
  }, {
    "pop" : "hash-aggregate",
    "@id" : 196609,
    "child" : 196610,
    "cardinality" : 1.0,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "aggPhase" : "PHASE_1of2",
    "groupByExprs" : [ {
      "ref" : "`l_returnflag`",
      "expr" : "`l_returnflag`"
    }, {
      "ref" : "`l_linestatus`",
      "expr" : "`l_linestatus`"
    } ],
    "aggrExprs" : [ {
      "ref" : "`$f2`",
      "expr" : "$sum0(`l_quantity`) "
    }, {
      "ref" : "`$f3`",
      "expr" : "count(`l_quantity`) "
    }, {
      "ref" : "`$f4`",
      "expr" : "$sum0(`l_extendedprice`) "
    }, {
      "ref" : "`$f5`",
      "expr" : "count(`l_extendedprice`) "
    }, {
      "ref" : "`$f6`",
      "expr" : "$sum0(`$f4`) "
    }, {
      "ref" : "`$f7`",
      "expr" : "count(`$f4`) "
    }, {
      "ref" : "`$f8`",
      "expr" : "$sum0(`$f5`) "
    }, {
      "ref" : "`$f9`",
      "expr" : "count(`$f5`) "
    }, {
      "ref" : "`$f10`",
      "expr" : "$sum0(`l_discount`) "
    }, {
      "ref" : "`$f11`",
      "expr" : "count(`l_discount`) "
    }, {
      "ref" : "`count_order`",
      "expr" : "count(1) "
    } ],
    "cost" : 2269207.125
  }, {
    "pop" : "hash-to-random-exchange",
    "@id" : 131077,
    "child" : 196609,
    "expr" : "hash32AsDouble(`l_linestatus`, hash32AsDouble(`l_returnflag`, 1301011) ) ",
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 302560.95
  }, {
    "pop" : "hash-aggregate",
    "@id" : 131076,
    "child" : 131077,
    "cardinality" : 1.0,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "aggPhase" : "PHASE_2of2",
    "groupByExprs" : [ {
      "ref" : "`l_returnflag`",
      "expr" : "`l_returnflag`"
    }, {
      "ref" : "`l_linestatus`",
      "expr" : "`l_linestatus`"
    } ],
    "aggrExprs" : [ {
      "ref" : "`$f2`",
      "expr" : "$sum0(`$f2`) "
    }, {
      "ref" : "`$f3`",
      "expr" : "$sum0(`$f3`) "
    }, {
      "ref" : "`$f4`",
      "expr" : "$sum0(`$f4`) "
    }, {
      "ref" : "`$f5`",
      "expr" : "$sum0(`$f5`) "
    }, {
      "ref" : "`$f6`",
      "expr" : "$sum0(`$f6`) "
    }, {
      "ref" : "`$f7`",
      "expr" : "$sum0(`$f7`) "
    }, {
      "ref" : "`$f8`",
      "expr" : "$sum0(`$f8`) "
    }, {
      "ref" : "`$f9`",
      "expr" : "$sum0(`$f9`) "
    }, {
      "ref" : "`$f10`",
      "expr" : "$sum0(`$f10`) "
    }, {
      "ref" : "`$f11`",
      "expr" : "$sum0(`$f11`) "
    }, {
      "ref" : "`count_order`",
      "expr" : "$sum0(`count_order`) "
    } ],
    "cost" : 226920.7125000[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
1 row selected (0.56 seconds)
0: jdbc:drill:zk=zookeeper:2181> Closing: org.apache.drill.jdbc.impl.DrillConnectionImpl
13/04/2019 12:55:45.808
--------------------------------------Finished QUERY 1.--------------------------------

--------------------------------------STARTED QUERY 2. ---------------------------------
--------------------------------------Finished QUERY 2.--------------------------------

--------------------------------------STARTED QUERY 3. ---------------------------------
13/04/2019 12:55:45.826
Apr 13, 2019 12:55:46 PM org.jline.utils.Log logr
WARNING: Unable to create a system terminal, creating a dumb terminal (enable debug logging for more information)
Apache Drill 1.15.0
"You told me to, Drill Sergeant!"
0: jdbc:drill:zk=zookeeper:2181> explain plan for select o_orderkey, sum(l_extendedprice*(1-l_discount))[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m[1m                                      text                                      [m[1;32m | [m[1m                                      json                                      [m[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m00-00    Screen
00-01      Project(o_orderkey=[$0], revenue=[$1], o_orderdate=[$2], o_shippriority=[$3])
00-02        SelectionVectorRemover
00-03          Limit(fetch=[10])
00-04            Limit(fetch=[10])
00-05              SelectionVectorRemover
00-06                TopN(limit=[10])
00-07                  Project(o_orderkey=[$0], revenue=[$3], o_orderdate=[$1], o_shippriority=[$2])
00-08                    HashAgg(group=[{0, 1, 2}], revenue=[SUM($3)])
00-09                      Project(o_orderkey=[$0], o_orderdate=[$1], o_shippriority=[$2], revenue=[$3])
00-10                        HashToRandomExchange(dist0=[[$0]], dist1=[[$1]], dist2=[[$2]])
01-01                          UnorderedMuxExchange
02-01                            Project(o_orderkey=[$0], o_orderdate=[$1], o_shippriority=[$2], revenue=[$3], E_X_P_R_H_A_S_H_F_I_E_L_D=[hash32AsDouble($2, hash32AsDouble($1, hash32AsDouble($0, 1301011)))])
02-02                              HashAgg(group=[{0, 1, 2}], revenue=[SUM($3)])
02-03                                Project(o_orderkey=[$1], o_orderdate=[$2], o_shippriority=[$3], $f3=[*($4, -(1, $5))])
02-04                                  SelectionVectorRemover
02-05                                    Filter(condition=[AND(=($0, 'BUILDING'), <($2, 1995-03-15), >($6, 1995-03-15))])
02-06                                      Project(c_mktsegment=[$0], o_orderkey=[$1], o_orderdate=[$2], o_shippriority=[$3], l_extendedprice=[$4], l_discount=[$5], l_shipdate=[$6])
02-07                                        Scan(table=[[hive, denormalized_parquet]], groupscan=[HiveDrillNativeParquetScan [entries=[ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000000_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000001_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000002_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000003_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000004_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000005_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000006_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000007_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000008_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000009_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000010_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000011_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000012_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000013_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000014_0]], numFiles=15, numRowGroups=16, columns=[`c_mktsegment`, `o_orderkey`, `o_orderdate`, `o_shippriority`, `l_extendedprice`, `l_discount`, `l_shipdate`]]])
[1;32m | [m{
  "head" : {
    "version" : 1,
    "generator" : {
      "type" : "ExplainHandler",
      "info" : ""
    },
    "type" : "APACHE_DRILL_PHYSICAL",
    "options" : [ ],
    "queue" : 0,
    "hasResourcePlan" : false,
    "resultMode" : "EXEC"
  },
  "graph" : [ {
    "pop" : "hive-drill-native-parquet-scan",
    "@id" : 131079,
    "userName" : "root",
    "hiveStoragePluginConfig" : {
      "type" : "hive",
      "configProps" : {
        "hive.metastore.uris" : "thrift://hive-metastore:9083",
        "hive.metastore.sasl.enabled" : "false",
        "fs.default.name" : "hdfs://namenode"
      },
      "enabled" : true
    },
    "columns" : [ "`c_mktsegment`", "`o_orderkey`", "`o_orderdate`", "`o_shippriority`", "`l_extendedprice`", "`l_discount`", "`l_shipdate`" ],
    "entries" : [ {
      "path" : "/user/hive/warehouse/denormalized_parquet/000000_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000001_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000002_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000003_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000004_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000005_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000006_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000007_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000008_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000009_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000010_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000011_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000012_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000013_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000014_0"
    } ],
    "hivePartitionHolder" : {
      "keyToIndexMapper" : { },
      "partitionValues" : [ ]
    },
    "confProperties" : { },
    "cost" : 6051219.0
  }, {
    "pop" : "project",
    "@id" : 131078,
    "exprs" : [ {
      "ref" : "`c_mktsegment`",
      "expr" : "`c_mktsegment`"
    }, {
      "ref" : "`o_orderkey`",
      "expr" : "`o_orderkey`"
    }, {
      "ref" : "`o_orderdate`",
      "expr" : "`o_orderdate`"
    }, {
      "ref" : "`o_shippriority`",
      "expr" : "`o_shippriority`"
    }, {
      "ref" : "`l_extendedprice`",
      "expr" : "`l_extendedprice`"
    }, {
      "ref" : "`l_discount`",
      "expr" : "`l_discount`"
    }, {
      "ref" : "`l_shipdate`",
      "expr" : "`l_shipdate`"
    } ],
    "child" : 131079,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 6051219.0
  }, {
    "pop" : "filter",
    "@id" : 131077,
    "child" : 131078,
    "expr" : "booleanAnd(equal(`c_mktsegment`, 'BUILDING') , less_than(`o_orderdate`, cast( 795225600000 as DATE)) , greater_than(`l_shipdate`, cast( 795225600000 as DATE)) ) ",
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 226920.7125
  }, {
    "pop" : "selection-vector-remover",
    "@id" : 131076,
    "child" : 131077,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 226920.7125
  }, {
    "pop" : "project",
    "@id" : 131075,
    "exprs" : [ {
      "ref" : "`o_orderkey`",
      "expr" : "`o_orderkey`"
    }, {
      "ref" : "`o_orderdate`",
      "expr" : "`o_orderdate`"
    }, {
      "ref" : "`o_shippriority`",
      "expr" : "`o_shippriority`"
    }, {
      "ref" : "`$f3`",
      "expr" : "multiply(`l_extendedprice`, subtract(1, `l_discount`) ) "
    } ],
    "child" : 131076,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 226920.7125
  }, {
    "pop" : "hash-aggregate",
    "@id" : 131074,
    "child" : 131075,
    "cardinality" : 1.0,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "aggPhase" : "PHASE_1of2",
    "groupByExprs" : [ {
      "ref" : "`o_orderkey`",
      "expr" : "`o_orderkey`"
    }, {
      "ref" : "`o_orderdate`",
      "expr" : "`o_orderdate`"
    }, {
      "ref" : "`o_shippriority`",
      "expr" : "`o_shippriority`"
    } ],
    "aggrExprs" : [ {
      "ref" : "`revenue`",
      "expr" : "sum(`$f3`) "
    } ],
    "cost" : 198555.6234375
  }, {
    "pop" : "project",
    "@id" : 131073,
    "exprs" : [ {
      "ref" : "`o_orderkey`",
      "expr" : "`o_orderkey`"
    }, {
      "ref" : "`o_orderdate`",
      "expr" : "`o_orderdate`"
    }, {
      "ref" : "`o_shippriority`",
      "expr" : "`o_shippriority`"
    }, {
      "ref" : "`revenue`",
      "expr" : "`revenue`"
    }, {
      "ref" : "`E_X_P_R_H_A_S_H_F_I_E_L_D`",
      "expr" : "hash32asdouble(`o_shippriority`, hash32asdouble(`o_orderdate`, hash32asdouble(`o_orderkey`, 1301011) ) ) "
    } ],
    "child" : 131074,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 22692.07125
  }, {
    "pop" : "unordered-mux-exchange",
    "@id" : 65537,
    "child" : 131073,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 22692.07125
  }, {
    "pop" : "hash-to-random-exchange",
    "@id" : 10,
    "child" : 65537,
    "expr" : "`E_X_P_R_H_A_S_H_F_I_E_L_D`",
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 22692.07125
  }, {
    "pop" : "project",
    "@id" : 9,
    "exprs" : [ {
      "ref" : "`o_orderkey`",
      "expr" : "`o_orderkey`"
    }, {
      "ref" : "`o_orderdate`",
      "expr" : "`o_orderdate`"
    }, {
      "ref" : "`o_shippriority`",
      "expr" : "`o_shippriority`"
    }, {
      "ref" : "`revenue`",
      "expr" : "`revenue`"
    } ],
    "child" : 10,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 22692.07125
  }, {
    "pop" : "hash-aggregate",
    "@id" : 8,
    "child" : 9,
    "cardinality" : 1.0,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "aggPhase" : "PHASE_2of2",
    "groupByExprs" : [ {
      "ref" : "`o_orderkey`",
      "expr" : "`o_orderkey`"
    }, {
      "ref" : "`o_orderdate`",
      "expr" : "`o_orderdate`"
    }, {
      "ref" : "`o_shippriority`",
      "expr" : "`o_shippriority`"
    } ],
    "aggrExprs" : [ {
      "ref" : "`revenue`",
      "expr" : "sum(`revenue`) "
    } ],
    "cost" : 19855.56234375
  }, {
    "pop" : "project",
    "@id" : 7,
    "exprs" : [ {
      "ref" : "`o_orderkey`",
      "expr" : "`o_orderkey`"
    }, {
      "ref" : "`revenue`",
      "expr" : "`revenue`"
    }, {
      "ref" : "`o_orderdate`",
      "expr" : "`o_orderdate`"
    }, {
      "ref" : "`o_shippriority`",
      "expr" : "`o_shippriority`"
    } ],
    "child" : 8,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 2269.207125
  }, {
    "pop" : "top-n[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
1 row selected (0.471 seconds)
0: jdbc:drill:zk=zookeeper:2181> Closing: org.apache.drill.jdbc.impl.DrillConnectionImpl
13/04/2019 12:55:49.809
--------------------------------------Finished QUERY 3.--------------------------------

--------------------------------------STARTED QUERY 4. ---------------------------------
13/04/2019 12:55:49.819
Apr 13, 2019 12:55:50 PM org.jline.utils.Log logr
WARNING: Unable to create a system terminal, creating a dumb terminal (enable debug logging for more information)
Apache Drill 1.15.0
"You told me to, Drill Sergeant!"
0: jdbc:drill:zk=zookeeper:2181> explain plan for select o_orderpriority, count (distinct o_orderkey)[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m[1m                                      text                                      [m[1;32m | [m[1m                                      json                                      [m[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m00-00    Screen
00-01      Project(o_orderpriority=[$0], order_count=[$1])
00-02        SelectionVectorRemover
00-03          Sort(sort0=[$0], dir0=[ASC])
00-04            HashAgg(group=[{0}], order_count=[$SUM0($1)])
00-05              HashAgg(group=[{0}], order_count=[COUNT($1)])
00-06                HashAgg(group=[{0, 1}])
00-07                  Project(o_orderpriority=[$0], o_orderkey=[$1])
00-08                    HashToRandomExchange(dist0=[[$0]], dist1=[[$1]])
01-01                      UnorderedMuxExchange
02-01                        Project(o_orderpriority=[$0], o_orderkey=[$1], E_X_P_R_H_A_S_H_F_I_E_L_D=[hash32AsDouble($1, hash32AsDouble($0, 1301011))])
02-02                          HashAgg(group=[{0, 1}])
02-03                            Project(o_orderpriority=[$2], o_orderkey=[$0])
02-04                              SelectionVectorRemover
02-05                                Filter(condition=[AND(>=($1, 1993-07-01), <($1, 1993-10-01 00:00:00), <($3, $4))])
02-06                                  Project(o_orderkey=[$0], o_orderdate=[$1], o_orderpriority=[$2], l_commitdate=[$3], l_receiptdate=[$4])
02-07                                    Scan(table=[[hive, denormalized_parquet]], groupscan=[HiveDrillNativeParquetScan [entries=[ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000000_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000001_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000002_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000003_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000004_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000005_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000006_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000007_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000008_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000009_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000010_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000011_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000012_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000013_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000014_0]], numFiles=15, numRowGroups=16, columns=[`o_orderkey`, `o_orderdate`, `o_orderpriority`, `l_commitdate`, `l_receiptdate`]]])
[1;32m | [m{
  "head" : {
    "version" : 1,
    "generator" : {
      "type" : "ExplainHandler",
      "info" : ""
    },
    "type" : "APACHE_DRILL_PHYSICAL",
    "options" : [ ],
    "queue" : 0,
    "hasResourcePlan" : false,
    "resultMode" : "EXEC"
  },
  "graph" : [ {
    "pop" : "hive-drill-native-parquet-scan",
    "@id" : 131079,
    "userName" : "root",
    "hiveStoragePluginConfig" : {
      "type" : "hive",
      "configProps" : {
        "hive.metastore.uris" : "thrift://hive-metastore:9083",
        "hive.metastore.sasl.enabled" : "false",
        "fs.default.name" : "hdfs://namenode"
      },
      "enabled" : true
    },
    "columns" : [ "`o_orderkey`", "`o_orderdate`", "`o_orderpriority`", "`l_commitdate`", "`l_receiptdate`" ],
    "entries" : [ {
      "path" : "/user/hive/warehouse/denormalized_parquet/000000_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000001_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000002_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000003_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000004_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000005_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000006_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000007_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000008_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000009_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000010_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000011_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000012_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000013_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000014_0"
    } ],
    "hivePartitionHolder" : {
      "keyToIndexMapper" : { },
      "partitionValues" : [ ]
    },
    "confProperties" : { },
    "cost" : 6051219.0
  }, {
    "pop" : "project",
    "@id" : 131078,
    "exprs" : [ {
      "ref" : "`o_orderkey`",
      "expr" : "`o_orderkey`"
    }, {
      "ref" : "`o_orderdate`",
      "expr" : "`o_orderdate`"
    }, {
      "ref" : "`o_orderpriority`",
      "expr" : "`o_orderpriority`"
    }, {
      "ref" : "`l_commitdate`",
      "expr" : "`l_commitdate`"
    }, {
      "ref" : "`l_receiptdate`",
      "expr" : "`l_receiptdate`"
    } ],
    "child" : 131079,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 6051219.0
  }, {
    "pop" : "filter",
    "@id" : 131077,
    "child" : 131078,
    "expr" : "booleanAnd(greater_than_or_equal_to(`o_orderdate`, cast( 741484800000 as DATE)) , less_than(`o_orderdate`, cast( 749433600000 as TIMESTAMP)) , less_than(`l_commitdate`, `l_receiptdate`) ) ",
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 756402.375
  }, {
    "pop" : "selection-vector-remover",
    "@id" : 131076,
    "child" : 131077,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 756402.375
  }, {
    "pop" : "project",
    "@id" : 131075,
    "exprs" : [ {
      "ref" : "`o_orderpriority`",
      "expr" : "`o_orderpriority`"
    }, {
      "ref" : "`o_orderkey`",
      "expr" : "`o_orderkey`"
    } ],
    "child" : 131076,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 756402.375
  }, {
    "pop" : "hash-aggregate",
    "@id" : 131074,
    "child" : 131075,
    "cardinality" : 1.0,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "aggPhase" : "PHASE_1of2",
    "groupByExprs" : [ {
      "ref" : "`o_orderpriority`",
      "expr" : "`o_orderpriority`"
    }, {
      "ref" : "`o_orderkey`",
      "expr" : "`o_orderkey`"
    } ],
    "aggrExprs" : [ ],
    "cost" : 567301.78125
  }, {
    "pop" : "project",
    "@id" : 131073,
    "exprs" : [ {
      "ref" : "`o_orderpriority`",
      "expr" : "`o_orderpriority`"
    }, {
      "ref" : "`o_orderkey`",
      "expr" : "`o_orderkey`"
    }, {
      "ref" : "`E_X_P_R_H_A_S_H_F_I_E_L_D`",
      "expr" : "hash32asdouble(`o_orderkey`, hash32asdouble(`o_orderpriority`, 1301011) ) "
    } ],
    "child" : 131074,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 75640.2375
  }, {
    "pop" : "unordered-mux-exchange",
    "@id" : 65537,
    "child" : 131073,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 75640.2375
  }, {
    "pop" : "hash-to-random-exchange",
    "@id" : 8,
    "child" : 65537,
    "expr" : "`E_X_P_R_H_A_S_H_F_I_E_L_D`",
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 75640.2375
  }, {
    "pop" : "project",
    "@id" : 7,
    "exprs" : [ {
      "ref" : "`o_orderpriority`",
      "expr" : "`o_orderpriority`"
    }, {
      "ref" : "`o_orderkey`",
      "expr" : "`o_orderkey`"
    } ],
    "child" : 8,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 75640.2375
  }, {
    "pop" : "hash-aggregate",
    "@id" : 6,
    "child" : 7,
    "cardinality" : 1.0,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "aggPhase" : "PHASE_2of2",
    "groupByExprs" : [ {
      "ref" : "`o_orderpriority`",
      "expr" : "`o_orderpriority`"
    }, {
      "ref" : "`o_orderkey`",
      "expr" : "`o_orderkey`"
    } ],
    "aggrExprs" : [ ],
    "cost" : 56730.178125000006
  }, {
    "pop" : "hash-aggregate",
    "@id" : 5,
    "child" : 6,
    "cardinality" : 1.0,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "aggPhase" : "PHASE_1of2",
    "groupByExprs" : [ {
      "ref" : "`o_orderpriority`",
      "expr" : "`o_orderpriority`"
    } ],
    "aggrExprs" : [ {
      "ref" : "`order_count`",
      "expr" : "count(`o_orderkey`) "
    } ],
    "cost" : 3782.011875
  }, {
    "pop" : "hash-aggregate",
    "@id" : 4,
    "child" : 5,
    "cardinality" : 1.0,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "aggPhase" : "PHASE_2of2",
    "groupByExprs" : [ {
      "ref" : "`o_orderpriority`",
      "expr" : "`o_orderpriority`"
    } ],
    "aggrExprs" : [ {
      "ref" : "`order_count`",
      "expr" : "$sum0(`order_count`) "
    } ],
    "cost" : 378.2011875
  }, {
    "pop" : "external-sort",
    "@id" : 3,
    "child" : 4,
    "orderings" : [ {
      "order" : "ASC",
      "expr" : "`o_orderpriority`",
      "nullDirection" : "LAST"
    } ],
    "reverse" : false,
    "initialAllocation" : 20000000,
    "maxAllocation" : 10000000000,
    "cost" : 75.6402375
  }, {
    "pop" : "selection-vector-remover",
    "@id" : 2,
    "child" : 3,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 75.6402375
  }, {
    "pop" : "project",
    "@id" : 1,
    "exprs" : [ {
      "ref" : "`o_orderpriority`",
      "expr" : "`o_orderpriority`"
    }, {
      "ref" : "`order_count`",
      "expr" : "`order_count`"
    } ],
    "child" : 2,
    "outputProj" : true,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 75.6402375
  }, {
    "pop" : "screen",
    "@id" : 0,
    "child" : 1,
    "initialAllocation" : 1000000,
    "maxAllocation[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
1 row selected (0.448 seconds)
0: jdbc:drill:zk=zookeeper:2181> Closing: org.apache.drill.jdbc.impl.DrillConnectionImpl
13/04/2019 12:55:53.336
--------------------------------------Finished QUERY 4.--------------------------------

--------------------------------------STARTED QUERY 5. ---------------------------------
--------------------------------------Finished QUERY 5.--------------------------------

--------------------------------------STARTED QUERY 6. ---------------------------------
13/04/2019 12:55:53.353
Apr 13, 2019 12:55:54 PM org.jline.utils.Log logr
WARNING: Unable to create a system terminal, creating a dumb terminal (enable debug logging for more information)
Apache Drill 1.15.0
"Got Drill?"
0: jdbc:drill:zk=zookeeper:2181> explain plan for select sum(l_extendedprice*l_discount)[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m[1m                                      text                                      [m[1;32m | [m[1m                                      json                                      [m[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m00-00    Screen
00-01      Project(revenue=[$0])
00-02        StreamAgg(group=[{}], revenue=[SUM($0)])
00-03          UnionExchange
01-01            StreamAgg(group=[{}], revenue=[SUM($0)])
01-02              Project($f0=[*($1, $2)])
01-03                SelectionVectorRemover
01-04                  Filter(condition=[AND(>=($3, 1994-01-01), <($3, 1995-01-01 00:00:00), >=($2, 0.05), <=($2, 0.07), <($0, 24))])
01-05                    Project(l_quantity=[$0], l_extendedprice=[$1], l_discount=[$2], l_shipdate=[$3])
01-06                      Scan(table=[[hive, denormalized_parquet]], groupscan=[HiveDrillNativeParquetScan [entries=[ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000000_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000001_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000002_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000003_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000004_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000005_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000006_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000007_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000008_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000009_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000010_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000011_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000012_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000013_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000014_0]], numFiles=15, numRowGroups=16, columns=[`l_quantity`, `l_extendedprice`, `l_discount`, `l_shipdate`]]])
[1;32m | [m{
  "head" : {
    "version" : 1,
    "generator" : {
      "type" : "ExplainHandler",
      "info" : ""
    },
    "type" : "APACHE_DRILL_PHYSICAL",
    "options" : [ ],
    "queue" : 0,
    "hasResourcePlan" : false,
    "resultMode" : "EXEC"
  },
  "graph" : [ {
    "pop" : "hive-drill-native-parquet-scan",
    "@id" : 65542,
    "userName" : "root",
    "hiveStoragePluginConfig" : {
      "type" : "hive",
      "configProps" : {
        "hive.metastore.uris" : "thrift://hive-metastore:9083",
        "hive.metastore.sasl.enabled" : "false",
        "fs.default.name" : "hdfs://namenode"
      },
      "enabled" : true
    },
    "columns" : [ "`l_quantity`", "`l_extendedprice`", "`l_discount`", "`l_shipdate`" ],
    "entries" : [ {
      "path" : "/user/hive/warehouse/denormalized_parquet/000000_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000001_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000002_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000003_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000004_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000005_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000006_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000007_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000008_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000009_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000010_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000011_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000012_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000013_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000014_0"
    } ],
    "hivePartitionHolder" : {
      "keyToIndexMapper" : { },
      "partitionValues" : [ ]
    },
    "confProperties" : { },
    "cost" : 6051219.0
  }, {
    "pop" : "project",
    "@id" : 65541,
    "exprs" : [ {
      "ref" : "`l_quantity`",
      "expr" : "`l_quantity`"
    }, {
      "ref" : "`l_extendedprice`",
      "expr" : "`l_extendedprice`"
    }, {
      "ref" : "`l_discount`",
      "expr" : "`l_discount`"
    }, {
      "ref" : "`l_shipdate`",
      "expr" : "`l_shipdate`"
    } ],
    "child" : 65542,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 6051219.0
  }, {
    "pop" : "filter",
    "@id" : 65540,
    "child" : 65541,
    "expr" : "booleanAnd(greater_than_or_equal_to(`l_shipdate`, cast( 757382400000 as DATE)) , less_than(`l_shipdate`, cast( 788918400000 as TIMESTAMP)) , greater_than_or_equal_to(`l_discount`, 0.05) , less_than_or_equal_to(`l_discount`, 0.07) , less_than(`l_quantity`, 24) ) ",
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 189100.59375
  }, {
    "pop" : "selection-vector-remover",
    "@id" : 65539,
    "child" : 65540,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 189100.59375
  }, {
    "pop" : "project",
    "@id" : 65538,
    "exprs" : [ {
      "ref" : "`$f0`",
      "expr" : "multiply(`l_extendedprice`, `l_discount`) "
    } ],
    "child" : 65539,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 189100.59375
  }, {
    "pop" : "streaming-aggregate",
    "@id" : 65537,
    "child" : 65538,
    "keys" : [ ],
    "exprs" : [ {
      "ref" : "`revenue`",
      "expr" : "sum(`$f0`) "
    } ],
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 1.0
  }, {
    "pop" : "union-exchange",
    "@id" : 3,
    "child" : 65537,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 1.0
  }, {
    "pop" : "streaming-aggregate",
    "@id" : 2,
    "child" : 3,
    "keys" : [ ],
    "exprs" : [ {
      "ref" : "`revenue`",
      "expr" : "sum(`revenue`) "
    } ],
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 1.0
  }, {
    "pop" : "project",
    "@id" : 1,
    "exprs" : [ {
      "ref" : "`revenue`",
      "expr" : "`revenue`"
    } ],
    "child" : 2,
    "outputProj" : true,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 1.0
  }, {
    "pop" : "screen",
    "@id" : 0,
    "child" : 1,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 1.0
  } ]
}[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
1 row selected (0.44 seconds)
0: jdbc:drill:zk=zookeeper:2181> Closing: org.apache.drill.jdbc.impl.DrillConnectionImpl
13/04/2019 12:55:56.870
--------------------------------------Finished QUERY 6.--------------------------------

--------------------------------------STARTED QUERY 7. ---------------------------------
13/04/2019 12:55:56.880
Apr 13, 2019 12:55:57 PM org.jline.utils.Log logr
WARNING: Unable to create a system terminal, creating a dumb terminal (enable debug logging for more information)
Apache Drill 1.15.0
"Drill must go on."
0: jdbc:drill:zk=zookeeper:2181> explain plan for select  n2_name, n_name,   year(l_shipdate) as l_year, sum(l_extendedprice * (1 - l_discount)) as revenue from hive.denormalized_parquet where ((n2_name = 'FRANCE' and n_name = 'GERMANY') or (n2_name = 'GERMANY'  and n_name = 'FRANCE')) and l_shipdate between date '1995-01-01' and date '1996-12-31'  group by n2_name, n_name, year(l_shipdate)[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m[1m                                      text                                      [m[1;32m | [m[1m                                      json                                      [m[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m00-00    Screen
00-01      Project(n2_name=[$0], n_name=[$1], l_year=[$2], revenue=[$3])
00-02        SelectionVectorRemover
00-03          Sort(sort0=[$0], sort1=[$1], sort2=[$2], dir0=[ASC], dir1=[ASC], dir2=[ASC])
00-04            HashAgg(group=[{0, 1, 2}], revenue=[SUM($3)])
00-05              Project(n2_name=[$0], n_name=[$1], l_year=[$2], revenue=[$3])
00-06                HashToRandomExchange(dist0=[[$0]], dist1=[[$1]], dist2=[[$2]])
01-01                  UnorderedMuxExchange
02-01                    Project(n2_name=[$0], n_name=[$1], l_year=[$2], revenue=[$3], E_X_P_R_H_A_S_H_F_I_E_L_D=[hash32AsDouble($2, hash32AsDouble($1, hash32AsDouble($0, 1301011)))])
02-02                      HashAgg(group=[{0, 1, 2}], revenue=[SUM($3)])
02-03                        Project(n2_name=[$4], n_name=[$0], l_year=[EXTRACT(FLAG(YEAR), $3)], $f3=[*($1, -(1, $2))])
02-04                          SelectionVectorRemover
02-05                            Filter(condition=[AND(OR(AND(=($4, 'FRANCE'), =($0, 'GERMANY')), AND(=($4, 'GERMANY'), =($0, 'FRANCE'))), >=($3, 1995-01-01), <=($3, 1996-12-31))])
02-06                              Project(n_name=[$0], l_extendedprice=[$1], l_discount=[$2], l_shipdate=[$3], n2_name=[$4])
02-07                                Scan(table=[[hive, denormalized_parquet]], groupscan=[HiveDrillNativeParquetScan [entries=[ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000000_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000001_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000002_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000003_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000004_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000005_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000006_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000007_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000008_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000009_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000010_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000011_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000012_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000013_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000014_0]], numFiles=15, numRowGroups=16, columns=[`n_name`, `l_extendedprice`, `l_discount`, `l_shipdate`, `n2_name`]]])
[1;32m | [m{
  "head" : {
    "version" : 1,
    "generator" : {
      "type" : "ExplainHandler",
      "info" : ""
    },
    "type" : "APACHE_DRILL_PHYSICAL",
    "options" : [ ],
    "queue" : 0,
    "hasResourcePlan" : false,
    "resultMode" : "EXEC"
  },
  "graph" : [ {
    "pop" : "hive-drill-native-parquet-scan",
    "@id" : 131079,
    "userName" : "root",
    "hiveStoragePluginConfig" : {
      "type" : "hive",
      "configProps" : {
        "hive.metastore.uris" : "thrift://hive-metastore:9083",
        "hive.metastore.sasl.enabled" : "false",
        "fs.default.name" : "hdfs://namenode"
      },
      "enabled" : true
    },
    "columns" : [ "`n_name`", "`l_extendedprice`", "`l_discount`", "`l_shipdate`", "`n2_name`" ],
    "entries" : [ {
      "path" : "/user/hive/warehouse/denormalized_parquet/000000_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000001_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000002_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000003_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000004_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000005_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000006_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000007_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000008_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000009_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000010_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000011_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000012_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000013_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000014_0"
    } ],
    "hivePartitionHolder" : {
      "keyToIndexMapper" : { },
      "partitionValues" : [ ]
    },
    "confProperties" : { },
    "cost" : 6051219.0
  }, {
    "pop" : "project",
    "@id" : 131078,
    "exprs" : [ {
      "ref" : "`n_name`",
      "expr" : "`n_name`"
    }, {
      "ref" : "`l_extendedprice`",
      "expr" : "`l_extendedprice`"
    }, {
      "ref" : "`l_discount`",
      "expr" : "`l_discount`"
    }, {
      "ref" : "`l_shipdate`",
      "expr" : "`l_shipdate`"
    }, {
      "ref" : "`n2_name`",
      "expr" : "`n2_name`"
    } ],
    "child" : 131079,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 6051219.0
  }, {
    "pop" : "filter",
    "@id" : 131077,
    "child" : 131078,
    "expr" : "booleanAnd(booleanOr(booleanAnd(equal(`n2_name`, 'FRANCE') , equal(`n_name`, 'GERMANY') ) , booleanAnd(equal(`n2_name`, 'GERMANY') , equal(`n_name`, 'FRANCE') ) ) , greater_than_or_equal_to(`l_shipdate`, cast( 788918400000 as DATE)) , less_than_or_equal_to(`l_shipdate`, cast( 851990400000 as DATE)) ) ",
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 378201.1875
  }, {
    "pop" : "selection-vector-remover",
    "@id" : 131076,
    "child" : 131077,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 378201.1875
  }, {
    "pop" : "project",
    "@id" : 131075,
    "exprs" : [ {
      "ref" : "`n2_name`",
      "expr" : "`n2_name`"
    }, {
      "ref" : "`n_name`",
      "expr" : "`n_name`"
    }, {
      "ref" : "`l_year`",
      "expr" : "extractYear(`l_shipdate`) "
    }, {
      "ref" : "`$f3`",
      "expr" : "multiply(`l_extendedprice`, subtract(1, `l_discount`) ) "
    } ],
    "child" : 131076,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 378201.1875
  }, {
    "pop" : "hash-aggregate",
    "@id" : 131074,
    "child" : 131075,
    "cardinality" : 1.0,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "aggPhase" : "PHASE_1of2",
    "groupByExprs" : [ {
      "ref" : "`n2_name`",
      "expr" : "`n2_name`"
    }, {
      "ref" : "`n_name`",
      "expr" : "`n_name`"
    }, {
      "ref" : "`l_year`",
      "expr" : "`l_year`"
    } ],
    "aggrExprs" : [ {
      "ref" : "`revenue`",
      "expr" : "sum(`$f3`) "
    } ],
    "cost" : 330926.0390625
  }, {
    "pop" : "project",
    "@id" : 131073,
    "exprs" : [ {
      "ref" : "`n2_name`",
      "expr" : "`n2_name`"
    }, {
      "ref" : "`n_name`",
      "expr" : "`n_name`"
    }, {
      "ref" : "`l_year`",
      "expr" : "`l_year`"
    }, {
      "ref" : "`revenue`",
      "expr" : "`revenue`"
    }, {
      "ref" : "`E_X_P_R_H_A_S_H_F_I_E_L_D`",
      "expr" : "hash32asdouble(`l_year`, hash32asdouble(`n_name`, hash32asdouble(`n2_name`, 1301011) ) ) "
    } ],
    "child" : 131074,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 37820.11875
  }, {
    "pop" : "unordered-mux-exchange",
    "@id" : 65537,
    "child" : 131073,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 37820.11875
  }, {
    "pop" : "hash-to-random-exchange",
    "@id" : 6,
    "child" : 65537,
    "expr" : "`E_X_P_R_H_A_S_H_F_I_E_L_D`",
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 37820.11875
  }, {
    "pop" : "project",
    "@id" : 5,
    "exprs" : [ {
      "ref" : "`n2_name`",
      "expr" : "`n2_name`"
    }, {
      "ref" : "`n_name`",
      "expr" : "`n_name`"
    }, {
      "ref" : "`l_year`",
      "expr" : "`l_year`"
    }, {
      "ref" : "`revenue`",
      "expr" : "`revenue`"
    } ],
    "child" : 6,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 37820.11875
  }, {
    "pop" : "hash-aggregate",
    "@id" : 4,
    "child" : 5,
    "cardinality" : 1.0,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "aggPhase" : "PHASE_2of2",
    "groupByExprs" : [ {
      "ref" : "`n2_name`",
      "expr" : "`n2_name`"
    }, {
      "ref" : "`n_name`",
      "expr" : "`n_name`"
    }, {
      "ref" : "`l_year`",
      "expr" : "`l_year`"
    } ],
    "aggrExprs" : [ {
      "ref" : "`revenue`",
      "expr" : "sum(`revenue`) "
    } ],
    "cost" : 33092.60390625
  }, {
    "pop" : "external-sort",
    "@id" : 3,
    "child" : 4,
    "orderings" : [ {
      "order" : "ASC",
      "expr" : "`n2_name`",
      "nullDirection" : "LAST"
    }, {
      "order" : "ASC",
      "expr" : "`n_name`",
      "nullDirection" : "LAST"
    }, {
      "order" : "ASC",
      "expr" : "`l_year`",
      "nullDirection" : "LAST"
    } ],
    "reverse" : false,
    "initialAllocation" : 20000000,
    "maxAllocation" : 10000000000,
    "cost" : 3782.011875
  }, {
    "pop" : "selection-vector-remover",
    "@id" : 2,
    "child" : 3,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 3782.011875
  }, {
    "pop" : "project",
    "@id" : 1,
    "exprs" : [ {
      "ref" : "`n2_name`",
      "expr" : "`n2_name`"
    }, {
      "ref" : "`n_name`",
      "expr" : "`n_name`"
    }, {
      "ref" : "`l_year`",
      "expr" : "`l_year`"
    }, {
      "ref" : "`revenue`",
      "expr" : "`revenue`"
    } ],
    "child" : 2,
    "outputProj" : true,
    "initialAllocation" : 1000000,
    "m[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
1 row selected (0.499 seconds)
0: jdbc:drill:zk=zookeeper:2181> Closing: org.apache.drill.jdbc.impl.DrillConnectionImpl
13/04/2019 12:56:00.500
--------------------------------------Finished QUERY 7.--------------------------------

--------------------------------------STARTED QUERY 8. ---------------------------------
13/04/2019 12:56:00.509
Apr 13, 2019 12:56:01 PM org.jline.utils.Log logr
WARNING: Unable to create a system terminal, creating a dumb terminal (enable debug logging for more information)
Apache Drill 1.15.0
"Drill, baby, Drill."
0: jdbc:drill:zk=zookeeper:2181> explain plan for select o_year, sum(case when nation = 'BRAZIL' then volume else 0 end) / sum(volume) as mkt_share  from ( select year(o_orderdate) as o_year, l_extendedprice * (1-l_discount) as volume,  n2_name as nation  from hive.denormalized_parquet where r_name = 'AMERICA' and o_orderdate between date '1995-01-01'  and date '1996-12-31'  and p_type = 'ECONOMY ANODIZED STEEL')[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m[1m                                      text                                      [m[1;32m | [m[1m                                      json                                      [m[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m00-00    Screen
00-01      Project(o_year=[$0], mkt_share=[$1])
00-02        SelectionVectorRemover
00-03          Sort(sort0=[$0], dir0=[ASC])
00-04            Project(o_year=[$0], mkt_share=[/($1, $2)])
00-05              HashAgg(group=[{0}], agg#0=[SUM($1)], agg#1=[SUM($2)])
00-06                Project(o_year=[$0], $f1=[$1], volume=[$2])
00-07                  HashToRandomExchange(dist0=[[$0]])
01-01                    UnorderedMuxExchange
02-01                      Project(o_year=[$0], $f1=[$1], volume=[$2], E_X_P_R_H_A_S_H_F_I_E_L_D=[hash32AsDouble($0, 1301011)])
02-02                        Project(o_year=[EXTRACT(FLAG(YEAR), $1)], $f1=[CASE(=($4, 'BRAZIL'), *($2, -(1, $3)), 0)], volume=[*($2, -(1, $3))])
02-03                          SelectionVectorRemover
02-04                            Filter(condition=[AND(=($0, 'AMERICA'), >=($1, 1995-01-01), <=($1, 1996-12-31), =($5, 'ECONOMY ANODIZED STEEL'))])
02-05                              Project(r_name=[$0], o_orderdate=[$1], l_extendedprice=[$2], l_discount=[$3], n2_name=[$4], p_type=[$5])
02-06                                Scan(table=[[hive, denormalized_parquet]], groupscan=[HiveDrillNativeParquetScan [entries=[ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000000_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000001_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000002_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000003_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000004_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000005_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000006_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000007_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000008_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000009_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000010_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000011_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000012_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000013_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000014_0]], numFiles=15, numRowGroups=16, columns=[`r_name`, `o_orderdate`, `l_extendedprice`, `l_discount`, `n2_name`, `p_type`]]])
[1;32m | [m{
  "head" : {
    "version" : 1,
    "generator" : {
      "type" : "ExplainHandler",
      "info" : ""
    },
    "type" : "APACHE_DRILL_PHYSICAL",
    "options" : [ ],
    "queue" : 0,
    "hasResourcePlan" : false,
    "resultMode" : "EXEC"
  },
  "graph" : [ {
    "pop" : "hive-drill-native-parquet-scan",
    "@id" : 131078,
    "userName" : "root",
    "hiveStoragePluginConfig" : {
      "type" : "hive",
      "configProps" : {
        "hive.metastore.uris" : "thrift://hive-metastore:9083",
        "hive.metastore.sasl.enabled" : "false",
        "fs.default.name" : "hdfs://namenode"
      },
      "enabled" : true
    },
    "columns" : [ "`r_name`", "`o_orderdate`", "`l_extendedprice`", "`l_discount`", "`n2_name`", "`p_type`" ],
    "entries" : [ {
      "path" : "/user/hive/warehouse/denormalized_parquet/000000_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000001_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000002_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000003_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000004_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000005_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000006_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000007_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000008_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000009_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000010_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000011_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000012_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000013_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000014_0"
    } ],
    "hivePartitionHolder" : {
      "keyToIndexMapper" : { },
      "partitionValues" : [ ]
    },
    "confProperties" : { },
    "cost" : 6051219.0
  }, {
    "pop" : "project",
    "@id" : 131077,
    "exprs" : [ {
      "ref" : "`r_name`",
      "expr" : "`r_name`"
    }, {
      "ref" : "`o_orderdate`",
      "expr" : "`o_orderdate`"
    }, {
      "ref" : "`l_extendedprice`",
      "expr" : "`l_extendedprice`"
    }, {
      "ref" : "`l_discount`",
      "expr" : "`l_discount`"
    }, {
      "ref" : "`n2_name`",
      "expr" : "`n2_name`"
    }, {
      "ref" : "`p_type`",
      "expr" : "`p_type`"
    } ],
    "child" : 131078,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 6051219.0
  }, {
    "pop" : "filter",
    "@id" : 131076,
    "child" : 131077,
    "expr" : "booleanAnd(equal(`r_name`, 'AMERICA') , greater_than_or_equal_to(`o_orderdate`, cast( 788918400000 as DATE)) , less_than_or_equal_to(`o_orderdate`, cast( 851990400000 as DATE)) , equal(`p_type`, 'ECONOMY ANODIZED STEEL') ) ",
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 34038.106875
  }, {
    "pop" : "selection-vector-remover",
    "@id" : 131075,
    "child" : 131076,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 34038.106875
  }, {
    "pop" : "project",
    "@id" : 131074,
    "exprs" : [ {
      "ref" : "`o_year`",
      "expr" : "extractYear(`o_orderdate`) "
    }, {
      "ref" : "`$f1`",
      "expr" : " ( if (equal(`n2_name`, 'BRAZIL')  ) then (multiply(`l_extendedprice`, subtract(1, `l_discount`) )  )  else (0 )  end  ) "
    }, {
      "ref" : "`volume`",
      "expr" : "multiply(`l_extendedprice`, subtract(1, `l_discount`) ) "
    } ],
    "child" : 131075,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 34038.106875
  }, {
    "pop" : "project",
    "@id" : 131073,
    "exprs" : [ {
      "ref" : "`o_year`",
      "expr" : "`o_year`"
    }, {
      "ref" : "`$f1`",
      "expr" : "`$f1`"
    }, {
      "ref" : "`volume`",
      "expr" : "`volume`"
    }, {
      "ref" : "`E_X_P_R_H_A_S_H_F_I_E_L_D`",
      "expr" : "hash32asdouble(`o_year`, 1301011) "
    } ],
    "child" : 131074,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 34038.106875
  }, {
    "pop" : "unordered-mux-exchange",
    "@id" : 65537,
    "child" : 131073,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 34038.106875
  }, {
    "pop" : "hash-to-random-exchange",
    "@id" : 7,
    "child" : 65537,
    "expr" : "`E_X_P_R_H_A_S_H_F_I_E_L_D`",
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 34038.106875
  }, {
    "pop" : "project",
    "@id" : 6,
    "exprs" : [ {
      "ref" : "`o_year`",
      "expr" : "`o_year`"
    }, {
      "ref" : "`$f1`",
      "expr" : "`$f1`"
    }, {
      "ref" : "`volume`",
      "expr" : "`volume`"
    } ],
    "child" : 7,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 34038.106875
  }, {
    "pop" : "hash-aggregate",
    "@id" : 5,
    "child" : 6,
    "cardinality" : 1.0,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "aggPhase" : "PHASE_1of1",
    "groupByExprs" : [ {
      "ref" : "`o_year`",
      "expr" : "`o_year`"
    } ],
    "aggrExprs" : [ {
      "ref" : "`$f1`",
      "expr" : "sum(`$f1`) "
    }, {
      "ref" : "`$f2`",
      "expr" : "sum(`volume`) "
    } ],
    "cost" : 17019.0534375
  }, {
    "pop" : "project",
    "@id" : 4,
    "exprs" : [ {
      "ref" : "`o_year`",
      "expr" : "`o_year`"
    }, {
      "ref" : "`mkt_share`",
      "expr" : "divide(`$f1`, `$f2`) "
    } ],
    "child" : 5,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 3403.8106875
  }, {
    "pop" : "external-sort",
    "@id" : 3,
    "child" : 4,
    "orderings" : [ {
      "order" : "ASC",
      "expr" : "`o_year`",
      "nullDirection" : "LAST"
    } ],
    "reverse" : false,
    "initialAllocation" : 20000000,
    "maxAllocation" : 10000000000,
    "cost" : 3403.8106875
  }, {
    "pop" : "selection-vector-remover",
    "@id" : 2,
    "child" : 3,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 3403.8106875
  }, {
    "pop" : "project",
    "@id" : 1,
    "exprs" : [ {
      "ref" : "`o_year`",
      "expr" : "`o_year`"
    }, {
      "ref" : "`mkt_share`",
      "expr" : "`mkt_share`"
    } ],
    "child" : 2,
    "outputProj" : true,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 3403.8106875
  }, {
    "pop" : "screen",
    "@id" : 0,
    "child" : 1,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 3403.8106875
  } ]
}[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
1 row selected (0.402 seconds)
0: jdbc:drill:zk=zookeeper:2181> Closing: org.apache.drill.jdbc.impl.DrillConnectionImpl
13/04/2019 12:56:04.135
--------------------------------------Finished QUERY 8.--------------------------------

--------------------------------------STARTED QUERY 9. ---------------------------------
13/04/2019 12:56:04.146
Apr 13, 2019 12:56:04 PM org.jline.utils.Log logr
WARNING: Unable to create a system terminal, creating a dumb terminal (enable debug logging for more information)
Apache Drill 1.15.0
"Keep your data close, but your Drillbits closer."
0: jdbc:drill:zk=zookeeper:2181> explain plan for select nation, o_year, sum(amount) as sum_profit from ( select n2_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from hive.denormalized_parquet where p_name like '%green%' )[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m[1m                                      text                                      [m[1;32m | [m[1m                                      json                                      [m[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m00-00    Screen
00-01      Project(nation=[$0], o_year=[$1], sum_profit=[$2])
00-02        SingleMergeExchange(sort0=[0], sort1=[1 DESC])
01-01          OrderedMuxExchange(sort0=[0], sort1=[1 DESC])
02-01            SelectionVectorRemover
02-02              Sort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
02-03                HashAgg(group=[{0, 1}], sum_profit=[SUM($2)])
02-04                  HashToRandomExchange(dist0=[[$0]], dist1=[[$1]])
03-01                    HashAgg(group=[{0, 1}], sum_profit=[SUM($2)])
03-02                      Project(nation=[$4], o_year=[EXTRACT(FLAG(YEAR), $0)], amount=[-(*($2, -(1, $3)), *($6, $1))])
03-03                        SelectionVectorRemover
03-04                          Filter(condition=[LIKE($5, '%green%')])
03-05                            Project(o_orderdate=[$0], l_quantity=[$1], l_extendedprice=[$2], l_discount=[$3], n2_name=[$4], p_name=[$5], ps_supplycost=[$6])
03-06                              Scan(table=[[hive, denormalized_parquet]], groupscan=[HiveDrillNativeParquetScan [entries=[ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000000_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000001_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000002_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000003_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000004_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000005_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000006_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000007_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000008_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000009_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000010_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000011_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000012_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000013_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000014_0]], numFiles=15, numRowGroups=16, columns=[`o_orderdate`, `l_quantity`, `l_extendedprice`, `l_discount`, `n2_name`, `p_name`, `ps_supplycost`]]])
[1;32m | [m{
  "head" : {
    "version" : 1,
    "generator" : {
      "type" : "ExplainHandler",
      "info" : ""
    },
    "type" : "APACHE_DRILL_PHYSICAL",
    "options" : [ ],
    "queue" : 0,
    "hasResourcePlan" : false,
    "resultMode" : "EXEC"
  },
  "graph" : [ {
    "pop" : "hive-drill-native-parquet-scan",
    "@id" : 196614,
    "userName" : "root",
    "hiveStoragePluginConfig" : {
      "type" : "hive",
      "configProps" : {
        "hive.metastore.uris" : "thrift://hive-metastore:9083",
        "hive.metastore.sasl.enabled" : "false",
        "fs.default.name" : "hdfs://namenode"
      },
      "enabled" : true
    },
    "columns" : [ "`o_orderdate`", "`l_quantity`", "`l_extendedprice`", "`l_discount`", "`n2_name`", "`p_name`", "`ps_supplycost`" ],
    "entries" : [ {
      "path" : "/user/hive/warehouse/denormalized_parquet/000000_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000001_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000002_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000003_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000004_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000005_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000006_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000007_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000008_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000009_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000010_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000011_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000012_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000013_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000014_0"
    } ],
    "hivePartitionHolder" : {
      "keyToIndexMapper" : { },
      "partitionValues" : [ ]
    },
    "confProperties" : { },
    "cost" : 6051219.0
  }, {
    "pop" : "project",
    "@id" : 196613,
    "exprs" : [ {
      "ref" : "`o_orderdate`",
      "expr" : "`o_orderdate`"
    }, {
      "ref" : "`l_quantity`",
      "expr" : "`l_quantity`"
    }, {
      "ref" : "`l_extendedprice`",
      "expr" : "`l_extendedprice`"
    }, {
      "ref" : "`l_discount`",
      "expr" : "`l_discount`"
    }, {
      "ref" : "`n2_name`",
      "expr" : "`n2_name`"
    }, {
      "ref" : "`p_name`",
      "expr" : "`p_name`"
    }, {
      "ref" : "`ps_supplycost`",
      "expr" : "`ps_supplycost`"
    } ],
    "child" : 196614,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 6051219.0
  }, {
    "pop" : "filter",
    "@id" : 196612,
    "child" : 196613,
    "expr" : "like(`p_name`, '%green%') ",
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 1512804.75
  }, {
    "pop" : "selection-vector-remover",
    "@id" : 196611,
    "child" : 196612,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 1512804.75
  }, {
    "pop" : "project",
    "@id" : 196610,
    "exprs" : [ {
      "ref" : "`nation`",
      "expr" : "`n2_name`"
    }, {
      "ref" : "`o_year`",
      "expr" : "extractYear(`o_orderdate`) "
    }, {
      "ref" : "`amount`",
      "expr" : "subtract(multiply(`l_extendedprice`, subtract(1, `l_discount`) ) , multiply(`ps_supplycost`, `l_quantity`) ) "
    } ],
    "child" : 196611,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 1512804.75
  }, {
    "pop" : "hash-aggregate",
    "@id" : 196609,
    "child" : 196610,
    "cardinality" : 1.0,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "aggPhase" : "PHASE_1of2",
    "groupByExprs" : [ {
      "ref" : "`nation`",
      "expr" : "`nation`"
    }, {
      "ref" : "`o_year`",
      "expr" : "`o_year`"
    } ],
    "aggrExprs" : [ {
      "ref" : "`sum_profit`",
      "expr" : "sum(`amount`) "
    } ],
    "cost" : 1134603.5625
  }, {
    "pop" : "hash-to-random-exchange",
    "@id" : 131076,
    "child" : 196609,
    "expr" : "hash32AsDouble(`o_year`, hash32AsDouble(`nation`, 1301011) ) ",
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 151280.475
  }, {
    "pop" : "hash-aggregate",
    "@id" : 131075,
    "child" : 131076,
    "cardinality" : 1.0,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "aggPhase" : "PHASE_2of2",
    "groupByExprs" : [ {
      "ref" : "`nation`",
      "expr" : "`nation`"
    }, {
      "ref" : "`o_year`",
      "expr" : "`o_year`"
    } ],
    "aggrExprs" : [ {
      "ref" : "`sum_profit`",
      "expr" : "sum(`sum_profit`) "
    } ],
    "cost" : 113460.35625000001
  }, {
    "pop" : "external-sort",
    "@id" : 131074,
    "child" : 131075,
    "orderings" : [ {
      "order" : "ASC",
      "expr" : "`nation`",
      "nullDirection" : "LAST"
    }, {
      "order" : "DESC",
      "expr" : "`o_year`",
      "nullDirection" : "FIRST"
    } ],
    "reverse" : false,
    "initialAllocation" : 20000000,
    "maxAllocation" : 10000000000,
    "cost" : 15128.0475
  }, {
    "pop" : "selection-vector-remover",
    "@id" : 131073,
    "child" : 131074,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 15128.0475
  }, {
    "pop" : "ordered-mux-exchange",
    "@id" : 65537,
    "child" : 131073,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 15128.0475
  }, {
    "pop" : "single-merge-exchange",
    "@id" : 2,
    "child" : 65537,
    "orderings" : [ {
      "order" : "ASC",
      "expr" : "`nation`",
      "nullDirection" : "LAST"
    }, {
      "order" : "DESC",
      "expr" : "`o_year`",
      "nullDirection" : "FIRST"
    } ],
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 15128.0475
  }, {
    "pop" : "project",
    "@id" : 1,
    "exprs" : [ {
      "ref" : "`nation`",
      "expr" : "`nation`"
    }, {
      "ref" : "`o_year`",
      "expr" : "`o_year`"
    }, {
      "ref" : "`sum_profit`",
      "expr" : "`sum_profit`"
    } ],
    "child" : 2,
    "outputProj" : true,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 15128.0475
  }, {
    "pop" : "screen",
    "@id" : 0,
    "child" : 1,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 15128.0475
  } ]
}[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
1 row selected (0.453 seconds)
0: jdbc:drill:zk=zookeeper:2181> Closing: org.apache.drill.jdbc.impl.DrillConnectionImpl
13/04/2019 12:56:07.798
--------------------------------------Finished QUERY 9.--------------------------------

--------------------------------------STARTED QUERY 10. ---------------------------------
13/04/2019 12:56:07.808
Apr 13, 2019 12:56:08 PM org.jline.utils.Log logr
WARNING: Unable to create a system terminal, creating a dumb terminal (enable debug logging for more information)
Apache Drill 1.15.0
"In Drill We Trust."
0: jdbc:drill:zk=zookeeper:2181> explain plan for select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount))[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m[1m                                      text                                      [m[1;32m | [m[1m                                      json                                      [m[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m00-00    Screen
00-01      Project(c_custkey=[$0], c_name=[$1], revenue=[$2], c_acctbal=[$3], n_name=[$4], c_address=[$5], c_phone=[$6], c_comment=[$7])
00-02        SelectionVectorRemover
00-03          Limit(fetch=[20])
00-04            Limit(fetch=[20])
00-05              SelectionVectorRemover
00-06                TopN(limit=[20])
00-07                  Project(c_custkey=[$0], c_name=[$1], revenue=[$7], c_acctbal=[$2], n_name=[$4], c_address=[$5], c_phone=[$3], c_comment=[$6])
00-08                    HashAgg(group=[{0, 1, 2, 3, 4, 5, 6}], revenue=[SUM($7)])
00-09                      Project(c_custkey=[$0], c_name=[$1], c_acctbal=[$2], c_phone=[$3], n_name=[$4], c_address=[$5], c_comment=[$6], revenue=[$7])
00-10                        HashToRandomExchange(dist0=[[$0]], dist1=[[$1]], dist2=[[$2]], dist3=[[$3]], dist4=[[$4]], dist5=[[$5]], dist6=[[$6]])
01-01                          UnorderedMuxExchange
02-01                            Project(c_custkey=[$0], c_name=[$1], c_acctbal=[$2], c_phone=[$3], n_name=[$4], c_address=[$5], c_comment=[$6], revenue=[$7], E_X_P_R_H_A_S_H_F_I_E_L_D=[hash32AsDouble($6, hash32AsDouble($5, hash32AsDouble($4, hash32AsDouble($3, hash32AsDouble($2, hash32AsDouble($1, hash32AsDouble($0, 1301011)))))))])
02-02                              HashAgg(group=[{0, 1, 2, 3, 4, 5, 6}], revenue=[SUM($7)])
02-03                                Project(c_custkey=[$0], c_name=[$1], c_acctbal=[$4], c_phone=[$3], n_name=[$6], c_address=[$2], c_comment=[$5], $f7=[*($8, -(1, $9))])
02-04                                  SelectionVectorRemover
02-05                                    Filter(condition=[AND(>=($7, 1993-10-01), <($7, 1994-01-01 00:00:00), =($10, 'R'))])
02-06                                      Project(c_custkey=[$0], c_name=[$1], c_address=[$2], c_phone=[$3], c_acctbal=[$4], c_comment=[$5], n_name=[$6], o_orderdate=[$7], l_extendedprice=[$8], l_discount=[$9], l_returnflag=[$10])
02-07                                        Scan(table=[[hive, denormalized_parquet]], groupscan=[HiveDrillNativeParquetScan [entries=[ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000000_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000001_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000002_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000003_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000004_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000005_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000006_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000007_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000008_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000009_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000010_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000011_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000012_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000013_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000014_0]], numFiles=15, numRowGroups=16, columns=[`c_custkey`, `c_name`, `c_address`, `c_phone`, `c_acctbal`, `c_comment`, `n_name`, `o_orderdate`, `l_extendedprice`, `l_discount`, `l_returnflag`]]])
[1;32m | [m{
  "head" : {
    "version" : 1,
    "generator" : {
      "type" : "ExplainHandler",
      "info" : ""
    },
    "type" : "APACHE_DRILL_PHYSICAL",
    "options" : [ ],
    "queue" : 0,
    "hasResourcePlan" : false,
    "resultMode" : "EXEC"
  },
  "graph" : [ {
    "pop" : "hive-drill-native-parquet-scan",
    "@id" : 131079,
    "userName" : "root",
    "hiveStoragePluginConfig" : {
      "type" : "hive",
      "configProps" : {
        "hive.metastore.uris" : "thrift://hive-metastore:9083",
        "hive.metastore.sasl.enabled" : "false",
        "fs.default.name" : "hdfs://namenode"
      },
      "enabled" : true
    },
    "columns" : [ "`c_custkey`", "`c_name`", "`c_address`", "`c_phone`", "`c_acctbal`", "`c_comment`", "`n_name`", "`o_orderdate`", "`l_extendedprice`", "`l_discount`", "`l_returnflag`" ],
    "entries" : [ {
      "path" : "/user/hive/warehouse/denormalized_parquet/000000_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000001_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000002_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000003_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000004_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000005_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000006_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000007_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000008_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000009_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000010_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000011_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000012_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000013_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000014_0"
    } ],
    "hivePartitionHolder" : {
      "keyToIndexMapper" : { },
      "partitionValues" : [ ]
    },
    "confProperties" : { },
    "cost" : 6051219.0
  }, {
    "pop" : "project",
    "@id" : 131078,
    "exprs" : [ {
      "ref" : "`c_custkey`",
      "expr" : "`c_custkey`"
    }, {
      "ref" : "`c_name`",
      "expr" : "`c_name`"
    }, {
      "ref" : "`c_address`",
      "expr" : "`c_address`"
    }, {
      "ref" : "`c_phone`",
      "expr" : "`c_phone`"
    }, {
      "ref" : "`c_acctbal`",
      "expr" : "`c_acctbal`"
    }, {
      "ref" : "`c_comment`",
      "expr" : "`c_comment`"
    }, {
      "ref" : "`n_name`",
      "expr" : "`n_name`"
    }, {
      "ref" : "`o_orderdate`",
      "expr" : "`o_orderdate`"
    }, {
      "ref" : "`l_extendedprice`",
      "expr" : "`l_extendedprice`"
    }, {
      "ref" : "`l_discount`",
      "expr" : "`l_discount`"
    }, {
      "ref" : "`l_returnflag`",
      "expr" : "`l_returnflag`"
    } ],
    "child" : 131079,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 6051219.0
  }, {
    "pop" : "filter",
    "@id" : 131077,
    "child" : 131078,
    "expr" : "booleanAnd(greater_than_or_equal_to(`o_orderdate`, cast( 749433600000 as DATE)) , less_than(`o_orderdate`, cast( 757382400000 as TIMESTAMP)) , equal(`l_returnflag`, 'R') ) ",
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 226920.7125
  }, {
    "pop" : "selection-vector-remover",
    "@id" : 131076,
    "child" : 131077,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 226920.7125
  }, {
    "pop" : "project",
    "@id" : 131075,
    "exprs" : [ {
      "ref" : "`c_custkey`",
      "expr" : "`c_custkey`"
    }, {
      "ref" : "`c_name`",
      "expr" : "`c_name`"
    }, {
      "ref" : "`c_acctbal`",
      "expr" : "`c_acctbal`"
    }, {
      "ref" : "`c_phone`",
      "expr" : "`c_phone`"
    }, {
      "ref" : "`n_name`",
      "expr" : "`n_name`"
    }, {
      "ref" : "`c_address`",
      "expr" : "`c_address`"
    }, {
      "ref" : "`c_comment`",
      "expr" : "`c_comment`"
    }, {
      "ref" : "`$f7`",
      "expr" : "multiply(`l_extendedprice`, subtract(1, `l_discount`) ) "
    } ],
    "child" : 131076,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 226920.7125
  }, {
    "pop" : "hash-aggregate",
    "@id" : 131074,
    "child" : 131075,
    "cardinality" : 1.0,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "aggPhase" : "PHASE_1of2",
    "groupByExprs" : [ {
      "ref" : "`c_custkey`",
      "expr" : "`c_custkey`"
    }, {
      "ref" : "`c_name`",
      "expr" : "`c_name`"
    }, {
      "ref" : "`c_acctbal`",
      "expr" : "`c_acctbal`"
    }, {
      "ref" : "`c_phone`",
      "expr" : "`c_phone`"
    }, {
      "ref" : "`n_name`",
      "expr" : "`n_name`"
    }, {
      "ref" : "`c_address`",
      "expr" : "`c_address`"
    }, {
      "ref" : "`c_comment`",
      "expr" : "`c_comment`"
    } ],
    "aggrExprs" : [ {
      "ref" : "`revenue`",
      "expr" : "sum(`$f7`) "
    } ],
    "cost" : 225147.89443359376
  }, {
    "pop" : "project",
    "@id" : 131073,
    "exprs" : [ {
      "ref" : "`c_custkey`",
      "expr" : "`c_custkey`"
    }, {
      "ref" : "`c_name`",
      "expr" : "`c_name`"
    }, {
      "ref" : "`c_acctbal`",
      "expr" : "`c_acctbal`"
    }, {
      "ref" : "`c_phone`",
      "expr" : "`c_phone`"
    }, {
      "ref" : "`n_name`",
      "expr" : "`n_name`"
    }, {
      "ref" : "`c_address`",
      "expr" : "`c_address`"
    }, {
      "ref" : "`c_comment`",
      "expr" : "`c_comment`"
    }, {
      "ref" : "`revenue`",
      "expr" : "`revenue`"
    }, {
      "ref" : "`E_X_P_R_H_A_S_H_F_I_E_L_D`",
      "expr" : "hash32asdouble(`c_comment`, hash32asdouble(`c_address`, hash32asdouble(`n_name`, hash32asdouble(`c_phone`, hash32asdouble(`c_acctbal`, hash32asdouble(`c_name`, hash32asdouble(`c_custkey`, 1301011) ) ) ) ) ) ) "
    } ],
    "child" : 131074,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 22692.07125
  }, {
    "pop" : "unordered-mux-exchange",
    "@id" : 65537,
    "child" : 131073,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 22692.07125
  }, {
    "pop" : "hash-to-random-exchange",
    "@id" : 10,
    "child" : 65537,
    "expr" : "`E_X_P_R_H_A_S_H_F_I_E_L_D`",
    "initialAllocation" : 1000000,
   [1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
1 row selected (0.456 seconds)
0: jdbc:drill:zk=zookeeper:2181> Closing: org.apache.drill.jdbc.impl.DrillConnectionImpl
13/04/2019 12:56:11.384
--------------------------------------Finished QUERY 10.--------------------------------

--------------------------------------STARTED QUERY 11. ---------------------------------
--------------------------------------Finished QUERY 11.--------------------------------

--------------------------------------STARTED QUERY 12. ---------------------------------
13/04/2019 12:56:11.400
Apr 13, 2019 12:56:12 PM org.jline.utils.Log logr
WARNING: Unable to create a system terminal, creating a dumb terminal (enable debug logging for more information)
Apache Drill 1.15.0
"The only truly happy people are children, the creative minority and Drill users."
0: jdbc:drill:zk=zookeeper:2181> explain plan for select l_shipmode, sum(case when o_orderpriority ='1-URGENT' or o_orderpriority ='2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from hive.denormalized_parquet where  l_shipmode in ('MAIL', 'SHIP')[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m[1m                                      text                                      [m[1;32m | [m[1m                                      json                                      [m[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m00-00    Screen
00-01      Project(l_shipmode=[$0], high_line_count=[$1], low_line_count=[$2])
00-02        SelectionVectorRemover
00-03          Sort(sort0=[$0], dir0=[ASC])
00-04            HashAgg(group=[{0}], high_line_count=[$SUM0($1)], low_line_count=[$SUM0($2)])
00-05              Project(l_shipmode=[$0], $f1=[$1], $f2=[$2])
00-06                HashToRandomExchange(dist0=[[$0]])
01-01                  UnorderedMuxExchange
02-01                    Project(l_shipmode=[$0], $f1=[$1], $f2=[$2], E_X_P_R_H_A_S_H_F_I_E_L_D=[hash32AsDouble($0, 1301011)])
02-02                      Project(l_shipmode=[$4], $f1=[CASE(OR(=($0, '1-URGENT'), =($0, '2-HIGH')), 1, 0)], $f2=[CASE(AND(<>($0, '1-URGENT'), <>($0, '2-HIGH')), 1, 0)])
02-03                        SelectionVectorRemover
02-04                          Filter(condition=[AND(OR(=($4, 'MAIL'), =($4, 'SHIP')), <($2, $3), <($1, $2), >=($3, 1994-01-01), <($3, 1995-01-01 00:00:00))])
02-05                            Project(o_orderpriority=[$0], l_shipdate=[$1], l_commitdate=[$2], l_receiptdate=[$3], l_shipmode=[$4])
02-06                              Scan(table=[[hive, denormalized_parquet]], groupscan=[HiveDrillNativeParquetScan [entries=[ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000000_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000001_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000002_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000003_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000004_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000005_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000006_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000007_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000008_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000009_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000010_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000011_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000012_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000013_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000014_0]], numFiles=15, numRowGroups=16, columns=[`o_orderpriority`, `l_shipdate`, `l_commitdate`, `l_receiptdate`, `l_shipmode`]]])
[1;32m | [m{
  "head" : {
    "version" : 1,
    "generator" : {
      "type" : "ExplainHandler",
      "info" : ""
    },
    "type" : "APACHE_DRILL_PHYSICAL",
    "options" : [ ],
    "queue" : 0,
    "hasResourcePlan" : false,
    "resultMode" : "EXEC"
  },
  "graph" : [ {
    "pop" : "hive-drill-native-parquet-scan",
    "@id" : 131078,
    "userName" : "root",
    "hiveStoragePluginConfig" : {
      "type" : "hive",
      "configProps" : {
        "hive.metastore.uris" : "thrift://hive-metastore:9083",
        "hive.metastore.sasl.enabled" : "false",
        "fs.default.name" : "hdfs://namenode"
      },
      "enabled" : true
    },
    "columns" : [ "`o_orderpriority`", "`l_shipdate`", "`l_commitdate`", "`l_receiptdate`", "`l_shipmode`" ],
    "entries" : [ {
      "path" : "/user/hive/warehouse/denormalized_parquet/000000_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000001_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000002_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000003_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000004_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000005_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000006_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000007_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000008_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000009_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000010_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000011_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000012_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000013_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000014_0"
    } ],
    "hivePartitionHolder" : {
      "keyToIndexMapper" : { },
      "partitionValues" : [ ]
    },
    "confProperties" : { },
    "cost" : 6051219.0
  }, {
    "pop" : "project",
    "@id" : 131077,
    "exprs" : [ {
      "ref" : "`o_orderpriority`",
      "expr" : "`o_orderpriority`"
    }, {
      "ref" : "`l_shipdate`",
      "expr" : "`l_shipdate`"
    }, {
      "ref" : "`l_commitdate`",
      "expr" : "`l_commitdate`"
    }, {
      "ref" : "`l_receiptdate`",
      "expr" : "`l_receiptdate`"
    }, {
      "ref" : "`l_shipmode`",
      "expr" : "`l_shipmode`"
    } ],
    "child" : 131078,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 6051219.0
  }, {
    "pop" : "filter",
    "@id" : 131076,
    "child" : 131077,
    "expr" : "booleanAnd(booleanOr(equal(`l_shipmode`, 'MAIL') , equal(`l_shipmode`, 'SHIP') ) , less_than(`l_commitdate`, `l_receiptdate`) , less_than(`l_shipdate`, `l_commitdate`) , greater_than_or_equal_to(`l_receiptdate`, cast( 757382400000 as DATE)) , less_than(`l_receiptdate`, cast( 788918400000 as TIMESTAMP)) ) ",
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 94550.296875
  }, {
    "pop" : "selection-vector-remover",
    "@id" : 131075,
    "child" : 131076,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 94550.296875
  }, {
    "pop" : "project",
    "@id" : 131074,
    "exprs" : [ {
      "ref" : "`l_shipmode`",
      "expr" : "`l_shipmode`"
    }, {
      "ref" : "`$f1`",
      "expr" : " ( if (booleanOr(equal(`o_orderpriority`, '1-URGENT') , equal(`o_orderpriority`, '2-HIGH') )  ) then (1 )  else (0 )  end  ) "
    }, {
      "ref" : "`$f2`",
      "expr" : " ( if (booleanAnd(not_equal(`o_orderpriority`, '1-URGENT') , not_equal(`o_orderpriority`, '2-HIGH') )  ) then (1 )  else (0 )  end  ) "
    } ],
    "child" : 131075,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 94550.296875
  }, {
    "pop" : "project",
    "@id" : 131073,
    "exprs" : [ {
      "ref" : "`l_shipmode`",
      "expr" : "`l_shipmode`"
    }, {
      "ref" : "`$f1`",
      "expr" : "`$f1`"
    }, {
      "ref" : "`$f2`",
      "expr" : "`$f2`"
    }, {
      "ref" : "`E_X_P_R_H_A_S_H_F_I_E_L_D`",
      "expr" : "hash32asdouble(`l_shipmode`, 1301011) "
    } ],
    "child" : 131074,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 94550.296875
  }, {
    "pop" : "unordered-mux-exchange",
    "@id" : 65537,
    "child" : 131073,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 94550.296875
  }, {
    "pop" : "hash-to-random-exchange",
    "@id" : 6,
    "child" : 65537,
    "expr" : "`E_X_P_R_H_A_S_H_F_I_E_L_D`",
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 94550.296875
  }, {
    "pop" : "project",
    "@id" : 5,
    "exprs" : [ {
      "ref" : "`l_shipmode`",
      "expr" : "`l_shipmode`"
    }, {
      "ref" : "`$f1`",
      "expr" : "`$f1`"
    }, {
      "ref" : "`$f2`",
      "expr" : "`$f2`"
    } ],
    "child" : 6,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 94550.296875
  }, {
    "pop" : "hash-aggregate",
    "@id" : 4,
    "child" : 5,
    "cardinality" : 1.0,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "aggPhase" : "PHASE_1of1",
    "groupByExprs" : [ {
      "ref" : "`l_shipmode`",
      "expr" : "`l_shipmode`"
    } ],
    "aggrExprs" : [ {
      "ref" : "`high_line_count`",
      "expr" : "$sum0(`$f1`) "
    }, {
      "ref" : "`low_line_count`",
      "expr" : "$sum0(`$f2`) "
    } ],
    "cost" : 47275.1484375
  }, {
    "pop" : "external-sort",
    "@id" : 3,
    "child" : 4,
    "orderings" : [ {
      "order" : "ASC",
      "expr" : "`l_shipmode`",
      "nullDirection" : "LAST"
    } ],
    "reverse" : false,
    "initialAllocation" : 20000000,
    "maxAllocation" : 10000000000,
    "cost" : 9455.0296875
  }, {
    "pop" : "selection-vector-remover",
    "@id" : 2,
    "child" : 3,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 9455.0296875
  }, {
    "pop" : "project",
    "@id" : 1,
    "exprs" : [ {
      "ref" : "`l_shipmode`",
      "expr" : "`l_shipmode`"
    }, {
      "ref" : "`high_line_count`",
      "expr" : "`high_line_count`"
    }, {
      "ref" : "`low_line_count`",
      "expr" : "`low_line_count`"
    } ],
    "child" : 2,
    "outputProj" : true,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 9455.0296875
  }, {
    "pop" : "screen",
    "@id" : 0,
    "child" : 1,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 9455.0296875
  } ]
}[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
1 row selected (0.428 seconds)
0: jdbc:drill:zk=zookeeper:2181> Closing: org.apache.drill.jdbc.impl.DrillConnectionImpl
13/04/2019 12:56:15.018
--------------------------------------Finished QUERY 12.--------------------------------

--------------------------------------STARTED QUERY 13. ---------------------------------
--------------------------------------Finished QUERY 13.--------------------------------

--------------------------------------STARTED QUERY 14. ---------------------------------
13/04/2019 12:56:15.035
Apr 13, 2019 12:56:15 PM org.jline.utils.Log logr
WARNING: Unable to create a system terminal, creating a dumb terminal (enable debug logging for more information)
Apache Drill 1.15.0
"Just Drill It."
0: jdbc:drill:zk=zookeeper:2181> explain plan for select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice*(1-l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount))[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m[1m                                      text                                      [m[1;32m | [m[1m                                      json                                      [m[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m00-00    Screen
00-01      Project(promo_revenue=[/(*(100.00, $0), $1)])
00-02        StreamAgg(group=[{}], agg#0=[SUM($0)], agg#1=[SUM($1)])
00-03          UnionExchange
01-01            StreamAgg(group=[{}], agg#0=[SUM($0)], agg#1=[SUM($1)])
01-02              Project($f0=[CASE(LIKE($5, 'PROMO%'), *($1, -(1, $2)), 0)], $f1=[*($1, -(1, $2))])
01-03                SelectionVectorRemover
01-04                  Filter(condition=[AND(=($0, $4), >=($3, 1995-09-01), <($3, 1995-10-01 00:00:00))])
01-05                    Project(l_partkey=[$0], l_extendedprice=[$1], l_discount=[$2], l_shipdate=[$3], p_partkey=[$4], p_type=[$5])
01-06                      Scan(table=[[hive, denormalized_parquet]], groupscan=[HiveDrillNativeParquetScan [entries=[ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000000_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000001_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000002_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000003_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000004_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000005_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000006_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000007_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000008_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000009_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000010_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000011_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000012_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000013_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000014_0]], numFiles=15, numRowGroups=16, columns=[`l_partkey`, `l_extendedprice`, `l_discount`, `l_shipdate`, `p_partkey`, `p_type`]]])
[1;32m | [m{
  "head" : {
    "version" : 1,
    "generator" : {
      "type" : "ExplainHandler",
      "info" : ""
    },
    "type" : "APACHE_DRILL_PHYSICAL",
    "options" : [ ],
    "queue" : 0,
    "hasResourcePlan" : false,
    "resultMode" : "EXEC"
  },
  "graph" : [ {
    "pop" : "hive-drill-native-parquet-scan",
    "@id" : 65542,
    "userName" : "root",
    "hiveStoragePluginConfig" : {
      "type" : "hive",
      "configProps" : {
        "hive.metastore.uris" : "thrift://hive-metastore:9083",
        "hive.metastore.sasl.enabled" : "false",
        "fs.default.name" : "hdfs://namenode"
      },
      "enabled" : true
    },
    "columns" : [ "`l_partkey`", "`l_extendedprice`", "`l_discount`", "`l_shipdate`", "`p_partkey`", "`p_type`" ],
    "entries" : [ {
      "path" : "/user/hive/warehouse/denormalized_parquet/000000_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000001_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000002_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000003_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000004_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000005_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000006_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000007_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000008_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000009_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000010_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000011_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000012_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000013_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000014_0"
    } ],
    "hivePartitionHolder" : {
      "keyToIndexMapper" : { },
      "partitionValues" : [ ]
    },
    "confProperties" : { },
    "cost" : 6051219.0
  }, {
    "pop" : "project",
    "@id" : 65541,
    "exprs" : [ {
      "ref" : "`l_partkey`",
      "expr" : "`l_partkey`"
    }, {
      "ref" : "`l_extendedprice`",
      "expr" : "`l_extendedprice`"
    }, {
      "ref" : "`l_discount`",
      "expr" : "`l_discount`"
    }, {
      "ref" : "`l_shipdate`",
      "expr" : "`l_shipdate`"
    }, {
      "ref" : "`p_partkey`",
      "expr" : "`p_partkey`"
    }, {
      "ref" : "`p_type`",
      "expr" : "`p_type`"
    } ],
    "child" : 65542,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 6051219.0
  }, {
    "pop" : "filter",
    "@id" : 65540,
    "child" : 65541,
    "expr" : "booleanAnd(equal(`l_partkey`, `p_partkey`) , greater_than_or_equal_to(`l_shipdate`, cast( 809913600000 as DATE)) , less_than(`l_shipdate`, cast( 812505600000 as TIMESTAMP)) ) ",
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 226920.7125
  }, {
    "pop" : "selection-vector-remover",
    "@id" : 65539,
    "child" : 65540,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 226920.7125
  }, {
    "pop" : "project",
    "@id" : 65538,
    "exprs" : [ {
      "ref" : "`$f0`",
      "expr" : " ( if (like(`p_type`, 'PROMO%')  ) then (multiply(`l_extendedprice`, subtract(1, `l_discount`) )  )  else (0 )  end  ) "
    }, {
      "ref" : "`$f1`",
      "expr" : "multiply(`l_extendedprice`, subtract(1, `l_discount`) ) "
    } ],
    "child" : 65539,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 226920.7125
  }, {
    "pop" : "streaming-aggregate",
    "@id" : 65537,
    "child" : 65538,
    "keys" : [ ],
    "exprs" : [ {
      "ref" : "`$f0`",
      "expr" : "sum(`$f0`) "
    }, {
      "ref" : "`$f1`",
      "expr" : "sum(`$f1`) "
    } ],
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 1.0
  }, {
    "pop" : "union-exchange",
    "@id" : 3,
    "child" : 65537,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 1.0
  }, {
    "pop" : "streaming-aggregate",
    "@id" : 2,
    "child" : 3,
    "keys" : [ ],
    "exprs" : [ {
      "ref" : "`$f0`",
      "expr" : "sum(`$f0`) "
    }, {
      "ref" : "`$f1`",
      "expr" : "sum(`$f1`) "
    } ],
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 1.0
  }, {
    "pop" : "project",
    "@id" : 1,
    "exprs" : [ {
      "ref" : "`promo_revenue`",
      "expr" : "divide(multiply(100.00, `$f0`) , `$f1`) "
    } ],
    "child" : 2,
    "outputProj" : true,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 1.0
  }, {
    "pop" : "screen",
    "@id" : 0,
    "child" : 1,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 1.0
  } ]
}[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
1 row selected (0.447 seconds)
0: jdbc:drill:zk=zookeeper:2181> Closing: org.apache.drill.jdbc.impl.DrillConnectionImpl
13/04/2019 12:56:18.740
--------------------------------------Finished QUERY 14.--------------------------------

--------------------------------------STARTED QUERY 15. ---------------------------------
13/04/2019 12:56:18.751
Apr 13, 2019 12:56:19 PM org.jline.utils.Log logr
WARNING: Unable to create a system terminal, creating a dumb terminal (enable debug logging for more information)
Apache Drill 1.15.0
"You're gonna need a bigger Drill."
0: jdbc:drill:zk=zookeeper:2181> explain plan for select l_suppkey as supplier_no,sum(l_extendedprice * (1 - l_discount))[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m[1m                                      text                                      [m[1;32m | [m[1m                                      json                                      [m[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m00-00    Screen
00-01      Project(supplier_no=[$0], total_revenue=[$1], s_name=[$2], s_address=[$3], s_phone=[$4])
00-02        SelectionVectorRemover
00-03          Limit(fetch=[1])
00-04            Limit(fetch=[1])
00-05              SelectionVectorRemover
00-06                TopN(limit=[1])
00-07                  Project(supplier_no=[$0], total_revenue=[$1], s_name=[$2], s_address=[$3], s_phone=[$4])
00-08                    HashToRandomExchange(dist0=[[$1]])
01-01                      UnorderedMuxExchange
02-01                        Project(supplier_no=[$0], total_revenue=[$1], s_name=[$2], s_address=[$3], s_phone=[$4], E_X_P_R_H_A_S_H_F_I_E_L_D=[hash32AsDouble($1, 1301011)])
02-02                          Project(supplier_no=[$0], total_revenue=[$4], s_name=[$1], s_address=[$2], s_phone=[$3])
02-03                            HashAgg(group=[{0, 1, 2, 3}], total_revenue=[SUM($4)])
02-04                              Project(supplier_no=[$0], s_name=[$1], s_address=[$2], s_phone=[$3], total_revenue=[$4])
02-05                                HashToRandomExchange(dist0=[[$0]], dist1=[[$1]], dist2=[[$2]], dist3=[[$3]])
03-01                                  UnorderedMuxExchange
04-01                                    Project(supplier_no=[$0], s_name=[$1], s_address=[$2], s_phone=[$3], total_revenue=[$4], E_X_P_R_H_A_S_H_F_I_E_L_D=[hash32AsDouble($3, hash32AsDouble($2, hash32AsDouble($1, hash32AsDouble($0, 1301011))))])
04-02                                      HashAgg(group=[{0, 1, 2, 3}], total_revenue=[SUM($4)])
04-03                                        Project(supplier_no=[$0], s_name=[$4], s_address=[$5], s_phone=[$6], $f4=[*($1, -(1, $2))])
04-04                                          SelectionVectorRemover
04-05                                            Filter(condition=[AND(>=($3, 1996-01-01), <($3, 1996-04-01 00:00:00))])
04-06                                              Project(l_suppkey=[$0], l_extendedprice=[$1], l_discount=[$2], l_shipdate=[$3], s_name=[$4], s_address=[$5], s_phone=[$6])
04-07                                                Scan(table=[[hive, denormalized_parquet]], groupscan=[HiveDrillNativeParquetScan [entries=[ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000000_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000001_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000002_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000003_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000004_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000005_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000006_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000007_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000008_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000009_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000010_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000011_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000012_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000013_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000014_0]], numFiles=15, numRowGroups=16, columns=[`l_suppkey`, `l_extendedprice`, `l_discount`, `l_shipdate`, `s_name`, `s_address`, `s_phone`]]])
[1;32m | [m{
  "head" : {
    "version" : 1,
    "generator" : {
      "type" : "ExplainHandler",
      "info" : ""
    },
    "type" : "APACHE_DRILL_PHYSICAL",
    "options" : [ ],
    "queue" : 0,
    "hasResourcePlan" : false,
    "resultMode" : "EXEC"
  },
  "graph" : [ {
    "pop" : "hive-drill-native-parquet-scan",
    "@id" : 262151,
    "userName" : "root",
    "hiveStoragePluginConfig" : {
      "type" : "hive",
      "configProps" : {
        "hive.metastore.uris" : "thrift://hive-metastore:9083",
        "hive.metastore.sasl.enabled" : "false",
        "fs.default.name" : "hdfs://namenode"
      },
      "enabled" : true
    },
    "columns" : [ "`l_suppkey`", "`l_extendedprice`", "`l_discount`", "`l_shipdate`", "`s_name`", "`s_address`", "`s_phone`" ],
    "entries" : [ {
      "path" : "/user/hive/warehouse/denormalized_parquet/000000_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000001_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000002_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000003_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000004_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000005_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000006_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000007_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000008_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000009_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000010_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000011_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000012_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000013_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000014_0"
    } ],
    "hivePartitionHolder" : {
      "keyToIndexMapper" : { },
      "partitionValues" : [ ]
    },
    "confProperties" : { },
    "cost" : 6051219.0
  }, {
    "pop" : "project",
    "@id" : 262150,
    "exprs" : [ {
      "ref" : "`l_suppkey`",
      "expr" : "`l_suppkey`"
    }, {
      "ref" : "`l_extendedprice`",
      "expr" : "`l_extendedprice`"
    }, {
      "ref" : "`l_discount`",
      "expr" : "`l_discount`"
    }, {
      "ref" : "`l_shipdate`",
      "expr" : "`l_shipdate`"
    }, {
      "ref" : "`s_name`",
      "expr" : "`s_name`"
    }, {
      "ref" : "`s_address`",
      "expr" : "`s_address`"
    }, {
      "ref" : "`s_phone`",
      "expr" : "`s_phone`"
    } ],
    "child" : 262151,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 6051219.0
  }, {
    "pop" : "filter",
    "@id" : 262149,
    "child" : 262150,
    "expr" : "booleanAnd(greater_than_or_equal_to(`l_shipdate`, cast( 820454400000 as DATE)) , less_than(`l_shipdate`, cast( 828316800000 as TIMESTAMP)) ) ",
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 1512804.75
  }, {
    "pop" : "selection-vector-remover",
    "@id" : 262148,
    "child" : 262149,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 1512804.75
  }, {
    "pop" : "project",
    "@id" : 262147,
    "exprs" : [ {
      "ref" : "`supplier_no`",
      "expr" : "`l_suppkey`"
    }, {
      "ref" : "`s_name`",
      "expr" : "`s_name`"
    }, {
      "ref" : "`s_address`",
      "expr" : "`s_address`"
    }, {
      "ref" : "`s_phone`",
      "expr" : "`s_phone`"
    }, {
      "ref" : "`$f4`",
      "expr" : "multiply(`l_extendedprice`, subtract(1, `l_discount`) ) "
    } ],
    "child" : 262148,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 1512804.75
  }, {
    "pop" : "hash-aggregate",
    "@id" : 262146,
    "child" : 262147,
    "cardinality" : 1.0,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "aggPhase" : "PHASE_1of2",
    "groupByExprs" : [ {
      "ref" : "`supplier_no`",
      "expr" : "`supplier_no`"
    }, {
      "ref" : "`s_name`",
      "expr" : "`s_name`"
    }, {
      "ref" : "`s_address`",
      "expr" : "`s_address`"
    }, {
      "ref" : "`s_phone`",
      "expr" : "`s_phone`"
    } ],
    "aggrExprs" : [ {
      "ref" : "`total_revenue`",
      "expr" : "sum(`$f4`) "
    } ],
    "cost" : 1418254.453125
  }, {
    "pop" : "project",
    "@id" : 262145,
    "exprs" : [ {
      "ref" : "`supplier_no`",
      "expr" : "`supplier_no`"
    }, {
      "ref" : "`s_name`",
      "expr" : "`s_name`"
    }, {
      "ref" : "`s_address`",
      "expr" : "`s_address`"
    }, {
      "ref" : "`s_phone`",
      "expr" : "`s_phone`"
    }, {
      "ref" : "`total_revenue`",
      "expr" : "`total_revenue`"
    }, {
      "ref" : "`E_X_P_R_H_A_S_H_F_I_E_L_D`",
      "expr" : "hash32asdouble(`s_phone`, hash32asdouble(`s_address`, hash32asdouble(`s_name`, hash32asdouble(`supplier_no`, 1301011) ) ) ) "
    } ],
    "child" : 262146,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 151280.475
  }, {
    "pop" : "unordered-mux-exchange",
    "@id" : 196609,
    "child" : 262145,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 151280.475
  }, {
    "pop" : "hash-to-random-exchange",
    "@id" : 131077,
    "child" : 196609,
    "expr" : "`E_X_P_R_H_A_S_H_F_I_E_L_D`",
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 151280.475
  }, {
    "pop" : "project",
    "@id" : 131076,
    "exprs" : [ {
      "ref" : "`supplier_no`",
      "expr" : "`supplier_no`"
    }, {
      "ref" : "`s_name`",
      "expr" : "`s_name`"
    }, {
      "ref" : "`s_address`",
      "expr" : "`s_address`"
    }, {
      "ref" : "`s_phone`",
      "expr" : "`s_phone`"
    }, {
      "ref" : "`total_revenue`",
      "expr" : "`total_revenue`"
    } ],
    "child" : 131077,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 151280.475
  }, {
    "pop" : "hash-aggregate",
    "@id" : 131075,
    "child" : 131076,
    "cardinality" : 1.0,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "aggPhase" : "PHASE_2of2",
    "groupByExprs" : [ {
      "ref" : "`supplier_no`",
      "expr" : "`supplier_no`"
    }, {
      "ref" : "`s_name`",
      "expr" : "`s_n[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
1 row selected (0.476 seconds)
0: jdbc:drill:zk=zookeeper:2181> Closing: org.apache.drill.jdbc.impl.DrillConnectionImpl
13/04/2019 12:56:22.405
--------------------------------------Finished QUERY 15.--------------------------------

--------------------------------------STARTED QUERY 16. ---------------------------------
13/04/2019 12:56:22.415
Apr 13, 2019 12:56:23 PM org.jline.utils.Log logr
WARNING: Unable to create a system terminal, creating a dumb terminal (enable debug logging for more information)
Apache Drill 1.15.0
"Drill must go on."
0: jdbc:drill:zk=zookeeper:2181> explain plan for select p_brand, p_type, p_size, count(distinct s_suppkey) as supplier_cnt  from hive.denormalized_parquet  where p_brand <> 'Brand#45' and p_type not like 'MEDIUM POLISHED%'  and p_size in (49, 14, 23, 45, 19, 3, 36, 9)[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m[1m                                      text                                      [m[1;32m | [m[1m                                      json                                      [m[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m00-00    Screen
00-01      Project(p_brand=[$0], p_type=[$1], p_size=[$2], supplier_cnt=[$3])
00-02        SelectionVectorRemover
00-03          Sort(sort0=[$3], sort1=[$0], sort2=[$1], sort3=[$2], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC])
00-04            HashAgg(group=[{0, 1, 2}], supplier_cnt=[COUNT($3)])
00-05              HashAgg(group=[{0, 1, 2, 3}])
00-06                Project(p_brand=[$0], p_type=[$1], p_size=[$2], s_suppkey=[$3])
00-07                  HashToRandomExchange(dist0=[[$0]])
01-01                    UnorderedMuxExchange
02-01                      Project(p_brand=[$0], p_type=[$1], p_size=[$2], s_suppkey=[$3], E_X_P_R_H_A_S_H_F_I_E_L_D=[hash32AsDouble($0, 1301011)])
02-02                        Project(p_brand=[$2], p_type=[$3], p_size=[$4], s_suppkey=[$0])
02-03                          SelectionVectorRemover
02-04                            Filter(condition=[AND(<>($2, 'Brand#45'), OR(=($4, 49), =($4, 14), =($4, 23), =($4, 45), =($4, 19), =($4, 3), =($4, 36), =($4, 9)), NOT(LIKE($3, 'MEDIUM POLISHED%')), NOT(LIKE($1, '%Customer%Complaints%')))])
02-05                              Project(s_suppkey=[$0], s_comment=[$1], p_brand=[$2], p_type=[$3], p_size=[$4])
02-06                                Scan(table=[[hive, denormalized_parquet]], groupscan=[HiveDrillNativeParquetScan [entries=[ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000000_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000001_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000002_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000003_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000004_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000005_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000006_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000007_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000008_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000009_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000010_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000011_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000012_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000013_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000014_0]], numFiles=15, numRowGroups=16, columns=[`s_suppkey`, `s_comment`, `p_brand`, `p_type`, `p_size`]]])
[1;32m | [m{
  "head" : {
    "version" : 1,
    "generator" : {
      "type" : "ExplainHandler",
      "info" : ""
    },
    "type" : "APACHE_DRILL_PHYSICAL",
    "options" : [ ],
    "queue" : 0,
    "hasResourcePlan" : false,
    "resultMode" : "EXEC"
  },
  "graph" : [ {
    "pop" : "hive-drill-native-parquet-scan",
    "@id" : 131078,
    "userName" : "root",
    "hiveStoragePluginConfig" : {
      "type" : "hive",
      "configProps" : {
        "hive.metastore.uris" : "thrift://hive-metastore:9083",
        "hive.metastore.sasl.enabled" : "false",
        "fs.default.name" : "hdfs://namenode"
      },
      "enabled" : true
    },
    "columns" : [ "`s_suppkey`", "`s_comment`", "`p_brand`", "`p_type`", "`p_size`" ],
    "entries" : [ {
      "path" : "/user/hive/warehouse/denormalized_parquet/000000_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000001_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000002_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000003_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000004_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000005_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000006_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000007_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000008_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000009_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000010_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000011_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000012_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000013_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000014_0"
    } ],
    "hivePartitionHolder" : {
      "keyToIndexMapper" : { },
      "partitionValues" : [ ]
    },
    "confProperties" : { },
    "cost" : 6051219.0
  }, {
    "pop" : "project",
    "@id" : 131077,
    "exprs" : [ {
      "ref" : "`s_suppkey`",
      "expr" : "`s_suppkey`"
    }, {
      "ref" : "`s_comment`",
      "expr" : "`s_comment`"
    }, {
      "ref" : "`p_brand`",
      "expr" : "`p_brand`"
    }, {
      "ref" : "`p_type`",
      "expr" : "`p_type`"
    }, {
      "ref" : "`p_size`",
      "expr" : "`p_size`"
    } ],
    "child" : 131078,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 6051219.0
  }, {
    "pop" : "filter",
    "@id" : 131076,
    "child" : 131077,
    "expr" : "booleanAnd(not_equal(`p_brand`, 'Brand#45') , booleanOr(equal(`p_size`, 49) , equal(`p_size`, 14) , equal(`p_size`, 23) , equal(`p_size`, 45) , equal(`p_size`, 19) , equal(`p_size`, 3) , equal(`p_size`, 36) , equal(`p_size`, 9) ) , not(like(`p_type`, 'MEDIUM POLISHED%') ) , not(like(`s_comment`, '%Customer%Complaints%') ) ) ",
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 47275.1484375
  }, {
    "pop" : "selection-vector-remover",
    "@id" : 131075,
    "child" : 131076,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 47275.1484375
  }, {
    "pop" : "project",
    "@id" : 131074,
    "exprs" : [ {
      "ref" : "`p_brand`",
      "expr" : "`p_brand`"
    }, {
      "ref" : "`p_type`",
      "expr" : "`p_type`"
    }, {
      "ref" : "`p_size`",
      "expr" : "`p_size`"
    }, {
      "ref" : "`s_suppkey`",
      "expr" : "`s_suppkey`"
    } ],
    "child" : 131075,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 47275.1484375
  }, {
    "pop" : "project",
    "@id" : 131073,
    "exprs" : [ {
      "ref" : "`p_brand`",
      "expr" : "`p_brand`"
    }, {
      "ref" : "`p_type`",
      "expr" : "`p_type`"
    }, {
      "ref" : "`p_size`",
      "expr" : "`p_size`"
    }, {
      "ref" : "`s_suppkey`",
      "expr" : "`s_suppkey`"
    }, {
      "ref" : "`E_X_P_R_H_A_S_H_F_I_E_L_D`",
      "expr" : "hash32asdouble(`p_brand`, 1301011) "
    } ],
    "child" : 131074,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 47275.1484375
  }, {
    "pop" : "unordered-mux-exchange",
    "@id" : 65537,
    "child" : 131073,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 47275.1484375
  }, {
    "pop" : "hash-to-random-exchange",
    "@id" : 7,
    "child" : 65537,
    "expr" : "`E_X_P_R_H_A_S_H_F_I_E_L_D`",
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 47275.1484375
  }, {
    "pop" : "project",
    "@id" : 6,
    "exprs" : [ {
      "ref" : "`p_brand`",
      "expr" : "`p_brand`"
    }, {
      "ref" : "`p_type`",
      "expr" : "`p_type`"
    }, {
      "ref" : "`p_size`",
      "expr" : "`p_size`"
    }, {
      "ref" : "`s_suppkey`",
      "expr" : "`s_suppkey`"
    } ],
    "child" : 7,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 47275.1484375
  }, {
    "pop" : "hash-aggregate",
    "@id" : 5,
    "child" : 6,
    "cardinality" : 1.0,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "aggPhase" : "PHASE_1of1",
    "groupByExprs" : [ {
      "ref" : "`p_brand`",
      "expr" : "`p_brand`"
    }, {
      "ref" : "`p_type`",
      "expr" : "`p_type`"
    }, {
      "ref" : "`p_size`",
      "expr" : "`p_size`"
    }, {
      "ref" : "`s_suppkey`",
      "expr" : "`s_suppkey`"
    } ],
    "aggrExprs" : [ ],
    "cost" : 44320.45166015625
  }, {
    "pop" : "hash-aggregate",
    "@id" : 4,
    "child" : 5,
    "cardinality" : 1.0,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "aggPhase" : "PHASE_1of1",
    "groupByExprs" : [ {
      "ref" : "`p_brand`",
      "expr" : "`p_brand`"
    }, {
      "ref" : "`p_type`",
      "expr" : "`p_type`"
    }, {
      "ref" : "`p_size`",
      "expr" : "`p_size`"
    } ],
    "aggrExprs" : [ {
      "ref" : "`supplier_cnt`",
      "expr" : "count(`s_suppkey`) "
    } ],
    "cost" : 4136.57548828125
  }, {
    "pop" : "external-sort",
    "@id" : 3,
    "child" : 4,
    "orderings" : [ {
      "order" : "DESC",
      "expr" : "`supplier_cnt`",
      "nullDirection" : "FIRST"
    }, {
      "order" : "ASC",
      "expr" : "`p_brand`",
      "nullDirection" : "LAST"
    }, {
      "order" : "ASC",
      "expr" : "`p_type`",
      "nullDirection" : "LAST"
    }, {
      "order" : "ASC",
      "expr" : "`p_size`",
      "nullDirection" : "LAST"
    } ],
    "reverse" : false,
    "initialAllocation" : 20000000,
    "maxAllocation" : 10000000000,
    "cost" : 472.751484375
  }, {
    "pop" : "selection-vector-remover",
    "@id" : 2,
    "child" : 3,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 472.751484375
  }, {
    "pop" : "project",
    "@id" : 1,
    "exprs" : [ {
      "ref" : "`p_brand`",
      "expr" : "`p_brand`"
    }, {
      "ref" : "`p_type`",
      "expr" : "`p_type`"
    }, {
      "ref" : "`p_size`",
      "expr" : "`p_size`"
    }, {
      "ref" : "`supplier_cnt`",
      "expr" : "`supplier_cnt`"
    } ],
    "child" : 2,
    "outputProj" : true,
    "initialAllocation" : 1000000,
    "maxAllocatio[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
1 row selected (0.466 seconds)
0: jdbc:drill:zk=zookeeper:2181> Closing: org.apache.drill.jdbc.impl.DrillConnectionImpl
13/04/2019 12:56:26.087
--------------------------------------Finished QUERY 16.--------------------------------

--------------------------------------STARTED QUERY 17. ---------------------------------
13/04/2019 12:56:26.096
Apr 13, 2019 12:56:26 PM org.jline.utils.Log logr
WARNING: Unable to create a system terminal, creating a dumb terminal (enable debug logging for more information)
Apache Drill 1.15.0
"There are two types of analysts in the world: those who use Drill and those who don't."
0: jdbc:drill:zk=zookeeper:2181> explain plan for select sum(l_extendedprice) / 7.0 as avg_yearly from hive.denormalized_parquet a where p_brand = 'Brand#23' and p_container = 'MED BOX'  and l_quantity < ( select 0.2 * avg(l_quantity) from hive.denormalized_parquet b where a.l_partkey = b.p_partkey )[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m[1m                                      text                                      [m[1;32m | [m[1m                                      json                                      [m[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m00-00    Screen
00-01      Project(avg_yearly=[/($0, 7.0)])
00-02        StreamAgg(group=[{}], agg#0=[SUM($0)])
00-03          UnionExchange
01-01            StreamAgg(group=[{}], agg#0=[SUM($0)])
01-02              Project(l_extendedprice=[$2])
01-03                SelectionVectorRemover
01-04                  Filter(condition=[<($1, CAST(*(0.2, $4)):DOUBLE)])
01-05                    Project(l_partkey=[$2], l_quantity=[$3], l_extendedprice=[$4], p_partkey=[$0], $f1=[$1])
01-06                      HashJoin(condition=[=($2, $0)], joinType=[inner], semi-join: =[false])
01-07                        Project(l_partkey=[$0], l_quantity=[$1], l_extendedprice=[$2])
01-09                          HashToRandomExchange(dist0=[[$0]])
03-01                            UnorderedMuxExchange
05-01                              Project(l_partkey=[$0], l_quantity=[$1], l_extendedprice=[$2], E_X_P_R_H_A_S_H_F_I_E_L_D=[hash32AsDouble($0, 1301011)])
05-02                                SelectionVectorRemover
05-03                                  Filter(condition=[IS NOT NULL($0)])
05-04                                    Project(l_partkey=[$0], l_quantity=[$1], l_extendedprice=[$2])
05-05                                      SelectionVectorRemover
05-06                                        Filter(condition=[AND(=($3, 'Brand#23'), =($4, 'MED BOX'))])
05-07                                          Project(l_partkey=[$0], l_quantity=[$1], l_extendedprice=[$2], p_brand=[$3], p_container=[$4])
05-08                                            Scan(table=[[hive, denormalized_parquet]], groupscan=[HiveDrillNativeParquetScan [entries=[ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000000_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000001_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000002_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000003_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000004_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000005_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000006_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000007_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000008_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000009_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000010_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000011_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000012_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000013_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000014_0]], numFiles=15, numRowGroups=16, columns=[`l_partkey`, `l_quantity`, `l_extendedprice`, `p_brand`, `p_container`]]])
01-08                        Project(p_partkey=[$0], $f1=[divide(CastHigh(CASE(=($2, 0), null, $1)), $2)])
01-10                          HashAgg(group=[{0}], agg#0=[$SUM0($1)], agg#1=[$SUM0($2)])
01-11                            Project(p_partkey=[$0], $f1=[$1], $f2=[$2])
01-12                              HashToRandomExchange(dist0=[[$0]])
02-01                                UnorderedMuxExchange
04-01                                  Project(p_partkey=[$0], $f1=[$1], $f2=[$2], E_X_P_R_H_A_S_H_F_I_E_L_D=[hash32AsDouble($0, 1301011)])
04-02                                    HashAgg(group=[{0}], agg#0=[$SUM0($1)], agg#1=[COUNT($1)])
04-03                                      Project(p_partkey=[$1], l_quantity=[$0])
04-04                                        SelectionVectorRemover
04-05                                          Filter(condition=[IS NOT NULL($1)])
04-06                                            Project(l_quantity=[$0], p_partkey=[$1])
04-07                                              Scan(table=[[hive, denormalized_parquet]], groupscan=[HiveDrillNativeParquetScan [entries=[ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000000_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000001_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000002_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000003_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000004_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000005_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000006_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000007_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000008_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000009_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000010_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000011_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000012_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000013_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000014_0]], numFiles=15, numRowGroups=16, columns=[`l_quantity`, `p_partkey`]]])
[1;32m | [m{
  "head" : {
    "version" : 1,
    "generator" : {
      "type" : "ExplainHandler",
      "info" : ""
    },
    "type" : "APACHE_DRILL_PHYSICAL",
    "options" : [ ],
    "queue" : 0,
    "hasResourcePlan" : false,
    "resultMode" : "EXEC"
  },
  "graph" : [ {
    "pop" : "hive-drill-native-parquet-scan",
    "@id" : 262151,
    "userName" : "root",
    "hiveStoragePluginConfig" : {
      "type" : "hive",
      "configProps" : {
        "hive.metastore.uris" : "thrift://hive-metastore:9083",
        "hive.metastore.sasl.enabled" : "false",
        "fs.default.name" : "hdfs://namenode"
      },
      "enabled" : true
    },
    "columns" : [ "`l_quantity`", "`p_partkey`" ],
    "entries" : [ {
      "path" : "/user/hive/warehouse/denormalized_parquet/000000_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000001_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000002_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000003_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000004_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000005_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000006_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000007_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000008_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000009_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000010_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000011_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000012_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000013_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000014_0"
    } ],
    "hivePartitionHolder" : {
      "keyToIndexMapper" : { },
      "partitionValues" : [ ]
    },
    "confProperties" : { },
    "cost" : 6051219.0
  }, {
    "pop" : "project",
    "@id" : 262150,
    "exprs" : [ {
      "ref" : "`l_quantity`",
      "expr" : "`l_quantity`"
    }, {
      "ref" : "`p_partkey`",
      "expr" : "`p_partkey`"
    } ],
    "child" : 262151,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 6051219.0
  }, {
    "pop" : "filter",
    "@id" : 262149,
    "child" : 262150,
    "expr" : "isnotnull(`p_partkey`) ",
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 5446097.100000001
  }, {
    "pop" : "selection-vector-remover",
    "@id" : 262148,
    "child" : 262149,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 5446097.100000001
  }, {
    "pop" : "project",
    "@id" : 262147,
    "exprs" : [ {
      "ref" : "`p_partkey`",
      "expr" : "`p_partkey`"
    }, {
      "ref" : "`l_quantity`",
      "expr" : "`l_quantity`"
    } ],
    "child" : 262148,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 5446097.100000001
  }, {
    "pop" : "hash-aggregate",
    "@id" : 262146,
    "child" : 262147,
    "cardinality" : 1.0,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "aggPhase" : "PHASE_1of2",
    "groupByExprs" : [ {
      "ref" : "`p_partkey`",
      "expr" : "`p_partkey`"
    } ],
    "aggrExprs" : [ {
      "ref" : "`$f1`",
      "expr" : "$sum0(`l_quantity`) "
    }, {
      "ref" : "`$f2`",
      "expr" : "count(`l_quantity`) "
    } ],
    "cost" : 2723048.5500000003
  }, {
    "pop" : "project",
    "@id" : 262145,
    "exprs" : [ {
      "ref" : "`p_partkey`",
      "expr" : "`p_partkey`"
    }, {
      "ref" : "`$f1`",
      "expr" : "`$f1`"
    }, {
      "ref" : "`$f2`",
      "expr" : "`$f2`"
    }, {
      "ref" : "`E_X_P_R_H_A_S_H_F_I_E_L_D`",
      "expr" : "hash32asdouble(`p_partkey`, 1301011) "
    } ],
    "child" : 262146,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 544609.7100000001
  }, {
    "pop" : "unordered-mux-exchange",
    "@id" : 131073,
    "child" : 262145,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 544609.7100000001
  }, {
    "pop" : "hash-to-random-exchange",
    "@id" : 65548,
    "child" : 131073,
    "expr" : "`E_X_P_R_H_A_S_H_F_I_E_L_D`",
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 544609.7100000001
  }, {
    "pop" : "project",
    "@id" : 65547,
    "exprs" : [ {
      "ref" : "`p_partkey`",
      "expr" : "`p_partkey`"
    }, {
      "ref" : "`$f1`",
      "expr" : "`$f1`"
    }, {
      "ref" : "`$f2`",
      "expr" : [1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
1 row selected (0.629 seconds)
0: jdbc:drill:zk=zookeeper:2181> Closing: org.apache.drill.jdbc.impl.DrillConnectionImpl
13/04/2019 12:56:29.798
--------------------------------------Finished QUERY 17.--------------------------------

--------------------------------------STARTED QUERY 18. ---------------------------------
13/04/2019 12:56:29.808
Apr 13, 2019 12:56:30 PM org.jline.utils.Log logr
WARNING: Unable to create a system terminal, creating a dumb terminal (enable debug logging for more information)
Apache Drill 1.15.0
"JSON ain't no thang."
0: jdbc:drill:zk=zookeeper:2181> explain plan for select c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity)  from hive.denormalized_parquet group by c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice  having sum(l_quantity)[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m[1m                                      text                                      [m[1;32m | [m[1m                                      json                                      [m[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m00-00    Screen
00-01      Project(c_name=[$0], c_custkey=[$1], o_orderkey=[$2], o_orderdate=[$3], o_totalprice=[$4], EXPR$5=[$5])
00-02        SelectionVectorRemover
00-03          Sort(sort0=[$4], sort1=[$3], dir0=[DESC], dir1=[ASC])
00-04            Project(c_name=[$0], c_custkey=[$1], o_orderkey=[$2], o_orderdate=[$3], o_totalprice=[$4], EXPR$5=[$5])
00-05              HashToRandomExchange(dist0=[[$4]], dist1=[[$3]])
01-01                UnorderedMuxExchange
02-01                  Project(c_name=[$0], c_custkey=[$1], o_orderkey=[$2], o_orderdate=[$3], o_totalprice=[$4], EXPR$5=[$5], E_X_P_R_H_A_S_H_F_I_E_L_D=[hash32AsDouble($3, hash32AsDouble($4, 1301011))])
02-02                    SelectionVectorRemover
02-03                      Filter(condition=[>($5, 300)])
02-04                        HashAgg(group=[{0, 1, 2, 3, 4}], EXPR$5=[SUM($5)])
02-05                          Project(c_name=[$0], c_custkey=[$1], o_orderkey=[$2], o_orderdate=[$3], o_totalprice=[$4], EXPR$5=[$5])
02-06                            HashToRandomExchange(dist0=[[$0]], dist1=[[$1]], dist2=[[$2]], dist3=[[$3]], dist4=[[$4]])
03-01                              UnorderedMuxExchange
04-01                                Project(c_name=[$0], c_custkey=[$1], o_orderkey=[$2], o_orderdate=[$3], o_totalprice=[$4], EXPR$5=[$5], E_X_P_R_H_A_S_H_F_I_E_L_D=[hash32AsDouble($4, hash32AsDouble($3, hash32AsDouble($2, hash32AsDouble($1, hash32AsDouble($0, 1301011)))))])
04-02                                  HashAgg(group=[{0, 1, 2, 3, 4}], EXPR$5=[SUM($5)])
04-03                                    Project(c_name=[$0], c_custkey=[$1], o_orderkey=[$2], o_orderdate=[$3], o_totalprice=[$4], l_quantity=[$5])
04-04                                      Scan(table=[[hive, denormalized_parquet]], groupscan=[HiveDrillNativeParquetScan [entries=[ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000000_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000001_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000002_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000003_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000004_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000005_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000006_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000007_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000008_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000009_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000010_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000011_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000012_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000013_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000014_0]], numFiles=15, numRowGroups=16, columns=[`c_name`, `c_custkey`, `o_orderkey`, `o_orderdate`, `o_totalprice`, `l_quantity`]]])
[1;32m | [m{
  "head" : {
    "version" : 1,
    "generator" : {
      "type" : "ExplainHandler",
      "info" : ""
    },
    "type" : "APACHE_DRILL_PHYSICAL",
    "options" : [ ],
    "queue" : 0,
    "hasResourcePlan" : false,
    "resultMode" : "EXEC"
  },
  "graph" : [ {
    "pop" : "hive-drill-native-parquet-scan",
    "@id" : 262148,
    "userName" : "root",
    "hiveStoragePluginConfig" : {
      "type" : "hive",
      "configProps" : {
        "hive.metastore.uris" : "thrift://hive-metastore:9083",
        "hive.metastore.sasl.enabled" : "false",
        "fs.default.name" : "hdfs://namenode"
      },
      "enabled" : true
    },
    "columns" : [ "`c_name`", "`c_custkey`", "`o_orderkey`", "`o_orderdate`", "`o_totalprice`", "`l_quantity`" ],
    "entries" : [ {
      "path" : "/user/hive/warehouse/denormalized_parquet/000000_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000001_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000002_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000003_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000004_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000005_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000006_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000007_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000008_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000009_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000010_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000011_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000012_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000013_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000014_0"
    } ],
    "hivePartitionHolder" : {
      "keyToIndexMapper" : { },
      "partitionValues" : [ ]
    },
    "confProperties" : { },
    "cost" : 6051219.0
  }, {
    "pop" : "project",
    "@id" : 262147,
    "exprs" : [ {
      "ref" : "`c_name`",
      "expr" : "`c_name`"
    }, {
      "ref" : "`c_custkey`",
      "expr" : "`c_custkey`"
    }, {
      "ref" : "`o_orderkey`",
      "expr" : "`o_orderkey`"
    }, {
      "ref" : "`o_orderdate`",
      "expr" : "`o_orderdate`"
    }, {
      "ref" : "`o_totalprice`",
      "expr" : "`o_totalprice`"
    }, {
      "ref" : "`l_quantity`",
      "expr" : "`l_quantity`"
    } ],
    "child" : 262148,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 6051219.0
  }, {
    "pop" : "hash-aggregate",
    "@id" : 262146,
    "child" : 262147,
    "cardinality" : 1.0,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "aggPhase" : "PHASE_1of2",
    "groupByExprs" : [ {
      "ref" : "`c_name`",
      "expr" : "`c_name`"
    }, {
      "ref" : "`c_custkey`",
      "expr" : "`c_custkey`"
    }, {
      "ref" : "`o_orderkey`",
      "expr" : "`o_orderkey`"
    }, {
      "ref" : "`o_orderdate`",
      "expr" : "`o_orderdate`"
    }, {
      "ref" : "`o_totalprice`",
      "expr" : "`o_totalprice`"
    } ],
    "aggrExprs" : [ {
      "ref" : "`EXPR$5`",
      "expr" : "sum(`l_quantity`) "
    } ],
    "cost" : 5862118.40625
  }, {
    "pop" : "project",
    "@id" : 262145,
    "exprs" : [ {
      "ref" : "`c_name`",
      "expr" : "`c_name`"
    }, {
      "ref" : "`c_custkey`",
      "expr" : "`c_custkey`"
    }, {
      "ref" : "`o_orderkey`",
      "expr" : "`o_orderkey`"
    }, {
      "ref" : "`o_orderdate`",
      "expr" : "`o_orderdate`"
    }, {
      "ref" : "`o_totalprice`",
      "expr" : "`o_totalprice`"
    }, {
      "ref" : "`EXPR$5`",
      "expr" : "`EXPR$5`"
    }, {
      "ref" : "`E_X_P_R_H_A_S_H_F_I_E_L_D`",
      "expr" : "hash32asdouble(`o_totalprice`, hash32asdouble(`o_orderdate`, hash32asdouble(`o_orderkey`, hash32asdouble(`c_custkey`, hash32asdouble(`c_name`, 1301011) ) ) ) ) "
    } ],
    "child" : 262146,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 605121.9
  }, {
    "pop" : "unordered-mux-exchange",
    "@id" : 196609,
    "child" : 262145,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 605121.9
  }, {
    "pop" : "hash-to-random-exchange",
    "@id" : 131078,
    "child" : 196609,
    "expr" : "`E_X_P_R_H_A_S_H_F_I_E_L_D`",
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 605121.9
  }, {
    "pop" : "project",
    "@id" : 131077,
    "exprs" : [ {
      "ref" : "`c_name`",
      "expr" : "`c_name`"
    }, {
      "ref" : "`c_custkey`",
      "expr" : "`c_custkey`"
    }, {
      "ref" : "`o_orderkey`",
      "expr" : "`o_orderkey`"
    }, {
      "ref" : "`o_orderdate`",
      "expr" : "`o_orderdate`"
    }, {
      "ref" : "`o_totalprice`",
      "expr" : "`o_totalprice`"
    }, {
      "ref" : "`EXPR$5`",
      "expr" : "`EXPR$5`"
    } ],
    "child" : 131078,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 605121.9
  }, {
    "pop" : "hash-aggregate",
    "@id" : 131076,
    "child" : 131077,
    "cardinality" : 1.0,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "aggPhase" : "PHASE_2of2",
    "groupByExprs" : [ {
      "ref" : "`c_name`",
      "expr" : "`c_name`"
    }, {
      "ref" : "`c_custkey`",
      "expr" : "`c_custkey`"
    }, {
      "ref" : "`o_orderkey`",
      "expr" : "`o_orderkey`"
    }, {
      "ref" : "`o_orderdate`",
      "expr" : "`o_orderdate`"
    }, {
      "ref" : "`o_totalprice`",
      "expr" : "`o_totalprice`"
    } ],
    "aggrExprs" : [ {
      "ref" : "`EXPR$5`",
      "expr" : "sum(`EXPR$5`) "
    } ],
    "cost" : 586211.8406250001
  }, {
    "pop" : "filter",
    "@id" : 131075,
    "child" : 131076,
    "expr" : "greater_than(`EXPR$5`, 300) ",
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 30256.095
  }, {
    "pop" : "selection-vector-remover",
    "@id" : 131074,
    "child" : 131075,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 30256.095
  }, {
    "pop" : "project",
    "@id" : 131073,
    "exprs" : [ {
      "ref" : "`c_name`",
      "expr" : "`c_name`"
    }, {
      "ref" : "`c_custkey`",
      "expr" : "`c_custkey`"
    }, {
      "ref" : "`o_orderkey`",
      "expr" : "`o_orderkey`"
    }, {
      "ref" : "`o_orderdate`",
      "expr" : "`o_orderdate`"
    }, {
      "ref" : "`o_totalprice`",
      "expr" : "`o_totalprice`"
    }, {
      "ref" : "`EXPR$5`",
      "expr" : "`EXPR$5`"
    }, {
      "ref" : "`E_X_P_R_H_A_S_H_F_I_E_L_D`",
      "expr" : "hash32asdouble(`o_orderdate`, hash32a[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
1 row selected (0.455 seconds)
0: jdbc:drill:zk=zookeeper:2181> Closing: org.apache.drill.jdbc.impl.DrillConnectionImpl
13/04/2019 12:56:33.329
--------------------------------------Finished QUERY 18.--------------------------------

--------------------------------------STARTED QUERY 19. ---------------------------------
13/04/2019 12:56:33.340
Apr 13, 2019 12:56:34 PM org.jline.utils.Log logr
WARNING: Unable to create a system terminal, creating a dumb terminal (enable debug logging for more information)
Apache Drill 1.15.0
"Drill, baby, Drill."
0: jdbc:drill:zk=zookeeper:2181> explain plan for select sum(l_extendedprice * (1 - l_discount) ) as revenue  from hive.denormalized_parquet where ( p_brand = 'Brand#12'and p_container in ( 'SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')  and l_quantity >= 1 and l_quantity <= 1 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG')  and l_shipinstruct = 'DELIVER IN PERSON') or (p_brand = 'Brand#23'  and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 10  and l_quantity <= 10 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG')  and l_shipinstruct = 'DELIVER IN PERSON' ) or (p_brand = 'Brand#34' and p_container in ( 'LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 20 and l_quantity <= 20 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG')  and l_shipinstruct = 'DELIVER IN PERSON')[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m[1m                                      text                                      [m[1;32m | [m[1m                                      json                                      [m[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m00-00    Screen
00-01      Project(revenue=[$0])
00-02        StreamAgg(group=[{}], revenue=[SUM($0)])
00-03          UnionExchange
01-01            StreamAgg(group=[{}], revenue=[SUM($0)])
01-02              Project($f0=[*($1, -(1, $2))])
01-03                SelectionVectorRemover
01-04                  Filter(condition=[OR(AND(=($5, 'Brand#12'), OR(=($7, 'SM CASE'), =($7, 'SM BOX'), =($7, 'SM PACK'), =($7, 'SM PKG')), >=($0, 1), <=($0, 11), >=($6, 1), <=($6, 5), OR(=($4, 'AIR'), =($4, 'AIR REG')), =($3, 'DELIVER IN PERSON')), AND(=($5, 'Brand#23'), OR(=($7, 'MED BAG'), =($7, 'MED BOX'), =($7, 'MED PKG'), =($7, 'MED PACK')), >=($0, 10), <=($0, 20), >=($6, 1), <=($6, 10), OR(=($4, 'AIR'), =($4, 'AIR REG')), =($3, 'DELIVER IN PERSON')), AND(=($5, 'Brand#34'), OR(=($7, 'LG CASE'), =($7, 'LG BOX'), =($7, 'LG PACK'), =($7, 'LG PKG')), >=($0, 20), <=($0, 30), >=($6, 1), <=($6, 15), OR(=($4, 'AIR'), =($4, 'AIR REG')), =($3, 'DELIVER IN PERSON')))])
01-05                    Project(l_quantity=[$0], l_extendedprice=[$1], l_discount=[$2], l_shipinstruct=[$3], l_shipmode=[$4], p_brand=[$5], p_size=[$6], p_container=[$7])
01-06                      Scan(table=[[hive, denormalized_parquet]], groupscan=[HiveDrillNativeParquetScan [entries=[ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000000_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000001_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000002_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000003_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000004_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000005_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000006_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000007_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000008_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000009_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000010_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000011_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000012_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000013_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000014_0]], numFiles=15, numRowGroups=16, columns=[`l_quantity`, `l_extendedprice`, `l_discount`, `l_shipinstruct`, `l_shipmode`, `p_brand`, `p_size`, `p_container`]]])
[1;32m | [m{
  "head" : {
    "version" : 1,
    "generator" : {
      "type" : "ExplainHandler",
      "info" : ""
    },
    "type" : "APACHE_DRILL_PHYSICAL",
    "options" : [ ],
    "queue" : 0,
    "hasResourcePlan" : false,
    "resultMode" : "EXEC"
  },
  "graph" : [ {
    "pop" : "hive-drill-native-parquet-scan",
    "@id" : 65542,
    "userName" : "root",
    "hiveStoragePluginConfig" : {
      "type" : "hive",
      "configProps" : {
        "hive.metastore.uris" : "thrift://hive-metastore:9083",
        "hive.metastore.sasl.enabled" : "false",
        "fs.default.name" : "hdfs://namenode"
      },
      "enabled" : true
    },
    "columns" : [ "`l_quantity`", "`l_extendedprice`", "`l_discount`", "`l_shipinstruct`", "`l_shipmode`", "`p_brand`", "`p_size`", "`p_container`" ],
    "entries" : [ {
      "path" : "/user/hive/warehouse/denormalized_parquet/000000_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000001_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000002_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000003_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000004_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000005_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000006_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000007_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000008_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000009_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000010_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000011_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000012_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000013_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000014_0"
    } ],
    "hivePartitionHolder" : {
      "keyToIndexMapper" : { },
      "partitionValues" : [ ]
    },
    "confProperties" : { },
    "cost" : 6051219.0
  }, {
    "pop" : "project",
    "@id" : 65541,
    "exprs" : [ {
      "ref" : "`l_quantity`",
      "expr" : "`l_quantity`"
    }, {
      "ref" : "`l_extendedprice`",
      "expr" : "`l_extendedprice`"
    }, {
      "ref" : "`l_discount`",
      "expr" : "`l_discount`"
    }, {
      "ref" : "`l_shipinstruct`",
      "expr" : "`l_shipinstruct`"
    }, {
      "ref" : "`l_shipmode`",
      "expr" : "`l_shipmode`"
    }, {
      "ref" : "`p_brand`",
      "expr" : "`p_brand`"
    }, {
      "ref" : "`p_size`",
      "expr" : "`p_size`"
    }, {
      "ref" : "`p_container`",
      "expr" : "`p_container`"
    } ],
    "child" : 65542,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 6051219.0
  }, {
    "pop" : "filter",
    "@id" : 65540,
    "child" : 65541,
    "expr" : "booleanOr(booleanAnd(equal(`p_brand`, 'Brand#12') , booleanOr(equal(`p_container`, 'SM CASE') , equal(`p_container`, 'SM BOX') , equal(`p_container`, 'SM PACK') , equal(`p_container`, 'SM PKG') ) , greater_than_or_equal_to(`l_quantity`, 1) , less_than_or_equal_to(`l_quantity`, 11) , greater_than_or_equal_to(`p_size`, 1) , less_than_or_equal_to(`p_size`, 5) , booleanOr(equal(`l_shipmode`, 'AIR') , equal(`l_shipmode`, 'AIR REG') ) , equal(`l_shipinstruct`, 'DELIVER IN PERSON') ) , booleanAnd(equal(`p_brand`, 'Brand#23') , booleanOr(equal(`p_container`, 'MED BAG') , equal(`p_container`, 'MED BOX') , equal(`p_container`, 'MED PKG') , equal(`p_container`, 'MED PACK') ) , greater_than_or_equal_to(`l_quantity`, 10) , less_than_or_equal_to(`l_quantity`, 20) , greater_than_or_equal_to(`p_size`, 1) , less_than_or_equal_to(`p_size`, 10) , booleanOr(equal(`l_shipmode`, 'AIR') , equal(`l_shipmode`, 'AIR REG') ) , equal(`l_shipinstruct`, 'DELIVER IN PERSON') ) , booleanAnd(equal(`p_brand`, 'Brand#34') , booleanOr(equal(`p_container`, 'LG CASE') , equal(`p_container`, 'LG BOX') , equal(`p_container`, 'LG PACK') , equal(`p_container`, 'LG PKG') ) , greater_than_or_equal_to(`l_quantity`, 20) , less_than_or_equal_to(`l_quantity`, 30) , greater_than_or_equal_to(`p_size`, 1) , less_than_or_equal_to(`p_size`, 15) , booleanOr(equal(`l_shipmode`, 'AIR') , equal(`l_shipmode`, 'AIR REG') ) , equal(`l_shipinstruct`, 'DELIVER IN PERSON') ) ) ",
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 1512804.75
  }, {
    "pop" : "selection-vector-remover",
    "@id" : 65539,
    "child" : 65540,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 1512804.75
  }, {
    "pop" : "project",
    "@id" : 65538,
    "exprs" : [ {
      "ref" : "`$f0`",
      "expr" : "multiply(`l_extendedprice`, subtract(1, `l_discount`) ) "
    } ],
    "child" : 65539,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 1512804.75
  }, {
    "pop" : "streaming-aggregate",
    "@id" : 65537,
    "child" : 65538,
    "keys" : [ ],
    "exprs" : [ {
      "ref" : "`revenue`",
      "expr" : "sum(`$f0`) "
    } ],
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 1.0
  }, {
    "pop" : "union-exchange",
    "@id" : 3,
    "child" : 65537,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 1.0
  }, {
    "pop" : "streaming-aggregate",
    "@id" : 2,
    "child" : 3,
    "keys" : [ ],
    "exprs" : [ {
      "ref" : "`revenue`",
      "expr" : "sum(`revenue`) "
    } ],
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 1.0
  }, {
    "pop" : "project",
    "@id" : 1,
    "exprs" : [ {
      "ref" : "`revenue`",
      "expr" : "`revenue`"
    } ],
    "child" : 2,
    "outputProj" : true,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 1.0
  }, {
    "pop" : "screen",
    "@id" : 0,
    "child" : 1,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 1.0
  } ]
}[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
1 row selected (0.985 seconds)
0: jdbc:drill:zk=zookeeper:2181> Closing: org.apache.drill.jdbc.impl.DrillConnectionImpl
13/04/2019 12:56:37.454
--------------------------------------Finished QUERY 19.--------------------------------

--------------------------------------STARTED QUERY 20. ---------------------------------
--------------------------------------Finished QUERY 20.--------------------------------

--------------------------------------STARTED QUERY 21. ---------------------------------
13/04/2019 12:56:37.472
Apr 13, 2019 12:56:38 PM org.jline.utils.Log logr
WARNING: Unable to create a system terminal, creating a dumb terminal (enable debug logging for more information)
Apache Drill 1.15.0
"Drill, baby, Drill."
0: jdbc:drill:zk=zookeeper:2181> explain plan for select s_name, count(*) as numwait from hive.denormalized_parquet l1 where  o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from hive.denormalized_parquet l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from hive.denormalized_parquet l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate )[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m[1m                                      text                                      [m[1;32m | [m[1m                                      json                                      [m[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m00-00    Screen
00-01      Project(s_name=[$0], numwait=[$1])
00-02        SelectionVectorRemover
00-03          Limit(fetch=[100])
00-04            Limit(fetch=[100])
00-05              SelectionVectorRemover
00-06                TopN(limit=[100])
00-07                  Project(s_name=[$0], numwait=[$1])
00-08                    HashToRandomExchange(dist0=[[$1]], dist1=[[$0]])
01-01                      UnorderedMuxExchange
02-01                        Project(s_name=[$0], numwait=[$1], E_X_P_R_H_A_S_H_F_I_E_L_D=[hash32AsDouble($0, hash32AsDouble($1, 1301011))])
02-02                          HashAgg(group=[{0}], numwait=[COUNT()])
02-03                            Project(s_name=[$0])
02-04                              HashToRandomExchange(dist0=[[$0]])
03-01                                UnorderedMuxExchange
04-01                                  Project(s_name=[$0], E_X_P_R_H_A_S_H_F_I_E_L_D=[hash32AsDouble($0, 1301011)])
04-02                                    Project(s_name=[$2])
04-03                                      SelectionVectorRemover
04-04                                        Filter(condition=[IS NULL($5)])
04-05                                          Project(l_orderkey=[$3], l_suppkey=[$4], s_name=[$5], l_orderkey0=[$0], l_suppkey0=[$1], $f2=[$2])
04-06                                            HashJoin(condition=[AND(=($3, $0), =($4, $1))], joinType=[right], semi-join: =[false])
04-08                                              Project(l_orderkey0=[$0], l_suppkey0=[$1], $f2=[true])
04-11                                                HashAgg(group=[{0, 1}])
04-14                                                  Project(l_orderkey0=[$0], l_suppkey0=[$1])
04-15                                                    HashToRandomExchange(dist0=[[$0]], dist1=[[$1]])
05-01                                                      UnorderedMuxExchange
08-01                                                        Project(l_orderkey0=[$0], l_suppkey0=[$1], E_X_P_R_H_A_S_H_F_I_E_L_D=[hash32AsDouble($1, hash32AsDouble($0, 1301011))])
08-02                                                          HashAgg(group=[{0, 1}])
08-03                                                            Project(l_orderkey0=[$2], l_suppkey0=[$3], i=[true])
08-04                                                              SelectionVectorRemover
08-05                                                                Filter(condition=[<>($1, $3)])
08-06                                                                  HashJoin(condition=[=($0, $2)], joinType=[inner], semi-join: =[false])
08-08                                                                    Project(l_orderkey=[$0], l_suppkey=[$1])
08-10                                                                      SelectionVectorRemover
08-11                                                                        Filter(condition=[>($3, $2)])
08-12                                                                          Project(l_orderkey=[$0], l_suppkey=[$1], l_commitdate=[$2], l_receiptdate=[$3])
08-13                                                                            Scan(table=[[hive, denormalized_parquet]], groupscan=[HiveDrillNativeParquetScan [entries=[ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000000_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000001_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000002_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000003_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000004_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000005_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000006_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000007_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000008_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000009_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000010_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000011_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000012_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000013_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000014_0]], numFiles=15, numRowGroups=16, columns=[`l_orderkey`, `l_suppkey`, `l_commitdate`, `l_receiptdate`]]])
08-07                                                                    Project(l_orderkey0=[$0], l_suppkey0=[$1])
08-09                                                                      BroadcastExchange
11-01                                                                        HashAgg(group=[{0, 1}])
11-02                                                                          Project(l_orderkey=[$0], l_suppkey=[$1])
11-03                                                                            HashToRandomExchange(dist0=[[$0]], dist1=[[$1]])
13-01                                                                              UnorderedMuxExchange
15-01                                                                                Project(l_orderkey=[$0], l_suppkey=[$1], E_X_P_R_H_A_S_H_F_I_E_L_D=[hash32AsDouble($1, hash32AsDouble($0, 1301011))])
15-02                                                                                  Project(l_orderkey=[$1], l_suppkey=[$2])
15-03                                                                                    SelectionVectorRemover
15-04                                                                                      Filter(condition=[AND(=($0, 'F'), >($4, $3), =($5, $6), =($7, 'SAUDI ARABIA'))])
15-05                                                                                        Project(o_orderstatus=[$0], l_orderkey=[$1], l_suppkey=[$2], l_commitdate=[$3], l_receiptdate=[$4], s_nationkey=[$5], n2_nationkey=[$6], n2_name=[$7])
15-06                                                                                          Scan(table=[[hive, denormalized_parquet]], groupscan=[HiveDrillNativeParquetScan [entries=[ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000000_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000001_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000002_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000003_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000004_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000005_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000006_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000007_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000008_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000009_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000010_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000011_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000012_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000013_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000014_0]], numFiles=15, numRowGroups=16, columns=[`o_orderstatus`, `l_orderkey`, `l_suppkey`, `l_commitdate`, `l_receiptdate`, `s_nationkey`, `n2_nationkey`, `n2_name`]]])
04-07                                              HashJoin(condition=[AND(=($0, $3), =($1, $4))], joinType=[inner], semi-join: =[true])
04-10                                                Project(l_orderkey=[$0], l_suppkey=[$1], s_name=[$2])
04-13                                                  HashToRandomExchange(dist0=[[$0]], dist1=[[$1]])
06-01                                                    UnorderedMuxExchange
09-01                                                      Project(l_orderkey=[$0], l_suppkey=[$1], s_name=[$2], E_X_P_R_H_A_S_H_F_I_E_L_D=[hash32AsDouble($1, hash32AsDouble($0, 1301011))])
09-02                                                        SelectionVectorRemover
09-03                                                          Filter(condition=[AND(IS NOT NULL($0), IS NOT NULL($1))])
09-04                                                            Project(l_orderkey=[$1], l_suppkey=[$2], s_name=[$5])
09-05                                                              SelectionVectorRemover
09-06                                                                Filter(condition=[AND(=($0, 'F'), >($4, $3), =($6, $7), =($8, 'SAUDI ARABIA'))])
09-07                                                                  Project(o_orderstatus=[$0], l_orderkey=[$1], l_suppkey=[$2], l_commitdate=[$3], l_receiptdate=[$4], s_name=[$5], s_nationkey=[$6], n2_nationkey=[$7], n2_name=[$8])
09-08                                                                    Scan(table=[[hive, denormalized_parquet]], groupscan=[HiveDrillNativeParquetScan [entries=[ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000000_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000001_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000002_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000003_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000004_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000005_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000006_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000007_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000008_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000009_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000010_0], ReadEntryWithPath [path=[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
1 row selected (1.318 seconds)
0: jdbc:drill:zk=zookeeper:2181> Closing: org.apache.drill.jdbc.impl.DrillConnectionImpl
13/04/2019 12:56:41.885
--------------------------------------Finished QUERY 21.--------------------------------

--------------------------------------STARTED QUERY 22. ---------------------------------
13/04/2019 12:56:41.895
Apr 13, 2019 12:56:42 PM org.jline.utils.Log logr
WARNING: Unable to create a system terminal, creating a dumb terminal (enable debug logging for more information)
Apache Drill 1.15.0
"JSON ain't no thang."
0: jdbc:drill:zk=zookeeper:2181> explain plan for select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(a.c_phone, 1,2) as cntrycode, a.c_acctbal from hive.denormalized_parquet a where  substring(a.c_phone, 1,2) in ('13','31','23','29','30','18','17') and a.c_acctbal > ( select avg(b.c_acctbal) from hive.denormalized_parquet b where b.c_acctbal > 0.00   and substring(b.c_phone, 1,2) in   ('13','31','23','29','30','18','17')) and not exists (select   *   from   hive.denormalized_parquet c   where   a.o_custkey = c.c_custkey   ) )[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m[1m                                      text                                      [m[1;32m | [m[1m                                      json                                      [m[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
[1;32m| [m00-00    Screen
00-01      Project(cntrycode=[$0], numcust=[$1], totacctbal=[$2])
00-02        SelectionVectorRemover
00-03          Sort(sort0=[$0], dir0=[ASC])
00-04            HashAgg(group=[{0}], numcust=[$SUM0($1)], totacctbal=[SUM($2)])
00-05              Project(cntrycode=[$0], numcust=[$1], totacctbal=[$2])
00-06                HashToRandomExchange(dist0=[[$0]])
01-01                  UnorderedMuxExchange
02-01                    Project(cntrycode=[$0], numcust=[$1], totacctbal=[$2], E_X_P_R_H_A_S_H_F_I_E_L_D=[hash32AsDouble($0, 1301011)])
02-02                      HashAgg(group=[{0}], numcust=[COUNT()], totacctbal=[SUM($1)])
02-03                        Project(cntrycode=[SUBSTRING($0, 1, 2)], c_acctbal=[$1])
02-04                          SelectionVectorRemover
02-05                            Filter(condition=[IS NULL($4)])
02-06                              HashJoin(condition=[=($2, $3)], joinType=[left], semi-join: =[false])
02-08                                Project(c_phone=[$0], c_acctbal=[$1], o_custkey=[$2])
02-09                                  NestedLoopJoin(condition=[>($1, $3)], joinType=[inner])
02-11                                    SelectionVectorRemover
02-12                                      Filter(condition=[OR(=(SUBSTRING($0, 1, 2), '13'), =(SUBSTRING($0, 1, 2), '31'), =(SUBSTRING($0, 1, 2), '23'), =(SUBSTRING($0, 1, 2), '29'), =(SUBSTRING($0, 1, 2), '30'), =(SUBSTRING($0, 1, 2), '18'), =(SUBSTRING($0, 1, 2), '17'))])
02-13                                        Project(c_phone=[$0], c_acctbal=[$1], o_custkey=[$2])
02-14                                          Scan(table=[[hive, denormalized_parquet]], groupscan=[HiveDrillNativeParquetScan [entries=[ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000000_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000001_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000002_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000003_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000004_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000005_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000006_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000007_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000008_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000009_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000010_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000011_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000012_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000013_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000014_0]], numFiles=15, numRowGroups=16, columns=[`c_phone`, `c_acctbal`, `o_custkey`]]])
02-10                                    BroadcastExchange
03-01                                      Project(EXPR$0=[divide(CastHigh(CASE(=($1, 0), null, $0)), $1)])
03-02                                        StreamAgg(group=[{}], agg#0=[$SUM0($0)], agg#1=[$SUM0($1)])
03-03                                          UnionExchange
05-01                                            StreamAgg(group=[{}], agg#0=[$SUM0($0)], agg#1=[COUNT($0)])
05-02                                              Project(c_acctbal=[$1])
05-03                                                SelectionVectorRemover
05-04                                                  Filter(condition=[AND(>($1, 0.00), OR(=(SUBSTRING($0, 1, 2), '13'), =(SUBSTRING($0, 1, 2), '31'), =(SUBSTRING($0, 1, 2), '23'), =(SUBSTRING($0, 1, 2), '29'), =(SUBSTRING($0, 1, 2), '30'), =(SUBSTRING($0, 1, 2), '18'), =(SUBSTRING($0, 1, 2), '17')))])
05-05                                                    Project(c_phone=[$0], c_acctbal=[$1])
05-06                                                      Scan(table=[[hive, denormalized_parquet]], groupscan=[HiveDrillNativeParquetScan [entries=[ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000000_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000001_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000002_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000003_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000004_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000005_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000006_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000007_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000008_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000009_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000010_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000011_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000012_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000013_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000014_0]], numFiles=15, numRowGroups=16, columns=[`c_phone`, `c_acctbal`]]])
02-07                                BroadcastExchange
04-01                                  Project(c_custkey=[$0], $f1=[true])
04-02                                    HashAgg(group=[{0}])
04-03                                      Project(c_custkey=[$0])
04-04                                        HashToRandomExchange(dist0=[[$0]])
06-01                                          UnorderedMuxExchange
07-01                                            Project(c_custkey=[$0], E_X_P_R_H_A_S_H_F_I_E_L_D=[hash32AsDouble($0, 1301011)])
07-02                                              HashAgg(group=[{0}])
07-03                                                Project(c_custkey=[$0], i=[true])
07-04                                                  SelectionVectorRemover
07-05                                                    Filter(condition=[IS NOT NULL($0)])
07-06                                                      Project(c_custkey=[$0])
07-07                                                        Scan(table=[[hive, denormalized_parquet]], groupscan=[HiveDrillNativeParquetScan [entries=[ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000000_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000001_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000002_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000003_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000004_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000005_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000006_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000007_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000008_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000009_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000010_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000011_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000012_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000013_0], ReadEntryWithPath [path=/user/hive/warehouse/denormalized_parquet/000014_0]], numFiles=15, numRowGroups=16, columns=[`c_custkey`]]])
[1;32m | [m{
  "head" : {
    "version" : 1,
    "generator" : {
      "type" : "ExplainHandler",
      "info" : ""
    },
    "type" : "APACHE_DRILL_PHYSICAL",
    "options" : [ ],
    "queue" : 0,
    "hasResourcePlan" : false,
    "resultMode" : "EXEC"
  },
  "graph" : [ {
    "pop" : "hive-drill-native-parquet-scan",
    "@id" : 327686,
    "userName" : "root",
    "hiveStoragePluginConfig" : {
      "type" : "hive",
      "configProps" : {
        "hive.metastore.uris" : "thrift://hive-metastore:9083",
        "hive.metastore.sasl.enabled" : "false",
        "fs.default.name" : "hdfs://namenode"
      },
      "enabled" : true
    },
    "columns" : [ "`c_phone`", "`c_acctbal`" ],
    "entries" : [ {
      "path" : "/user/hive/warehouse/denormalized_parquet/000000_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000001_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000002_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000003_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000004_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000005_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000006_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000007_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000008_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000009_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000010_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000011_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000012_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000013_0"
    }, {
      "path" : "/user/hive/warehouse/denormalized_parquet/000014_0"
    } ],
    "hivePartitionHolder" : {
      "keyToIndexMapper" : { },
      "partitionValues" : [ ]
    },
    "confProperties" : { },
    "cost" : 6051219.0
  }, {
    "pop" : "project",
    "@id" : 327685,
    "exprs" : [ {
      "ref" : "`c_phone`",
      "expr" : "`c_phone`"
    }, {
      "ref" : "`c_acctbal`",
      "expr" : "`c_acctbal`"
    } ],
    "child" : 327686,
    "outputProj" : false,
    "initialAllocation" : 1000000,
    "maxAllocation" : 10000000000,
    "cost" : 6051219.0
  }, {
    "pop[1;32m |[m
[1;32m+-[m[1;32m---------------------------------------------------------------------------------+---------------------------------------------------------------------------------[m[1;32m-+[m
1 row selected (0.838 seconds)
0: jdbc:drill:zk=zookeeper:2181> Closing: org.apache.drill.jdbc.impl.DrillConnectionImpl
13/04/2019 12:56:45.839
--------------------------------------Finished QUERY 22.--------------------------------

