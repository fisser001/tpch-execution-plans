-------------------------------------- CREATED PATH IF NOT EXIST ---------------------------------
-------------------------------------- impala_normal_query_sf1_result_explain.txt ---------------------------------
-------------------------------------- IMPALA QUERY NORMALIZED ---------------------------------
15/04/2019 16:00:14.999


--------------------------------------  Invalidate Schema  ---------------------------------
Starting Impala Shell without Kerberos authentication
Connected to b05cdd87a09f:21000
Server version: impalad version 2.12.0-cdh5.16.1 RELEASE (build 4a3775ef6781301af81b23bca45a9faeca5e761d)
Query: INVALIDATE METADATA
Query submitted at: 2019-04-15 16:00:15 (Coordinator: http://b05cdd87a09f:25000)
Query progress can be monitored at: http://b05cdd87a09f:25000/query_plan?query_id=484189ac9837ba64:d83543bb00000000
Fetched 0 row(s) in 3.48s

--------------------------------------STARTED QUERY 1. ---------------------------------
15/04/2019 16:00:18.664
Starting Impala Shell without Kerberos authentication
Connected to b05cdd87a09f:21000
Server version: impalad version 2.12.0-cdh5.16.1 RELEASE (build 4a3775ef6781301af81b23bca45a9faeca5e761d)
Query: explain select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice*(1-l_discount)) as sum_disc_price, sum(l_extendedprice*(1-l_discount)*(1+l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from l_lineitem_parquet_impala where to_date(l_shipdate) <= to_date(date_sub(cast('1998-12-01' as timestamp), interval 90 day)) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Explain String                                                                                                                                                                                                                                                     |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Max Per-Host Resource Reservation: Memory=80.00MB                                                                                                                                                                                                                  |
| Per-Host Resource Estimates: Memory=884.00MB                                                                                                                                                                                                                       |
| WARNING: The following tables are missing relevant table and/or column statistics.                                                                                                                                                                                 |
| default.l_lineitem_parquet_impala                                                                                                                                                                                                                                  |
|                                                                                                                                                                                                                                                                    |
| PLAN-ROOT SINK                                                                                                                                                                                                                                                     |
| |                                                                                                                                                                                                                                                                  |
| 05:MERGING-EXCHANGE [UNPARTITIONED]                                                                                                                                                                                                                                |
| |  order by: l_returnflag ASC, l_linestatus ASC                                                                                                                                                                                                                    |
| |                                                                                                                                                                                                                                                                  |
| 02:SORT                                                                                                                                                                                                                                                            |
| |  order by: l_returnflag ASC, l_linestatus ASC                                                                                                                                                                                                                    |
| |                                                                                                                                                                                                                                                                  |
| 04:AGGREGATE [FINALIZE]                                                                                                                                                                                                                                            |
| |  output: sum:merge(l_quantity), sum:merge(l_extendedprice), sum:merge(l_extendedprice * (1 - l_discount)), sum:merge(l_extendedprice * (1 - l_discount) * (1 + l_tax)), avg:merge(l_quantity), avg:merge(l_extendedprice), avg:merge(l_discount), count:merge(*) |
| |  group by: l_returnflag, l_linestatus                                                                                                                                                                                                                            |
| |                                                                                                                                                                                                                                                                  |
| 03:EXCHANGE [HASH(l_returnflag,l_linestatus)]                                                                                                                                                                                                                      |
| |                                                                                                                                                                                                                                                                  |
| 01:AGGREGATE [STREAMING]                                                                                                                                                                                                                                           |
| |  output: sum(l_quantity), sum(l_extendedprice), sum(l_extendedprice * (1 - l_discount)), sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)), avg(l_quantity), avg(l_extendedprice), avg(l_discount), count(*)                                                 |
| |  group by: l_returnflag, l_linestatus                                                                                                                                                                                                                            |
| |                                                                                                                                                                                                                                                                  |
| 00:SCAN HDFS [default.l_lineitem_parquet_impala]                                                                                                                                                                                                                   |
|    partitions=1/1 files=3 size=381.40MB                                                                                                                                                                                                                            |
|    predicates: to_date(l_shipdate) <= '1998-09-02'                                                                                                                                                                                                                 |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
Fetched 26 row(s) in 3.82s
15/04/2019 16:00:22.678
--------------------------------------Finished QUERY 1.---------------------------------

--------------------------------------STARTED  QUERY 2. --------------------------------
15/04/2019 16:00:22.686
Starting Impala Shell without Kerberos authentication
Connected to b05cdd87a09f:21000
Server version: impalad version 2.12.0-cdh5.16.1 RELEASE (build 4a3775ef6781301af81b23bca45a9faeca5e761d)
Query: explain select s_acctbal,s_name, n_name,p_partkey,p_mfgr,s_address,s_phone,s_comment from p_part_parquet_impala inner join ps_partsupp_parquet_impala on p_partkey = ps_partkey and p_size = 15 and p_type like '%BRASS' inner join s_supplier_parquet_impala on s_suppkey = ps_suppkey inner join n_nation_parquet_impala on s_nationkey = n_nationkey inner join r_region_parquet_impala on n_regionkey = r_regionkey and r_name = 'EUROPE' where ps_supplycost = (select min(ps_supplycost) from ps_partsupp_parquet_impala, s_supplier_parquet_impala, n_nation_parquet_impala, r_region_parquet_impala where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE') order by s_acctbal desc,n_name,s_name,p_partkey limit 100
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Explain String                                                                                                                                                         |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Max Per-Host Resource Reservation: Memory=129.56MB                                                                                                                     |
| Per-Host Resource Estimates: Memory=1.20GB                                                                                                                             |
| WARNING: The following tables are missing relevant table and/or column statistics.                                                                                     |
| default.n_nation_parquet_impala, default.p_part_parquet_impala, default.ps_partsupp_parquet_impala, default.r_region_parquet_impala, default.s_supplier_parquet_impala |
|                                                                                                                                                                        |
| PLAN-ROOT SINK                                                                                                                                                         |
| |                                                                                                                                                                      |
| 29:MERGING-EXCHANGE [UNPARTITIONED]                                                                                                                                    |
| |  order by: s_acctbal DESC, n_name ASC, s_name ASC, p_partkey ASC                                                                                                     |
| |  limit: 100                                                                                                                                                          |
| |                                                                                                                                                                      |
| 18:TOP-N [LIMIT=100]                                                                                                                                                   |
| |  order by: s_acctbal DESC, n_name ASC, s_name ASC, p_partkey ASC                                                                                                     |
| |                                                                                                                                                                      |
| 17:HASH JOIN [LEFT SEMI JOIN, BROADCAST]                                                                                                                               |
| |  hash predicates: ps_supplycost = min(ps_supplycost), p_partkey = ps_partkey                                                                                         |
| |  runtime filters: RF000 <- min(ps_supplycost), RF001 <- ps_partkey                                                                                                   |
| |                                                                                                                                                                      |
| |--28:EXCHANGE [BROADCAST]                                                                                                                                             |
| |  |                                                                                                                                                                   |
| |  27:AGGREGATE [FINALIZE]                                                                                                                                             |
| |  |  output: min:merge(ps_supplycost)                                                                                                                                 |
| |  |  group by: ps_partkey                                                                                                                                             |
| |  |                                                                                                                                                                   |
| |  26:EXCHANGE [HASH(ps_partkey)]                                                                                                                                      |
| |  |                                                                                                                                                                   |
| |  12:AGGREGATE [STREAMING]                                                                                                                                            |
| |  |  output: min(ps_supplycost)                                                                                                                                       |
| |  |  group by: ps_partkey                                                                                                                                             |
| |  |                                                                                                                                                                   |
| |  11:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                |
| |  |  hash predicates: n_regionkey = r_regionkey                                                                                                                       |
| |  |  runtime filters: RF012 <- r_regionkey                                                                                                                            |
| |  |                                                                                                                                                                   |
| |  |--25:EXCHANGE [BROADCAST]                                                                                                                                          |
| |  |  |                                                                                                                                                                |
| |  |  08:SCAN HDFS [default.r_region_parquet_impala]                                                                                                                   |
| |  |     partitions=1/1 files=1 size=1.12KB                                                                                                                            |
| |  |     predicates: r_name = 'EUROPE'                                                                                                                                 |
| |  |                                                                                                                                                                   |
| |  10:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                |
| |  |  hash predicates: s_nationkey = n_nationkey                                                                                                                       |
| |  |  runtime filters: RF014 <- n_nationkey                                                                                                                            |
| |  |                                                                                                                                                                   |
| |  |--24:EXCHANGE [BROADCAST]                                                                                                                                          |
| |  |  |                                                                                                                                                                |
| |  |  07:SCAN HDFS [default.n_nation_parquet_impala]                                                                                                                   |
| |  |     partitions=1/1 files=1 size=3.25KB                                                                                                                            |
| |  |     runtime filters: RF012 -> n_regionkey                                                                                                                         |
| |  |                                                                                                                                                                   |
| |  09:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                |
| |  |  hash predicates: ps_suppkey = s_suppkey                                                                                                                          |
| |  |  runtime filters: RF016 <- s_suppkey                                                                                                                              |
| |  |                                                                                                                                                                   |
| |  |--23:EXCHANGE [BROADCAST]                                                                                                                                          |
| |  |  |                                                                                                                                                                |
| |  |  06:SCAN HDFS [default.s_supplier_parquet_impala]                                                                                                                 |
| |  |     partitions=1/1 files=1 size=1.46MB                                                                                                                            |
| |  |     runtime filters: RF014 -> s_nationkey                                                                                                                         |
| |  |                                                                                                                                                                   |
| |  05:SCAN HDFS [default.ps_partsupp_parquet_impala]                                                                                                                   |
| |     partitions=1/1 files=1 size=107.99MB                                                                                                                             |
| |     runtime filters: RF016 -> ps_suppkey                                                                                                                             |
| |                                                                                                                                                                      |
| 16:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                   |
| |  hash predicates: n_regionkey = r_regionkey                                                                                                                          |
| |  runtime filters: RF004 <- r_regionkey                                                                                                                               |
| |                                                                                                                                                                      |
| |--22:EXCHANGE [BROADCAST]                                                                                                                                             |
| |  |                                                                                                                                                                   |
| |  04:SCAN HDFS [default.r_region_parquet_impala]                                                                                                                      |
| |     partitions=1/1 files=1 size=1.12KB                                                                                                                               |
| |     predicates: r_name = 'EUROPE'                                                                                                                                    |
| |                                                                                                                                                                      |
| 15:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                   |
| |  hash predicates: s_nationkey = n_nationkey                                                                                                                          |
| |  runtime filters: RF006 <- n_nationkey                                                                                                                               |
| |                                                                                                                                                                      |
| |--21:EXCHANGE [BROADCAST]                                                                                                                                             |
| |  |                                                                                                                                                                   |
| |  03:SCAN HDFS [default.n_nation_parquet_impala]                                                                                                                      |
| |     partitions=1/1 files=1 size=3.25KB                                                                                                                               |
| |     runtime filters: RF004 -> n_regionkey                                                                                                                            |
| |                                                                                                                                                                      |
| 14:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                   |
| |  hash predicates: ps_suppkey = s_suppkey                                                                                                                             |
| |  runtime filters: RF008 <- s_suppkey                                                                                                                                 |
| |                                                                                                                                                                      |
| |--20:EXCHANGE [BROADCAST]                                                                                                                                             |
| |  |                                                                                                                                                                   |
| |  02:SCAN HDFS [default.s_supplier_parquet_impala]                                                                                                                    |
| |     partitions=1/1 files=1 size=1.46MB                                                                                                                               |
| |     runtime filters: RF006 -> s_nationkey                                                                                                                            |
| |                                                                                                                                                                      |
| 13:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                   |
| |  hash predicates: ps_partkey = p_partkey                                                                                                                             |
| |  runtime filters: RF010 <- p_partkey                                                                                                                                 |
| |                                                                                                                                                                      |
| |--19:EXCHANGE [BROADCAST]                                                                                                                                             |
| |  |                                                                                                                                                                   |
| |  00:SCAN HDFS [default.p_part_parquet_impala]                                                                                                                        |
| |     partitions=1/1 files=1 size=13.20MB                                                                                                                              |
| |     predicates: p_size = 15, p_type LIKE '%BRASS'                                                                                                                    |
| |     runtime filters: RF001 -> p_partkey                                                                                                                              |
| |                                                                                                                                                                      |
| 01:SCAN HDFS [default.ps_partsupp_parquet_impala]                                                                                                                      |
|    partitions=1/1 files=1 size=107.99MB                                                                                                                                |
|    runtime filters: RF000 -> ps_supplycost, RF001 -> default.ps_partsupp_parquet_impala.ps_partkey, RF008 -> ps_suppkey, RF010 -> ps_partkey                           |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
Fetched 108 row(s) in 3.81s
15/04/2019 16:00:26.687
--------------------------------------Finished QUERY 2. --------------------------------

--------------------------------------STARTED  QUERY 3. ---------------------------------
15/04/2019 16:00:26.696
Starting Impala Shell without Kerberos authentication
Connected to b05cdd87a09f:21000
Server version: impalad version 2.12.0-cdh5.16.1 RELEASE (build 4a3775ef6781301af81b23bca45a9faeca5e761d)
Query: explain select l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, to_date(o_orderdate), o_shippriority from c_customer_parquet_impala, o_orders_parquet_impala, l_lineitem_parquet_impala where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and to_date(o_orderdate) < to_date('1995-03-15') and to_date(l_shipdate) > to_date('1995-03-15') group by l_orderkey, to_date(o_orderdate), o_shippriority order by revenue desc, to_date(o_orderdate) limit 10
+-------------------------------------------------------------------------------------------------------+
| Explain String                                                                                        |
+-------------------------------------------------------------------------------------------------------+
| Max Per-Host Resource Reservation: Memory=76.81MB                                                     |
| Per-Host Resource Estimates: Memory=936.81MB                                                          |
| WARNING: The following tables are missing relevant table and/or column statistics.                    |
| default.c_customer_parquet_impala, default.l_lineitem_parquet_impala, default.o_orders_parquet_impala |
|                                                                                                       |
| PLAN-ROOT SINK                                                                                        |
| |                                                                                                     |
| 12:MERGING-EXCHANGE [UNPARTITIONED]                                                                   |
| |  order by: sum(l_extendedprice * (1 - l_discount)) DESC, to_date(o_orderdate) ASC                   |
| |  limit: 10                                                                                          |
| |                                                                                                     |
| 06:TOP-N [LIMIT=10]                                                                                   |
| |  order by: sum(l_extendedprice * (1 - l_discount)) DESC, to_date(o_orderdate) ASC                   |
| |                                                                                                     |
| 11:AGGREGATE [FINALIZE]                                                                               |
| |  output: sum:merge(l_extendedprice * (1 - l_discount))                                              |
| |  group by: l_orderkey, to_date(o_orderdate), o_shippriority                                         |
| |                                                                                                     |
| 10:EXCHANGE [HASH(l_orderkey,to_date(o_orderdate),o_shippriority)]                                    |
| |                                                                                                     |
| 05:AGGREGATE [STREAMING]                                                                              |
| |  output: sum(l_extendedprice * (1 - l_discount))                                                    |
| |  group by: l_orderkey, to_date(o_orderdate), o_shippriority                                         |
| |                                                                                                     |
| 04:HASH JOIN [INNER JOIN, BROADCAST]                                                                  |
| |  hash predicates: o_custkey = c_custkey                                                             |
| |  runtime filters: RF000 <- c_custkey                                                                |
| |                                                                                                     |
| |--09:EXCHANGE [BROADCAST]                                                                            |
| |  |                                                                                                  |
| |  00:SCAN HDFS [default.c_customer_parquet_impala]                                                   |
| |     partitions=1/1 files=1 size=23.54MB                                                             |
| |     predicates: c_mktsegment = 'BUILDING'                                                           |
| |                                                                                                     |
| 03:HASH JOIN [INNER JOIN, PARTITIONED]                                                                |
| |  hash predicates: l_orderkey = o_orderkey                                                           |
| |  runtime filters: RF002 <- o_orderkey                                                               |
| |                                                                                                     |
| |--08:EXCHANGE [HASH(o_orderkey)]                                                                     |
| |  |                                                                                                  |
| |  01:SCAN HDFS [default.o_orders_parquet_impala]                                                     |
| |     partitions=1/1 files=2 size=111.36MB                                                            |
| |     predicates: to_date(o_orderdate) < '1995-03-15'                                                 |
| |     runtime filters: RF000 -> o_custkey                                                             |
| |                                                                                                     |
| 07:EXCHANGE [HASH(l_orderkey)]                                                                        |
| |                                                                                                     |
| 02:SCAN HDFS [default.l_lineitem_parquet_impala]                                                      |
|    partitions=1/1 files=3 size=381.40MB                                                               |
|    predicates: to_date(l_shipdate) > '1995-03-15'                                                     |
|    runtime filters: RF002 -> l_orderkey                                                               |
+-------------------------------------------------------------------------------------------------------+
Fetched 51 row(s) in 3.79s
15/04/2019 16:00:30.682
--------------------------------------Finished QUERY 3.----------------------------------

--------------------------------------STARTED  QUERY 4. ---------------------------------
15/04/2019 16:00:30.691
Starting Impala Shell without Kerberos authentication
Connected to b05cdd87a09f:21000
Server version: impalad version 2.12.0-cdh5.16.1 RELEASE (build 4a3775ef6781301af81b23bca45a9faeca5e761d)
Query: explain select o_orderpriority, count(*) as order_count from o_orders_parquet_impala where to_date(o_orderdate) >= to_date('1993-07-01') and to_date(o_orderdate) < to_date(date_add(cast('1993-07-01' as timestamp), interval 3 month)) and exists ( select * from l_lineitem_parquet_impala where l_orderkey = o_orderkey and to_date(l_commitdate) < to_date(l_receiptdate) ) group by o_orderpriority order by o_orderpriority
+---------------------------------------------------------------------------------------------+
| Explain String                                                                              |
+---------------------------------------------------------------------------------------------+
| Max Per-Host Resource Reservation: Memory=86.75MB                                           |
| Per-Host Resource Estimates: Memory=730.75MB                                                |
| WARNING: The following tables are missing relevant table and/or column statistics.          |
| default.l_lineitem_parquet_impala, default.o_orders_parquet_impala                          |
|                                                                                             |
| PLAN-ROOT SINK                                                                              |
| |                                                                                           |
| 09:MERGING-EXCHANGE [UNPARTITIONED]                                                         |
| |  order by: o_orderpriority ASC                                                            |
| |                                                                                           |
| 04:SORT                                                                                     |
| |  order by: o_orderpriority ASC                                                            |
| |                                                                                           |
| 08:AGGREGATE [FINALIZE]                                                                     |
| |  output: count:merge(*)                                                                   |
| |  group by: o_orderpriority                                                                |
| |                                                                                           |
| 07:EXCHANGE [HASH(o_orderpriority)]                                                         |
| |                                                                                           |
| 03:AGGREGATE [STREAMING]                                                                    |
| |  output: count(*)                                                                         |
| |  group by: o_orderpriority                                                                |
| |                                                                                           |
| 02:HASH JOIN [RIGHT SEMI JOIN, PARTITIONED]                                                 |
| |  hash predicates: l_orderkey = o_orderkey                                                 |
| |  runtime filters: RF000 <- o_orderkey                                                     |
| |                                                                                           |
| |--06:EXCHANGE [HASH(o_orderkey)]                                                           |
| |  |                                                                                        |
| |  00:SCAN HDFS [default.o_orders_parquet_impala]                                           |
| |     partitions=1/1 files=2 size=111.36MB                                                  |
| |     predicates: to_date(o_orderdate) < '1993-10-01', to_date(o_orderdate) >= '1993-07-01' |
| |                                                                                           |
| 05:EXCHANGE [HASH(l_orderkey)]                                                              |
| |                                                                                           |
| 01:SCAN HDFS [default.l_lineitem_parquet_impala]                                            |
|    partitions=1/1 files=3 size=381.40MB                                                     |
|    predicates: to_date(l_commitdate) < to_date(l_receiptdate)                               |
|    runtime filters: RF000 -> l_orderkey                                                     |
+---------------------------------------------------------------------------------------------+
Fetched 39 row(s) in 0.02s
15/04/2019 16:00:30.906
--------------------------------------Finished QUERY 4.----------------------------------

--------------------------------------STARTED  QUERY 5. ---------------------------------
15/04/2019 16:00:30.916
Starting Impala Shell without Kerberos authentication
Connected to b05cdd87a09f:21000
Server version: impalad version 2.12.0-cdh5.16.1 RELEASE (build 4a3775ef6781301af81b23bca45a9faeca5e761d)
Query: explain select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from c_customer_parquet_impala, o_orders_parquet_impala, l_lineitem_parquet_impala, s_supplier_parquet_impala, n_nation_parquet_impala, r_region_parquet_impala where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and to_date(o_orderdate) >= to_date('1994-01-01') and to_date(o_orderdate) < to_date(date_add(cast('1994-01-01' as timestamp), interval 1 year)) group by n_name order by revenue desc
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Explain String                                                                                                                                                                                             |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Max Per-Host Resource Reservation: Memory=113.81MB                                                                                                                                                         |
| Per-Host Resource Estimates: Memory=1021.81MB                                                                                                                                                              |
| WARNING: The following tables are missing relevant table and/or column statistics.                                                                                                                         |
| default.c_customer_parquet_impala, default.l_lineitem_parquet_impala, default.n_nation_parquet_impala, default.o_orders_parquet_impala, default.r_region_parquet_impala, default.s_supplier_parquet_impala |
|                                                                                                                                                                                                            |
| PLAN-ROOT SINK                                                                                                                                                                                             |
| |                                                                                                                                                                                                          |
| 20:MERGING-EXCHANGE [UNPARTITIONED]                                                                                                                                                                        |
| |  order by: sum(l_extendedprice * (1 - l_discount)) DESC                                                                                                                                                  |
| |                                                                                                                                                                                                          |
| 12:SORT                                                                                                                                                                                                    |
| |  order by: sum(l_extendedprice * (1 - l_discount)) DESC                                                                                                                                                  |
| |                                                                                                                                                                                                          |
| 19:AGGREGATE [FINALIZE]                                                                                                                                                                                    |
| |  output: sum:merge(l_extendedprice * (1 - l_discount))                                                                                                                                                   |
| |  group by: n_name                                                                                                                                                                                        |
| |                                                                                                                                                                                                          |
| 18:EXCHANGE [HASH(n_name)]                                                                                                                                                                                 |
| |                                                                                                                                                                                                          |
| 11:AGGREGATE [STREAMING]                                                                                                                                                                                   |
| |  output: sum(l_extendedprice * (1 - l_discount))                                                                                                                                                         |
| |  group by: n_name                                                                                                                                                                                        |
| |                                                                                                                                                                                                          |
| 10:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                                                       |
| |  hash predicates: n_regionkey = r_regionkey                                                                                                                                                              |
| |  runtime filters: RF000 <- r_regionkey                                                                                                                                                                   |
| |                                                                                                                                                                                                          |
| |--17:EXCHANGE [BROADCAST]                                                                                                                                                                                 |
| |  |                                                                                                                                                                                                       |
| |  05:SCAN HDFS [default.r_region_parquet_impala]                                                                                                                                                          |
| |     partitions=1/1 files=1 size=1.12KB                                                                                                                                                                   |
| |     predicates: r_name = 'ASIA'                                                                                                                                                                          |
| |                                                                                                                                                                                                          |
| 09:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                                                       |
| |  hash predicates: s_nationkey = n_nationkey                                                                                                                                                              |
| |  runtime filters: RF002 <- n_nationkey                                                                                                                                                                   |
| |                                                                                                                                                                                                          |
| |--16:EXCHANGE [BROADCAST]                                                                                                                                                                                 |
| |  |                                                                                                                                                                                                       |
| |  04:SCAN HDFS [default.n_nation_parquet_impala]                                                                                                                                                          |
| |     partitions=1/1 files=1 size=3.25KB                                                                                                                                                                   |
| |     runtime filters: RF000 -> n_regionkey                                                                                                                                                                |
| |                                                                                                                                                                                                          |
| 08:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                                                       |
| |  hash predicates: c_nationkey = s_nationkey, l_suppkey = s_suppkey                                                                                                                                       |
| |  runtime filters: RF004 <- s_nationkey, RF005 <- s_suppkey                                                                                                                                               |
| |                                                                                                                                                                                                          |
| |--15:EXCHANGE [BROADCAST]                                                                                                                                                                                 |
| |  |                                                                                                                                                                                                       |
| |  03:SCAN HDFS [default.s_supplier_parquet_impala]                                                                                                                                                        |
| |     partitions=1/1 files=1 size=1.46MB                                                                                                                                                                   |
| |     runtime filters: RF002 -> s_nationkey                                                                                                                                                                |
| |                                                                                                                                                                                                          |
| 07:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                                                       |
| |  hash predicates: o_custkey = c_custkey                                                                                                                                                                  |
| |  runtime filters: RF008 <- c_custkey                                                                                                                                                                     |
| |                                                                                                                                                                                                          |
| |--14:EXCHANGE [BROADCAST]                                                                                                                                                                                 |
| |  |                                                                                                                                                                                                       |
| |  00:SCAN HDFS [default.c_customer_parquet_impala]                                                                                                                                                        |
| |     partitions=1/1 files=1 size=23.54MB                                                                                                                                                                  |
| |     runtime filters: RF002 -> default.c_customer_parquet_impala.c_nationkey, RF004 -> c_nationkey                                                                                                        |
| |                                                                                                                                                                                                          |
| 06:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                                                       |
| |  hash predicates: l_orderkey = o_orderkey                                                                                                                                                                |
| |  runtime filters: RF010 <- o_orderkey                                                                                                                                                                    |
| |                                                                                                                                                                                                          |
| |--13:EXCHANGE [BROADCAST]                                                                                                                                                                                 |
| |  |                                                                                                                                                                                                       |
| |  01:SCAN HDFS [default.o_orders_parquet_impala]                                                                                                                                                          |
| |     partitions=1/1 files=2 size=111.36MB                                                                                                                                                                 |
| |     predicates: to_date(o_orderdate) < '1995-01-01', to_date(o_orderdate) >= '1994-01-01'                                                                                                                |
| |     runtime filters: RF008 -> o_custkey                                                                                                                                                                  |
| |                                                                                                                                                                                                          |
| 02:SCAN HDFS [default.l_lineitem_parquet_impala]                                                                                                                                                           |
|    partitions=1/1 files=3 size=381.40MB                                                                                                                                                                    |
|    runtime filters: RF005 -> l_suppkey, RF010 -> l_orderkey                                                                                                                                                |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
Fetched 77 row(s) in 0.02s
15/04/2019 16:00:31.161
--------------------------------------Finished QUERY 5.----------------------------------

--------------------------------------STARTED  QUERY 6. ---------------------------------
15/04/2019 16:00:31.171
Starting Impala Shell without Kerberos authentication
Connected to b05cdd87a09f:21000
Server version: impalad version 2.12.0-cdh5.16.1 RELEASE (build 4a3775ef6781301af81b23bca45a9faeca5e761d)
Query: explain select sum(l_extendedprice*l_discount) as revenue from l_lineitem_parquet_impala where to_date(l_shipdate) >= to_date('1994-01-01') and to_date(l_shipdate) < to_date(date_add(cast('1994-01-01' as timestamp), interval 1 year)) and l_discount between 0.06 - 0.01 and 0.06 + 0.01 and l_quantity < 24
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Explain String                                                                                                                                                                                                                                            |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Max Per-Host Resource Reservation: Memory=0B                                                                                                                                                                                                              |
| Per-Host Resource Estimates: Memory=372.00MB                                                                                                                                                                                                              |
| WARNING: The following tables are missing relevant table and/or column statistics.                                                                                                                                                                        |
| default.l_lineitem_parquet_impala                                                                                                                                                                                                                         |
|                                                                                                                                                                                                                                                           |
| PLAN-ROOT SINK                                                                                                                                                                                                                                            |
| |                                                                                                                                                                                                                                                         |
| 03:AGGREGATE [FINALIZE]                                                                                                                                                                                                                                   |
| |  output: sum:merge(l_extendedprice * l_discount)                                                                                                                                                                                                        |
| |                                                                                                                                                                                                                                                         |
| 02:EXCHANGE [UNPARTITIONED]                                                                                                                                                                                                                               |
| |                                                                                                                                                                                                                                                         |
| 01:AGGREGATE                                                                                                                                                                                                                                              |
| |  output: sum(l_extendedprice * l_discount)                                                                                                                                                                                                              |
| |                                                                                                                                                                                                                                                         |
| 00:SCAN HDFS [default.l_lineitem_parquet_impala]                                                                                                                                                                                                          |
|    partitions=1/1 files=3 size=381.40MB                                                                                                                                                                                                                   |
|    predicates: l_discount <= 0.070000000000000006661338147750939242541790008544921875, l_discount >= 0.05000000000000000277555756156289135105907917022705078125, l_quantity < 24, to_date(l_shipdate) < '1995-01-01', to_date(l_shipdate) >= '1994-01-01' |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
Fetched 18 row(s) in 0.01s
15/04/2019 16:00:31.389
--------------------------------------Finished QUERY 6.----------------------------------

--------------------------------------STARTED  QUERY 7. ---------------------------------
15/04/2019 16:00:31.398
Starting Impala Shell without Kerberos authentication
Connected to b05cdd87a09f:21000
Server version: impalad version 2.12.0-cdh5.16.1 RELEASE (build 4a3775ef6781301af81b23bca45a9faeca5e761d)
Query: explain select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, year(to_date(l_shipdate)) as l_year, l_extendedprice * (1 - l_discount) as volume from s_supplier_parquet_impala, l_lineitem_parquet_impala, o_orders_parquet_impala, c_customer_parquet_impala, n_nation_parquet_impala n1, n_nation_parquet_impala n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY') or (n1.n_name = 'GERMANY' and n2.n_name = 'FRANCE') ) and to_date(l_shipdate) between to_date('1995-01-01') and to_date('1996-12-31') ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Explain String                                                                                                                                                            |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Max Per-Host Resource Reservation: Memory=138.31MB                                                                                                                        |
| Per-Host Resource Estimates: Memory=1.03GB                                                                                                                                |
| WARNING: The following tables are missing relevant table and/or column statistics.                                                                                        |
| default.c_customer_parquet_impala, default.l_lineitem_parquet_impala, default.n_nation_parquet_impala, default.o_orders_parquet_impala, default.s_supplier_parquet_impala |
|                                                                                                                                                                           |
| PLAN-ROOT SINK                                                                                                                                                            |
| |                                                                                                                                                                         |
| 21:MERGING-EXCHANGE [UNPARTITIONED]                                                                                                                                       |
| |  order by: supp_nation ASC, cust_nation ASC, l_year ASC                                                                                                                 |
| |                                                                                                                                                                         |
| 12:SORT                                                                                                                                                                   |
| |  order by: supp_nation ASC, cust_nation ASC, l_year ASC                                                                                                                 |
| |                                                                                                                                                                         |
| 20:AGGREGATE [FINALIZE]                                                                                                                                                   |
| |  output: sum:merge(volume)                                                                                                                                              |
| |  group by: supp_nation, cust_nation, l_year                                                                                                                             |
| |                                                                                                                                                                         |
| 19:EXCHANGE [HASH(supp_nation,cust_nation,l_year)]                                                                                                                        |
| |                                                                                                                                                                         |
| 11:AGGREGATE [STREAMING]                                                                                                                                                  |
| |  output: sum(l_extendedprice * (1 - l_discount))                                                                                                                        |
| |  group by: n1.n_name, n2.n_name, year(to_date(l_shipdate))                                                                                                              |
| |                                                                                                                                                                         |
| 10:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                      |
| |  hash predicates: c_nationkey = n2.n_nationkey                                                                                                                          |
| |  other predicates: ((n1.n_name = 'FRANCE' AND n2.n_name = 'GERMANY') OR (n1.n_name = 'GERMANY' AND n2.n_name = 'FRANCE'))                                               |
| |  runtime filters: RF000 <- n2.n_nationkey                                                                                                                               |
| |                                                                                                                                                                         |
| |--18:EXCHANGE [BROADCAST]                                                                                                                                                |
| |  |                                                                                                                                                                      |
| |  05:SCAN HDFS [default.n_nation_parquet_impala n2]                                                                                                                      |
| |     partitions=1/1 files=1 size=3.25KB                                                                                                                                  |
| |                                                                                                                                                                         |
| 09:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                      |
| |  hash predicates: s_nationkey = n1.n_nationkey                                                                                                                          |
| |  runtime filters: RF002 <- n1.n_nationkey                                                                                                                               |
| |                                                                                                                                                                         |
| |--17:EXCHANGE [BROADCAST]                                                                                                                                                |
| |  |                                                                                                                                                                      |
| |  04:SCAN HDFS [default.n_nation_parquet_impala n1]                                                                                                                      |
| |     partitions=1/1 files=1 size=3.25KB                                                                                                                                  |
| |                                                                                                                                                                         |
| 08:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                      |
| |  hash predicates: o_custkey = c_custkey                                                                                                                                 |
| |  runtime filters: RF004 <- c_custkey                                                                                                                                    |
| |                                                                                                                                                                         |
| |--16:EXCHANGE [BROADCAST]                                                                                                                                                |
| |  |                                                                                                                                                                      |
| |  03:SCAN HDFS [default.c_customer_parquet_impala]                                                                                                                       |
| |     partitions=1/1 files=1 size=23.54MB                                                                                                                                 |
| |     runtime filters: RF000 -> c_nationkey                                                                                                                               |
| |                                                                                                                                                                         |
| 07:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                      |
| |  hash predicates: l_suppkey = s_suppkey                                                                                                                                 |
| |  runtime filters: RF006 <- s_suppkey                                                                                                                                    |
| |                                                                                                                                                                         |
| |--15:EXCHANGE [BROADCAST]                                                                                                                                                |
| |  |                                                                                                                                                                      |
| |  00:SCAN HDFS [default.s_supplier_parquet_impala]                                                                                                                       |
| |     partitions=1/1 files=1 size=1.46MB                                                                                                                                  |
| |     runtime filters: RF002 -> s_nationkey                                                                                                                               |
| |                                                                                                                                                                         |
| 06:HASH JOIN [INNER JOIN, PARTITIONED]                                                                                                                                    |
| |  hash predicates: l_orderkey = o_orderkey                                                                                                                               |
| |  runtime filters: RF008 <- o_orderkey                                                                                                                                   |
| |                                                                                                                                                                         |
| |--14:EXCHANGE [HASH(o_orderkey)]                                                                                                                                         |
| |  |                                                                                                                                                                      |
| |  02:SCAN HDFS [default.o_orders_parquet_impala]                                                                                                                         |
| |     partitions=1/1 files=2 size=111.36MB                                                                                                                                |
| |     runtime filters: RF004 -> o_custkey                                                                                                                                 |
| |                                                                                                                                                                         |
| 13:EXCHANGE [HASH(l_orderkey)]                                                                                                                                            |
| |                                                                                                                                                                         |
| 01:SCAN HDFS [default.l_lineitem_parquet_impala]                                                                                                                          |
|    partitions=1/1 files=3 size=381.40MB                                                                                                                                   |
|    predicates: to_date(l_shipdate) <= '1996-12-31', to_date(l_shipdate) >= '1995-01-01'                                                                                   |
|    runtime filters: RF006 -> l_suppkey, RF008 -> l_orderkey                                                                                                               |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
Fetched 78 row(s) in 0.02s
15/04/2019 16:00:31.615
--------------------------------------Finished QUERY 7.----------------------------------

--------------------------------------STARTED  QUERY 8. ---------------------------------
15/04/2019 16:00:31.624
Starting Impala Shell without Kerberos authentication
Connected to b05cdd87a09f:21000
Server version: impalad version 2.12.0-cdh5.16.1 RELEASE (build 4a3775ef6781301af81b23bca45a9faeca5e761d)
Query: explain select o_year, sum(case when nation = 'BRAZIL' then volume else 0 end) / sum(volume) as mkt_share from ( select year(to_date(o_orderdate)) as o_year, l_extendedprice * (1-l_discount) as volume, n2.n_name as nation from p_part_parquet_impala, s_supplier_parquet_impala, l_lineitem_parquet_impala, o_orders_parquet_impala, c_customer_parquet_impala, n_nation_parquet_impala n1, n_nation_parquet_impala n2, r_region_parquet_impala where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and to_date(o_orderdate) between to_date('1995-01-01') and to_date('1996-12-31') and p_type = 'ECONOMY ANODIZED STEEL' ) as all_nations group by o_year order by o_year
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Explain String                                                                                                                                                                                                                            |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Max Per-Host Resource Reservation: Memory=111.69MB                                                                                                                                                                                        |
| Per-Host Resource Estimates: Memory=1.15GB                                                                                                                                                                                                |
| WARNING: The following tables are missing relevant table and/or column statistics.                                                                                                                                                        |
| default.c_customer_parquet_impala, default.l_lineitem_parquet_impala, default.n_nation_parquet_impala, default.o_orders_parquet_impala, default.p_part_parquet_impala, default.r_region_parquet_impala, default.s_supplier_parquet_impala |
|                                                                                                                                                                                                                                           |
| PLAN-ROOT SINK                                                                                                                                                                                                                            |
| |                                                                                                                                                                                                                                         |
| 26:MERGING-EXCHANGE [UNPARTITIONED]                                                                                                                                                                                                       |
| |  order by: o_year ASC                                                                                                                                                                                                                   |
| |                                                                                                                                                                                                                                         |
| 16:SORT                                                                                                                                                                                                                                   |
| |  order by: o_year ASC                                                                                                                                                                                                                   |
| |                                                                                                                                                                                                                                         |
| 25:AGGREGATE [FINALIZE]                                                                                                                                                                                                                   |
| |  output: sum:merge(CASE WHEN nation = 'BRAZIL' THEN volume ELSE 0 END), sum:merge(volume)                                                                                                                                               |
| |  group by: o_year                                                                                                                                                                                                                       |
| |                                                                                                                                                                                                                                         |
| 24:EXCHANGE [HASH(o_year)]                                                                                                                                                                                                                |
| |                                                                                                                                                                                                                                         |
| 15:AGGREGATE [STREAMING]                                                                                                                                                                                                                  |
| |  output: sum(CASE WHEN n2.n_name = 'BRAZIL' THEN l_extendedprice * (1 - l_discount) ELSE 0 END), sum(l_extendedprice * (1 - l_discount))                                                                                                |
| |  group by: year(to_date(o_orderdate))                                                                                                                                                                                                   |
| |                                                                                                                                                                                                                                         |
| 14:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                                                                                      |
| |  hash predicates: n1.n_regionkey = r_regionkey                                                                                                                                                                                          |
| |  runtime filters: RF000 <- r_regionkey                                                                                                                                                                                                  |
| |                                                                                                                                                                                                                                         |
| |--23:EXCHANGE [BROADCAST]                                                                                                                                                                                                                |
| |  |                                                                                                                                                                                                                                      |
| |  07:SCAN HDFS [default.r_region_parquet_impala]                                                                                                                                                                                         |
| |     partitions=1/1 files=1 size=1.12KB                                                                                                                                                                                                  |
| |     predicates: r_name = 'AMERICA'                                                                                                                                                                                                      |
| |                                                                                                                                                                                                                                         |
| 13:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                                                                                      |
| |  hash predicates: s_nationkey = n2.n_nationkey                                                                                                                                                                                          |
| |  runtime filters: RF002 <- n2.n_nationkey                                                                                                                                                                                               |
| |                                                                                                                                                                                                                                         |
| |--22:EXCHANGE [BROADCAST]                                                                                                                                                                                                                |
| |  |                                                                                                                                                                                                                                      |
| |  06:SCAN HDFS [default.n_nation_parquet_impala n2]                                                                                                                                                                                      |
| |     partitions=1/1 files=1 size=3.25KB                                                                                                                                                                                                  |
| |                                                                                                                                                                                                                                         |
| 12:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                                                                                      |
| |  hash predicates: c_nationkey = n1.n_nationkey                                                                                                                                                                                          |
| |  runtime filters: RF004 <- n1.n_nationkey                                                                                                                                                                                               |
| |                                                                                                                                                                                                                                         |
| |--21:EXCHANGE [BROADCAST]                                                                                                                                                                                                                |
| |  |                                                                                                                                                                                                                                      |
| |  05:SCAN HDFS [default.n_nation_parquet_impala n1]                                                                                                                                                                                      |
| |     partitions=1/1 files=1 size=3.25KB                                                                                                                                                                                                  |
| |     runtime filters: RF000 -> n1.n_regionkey                                                                                                                                                                                            |
| |                                                                                                                                                                                                                                         |
| 11:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                                                                                      |
| |  hash predicates: o_custkey = c_custkey                                                                                                                                                                                                 |
| |  runtime filters: RF006 <- c_custkey                                                                                                                                                                                                    |
| |                                                                                                                                                                                                                                         |
| |--20:EXCHANGE [BROADCAST]                                                                                                                                                                                                                |
| |  |                                                                                                                                                                                                                                      |
| |  04:SCAN HDFS [default.c_customer_parquet_impala]                                                                                                                                                                                       |
| |     partitions=1/1 files=1 size=23.54MB                                                                                                                                                                                                 |
| |     runtime filters: RF004 -> c_nationkey                                                                                                                                                                                               |
| |                                                                                                                                                                                                                                         |
| 10:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                                                                                      |
| |  hash predicates: l_orderkey = o_orderkey                                                                                                                                                                                               |
| |  runtime filters: RF008 <- o_orderkey                                                                                                                                                                                                   |
| |                                                                                                                                                                                                                                         |
| |--19:EXCHANGE [BROADCAST]                                                                                                                                                                                                                |
| |  |                                                                                                                                                                                                                                      |
| |  03:SCAN HDFS [default.o_orders_parquet_impala]                                                                                                                                                                                         |
| |     partitions=1/1 files=2 size=111.36MB                                                                                                                                                                                                |
| |     predicates: to_date(o_orderdate) <= '1996-12-31', to_date(o_orderdate) >= '1995-01-01'                                                                                                                                              |
| |     runtime filters: RF006 -> o_custkey                                                                                                                                                                                                 |
| |                                                                                                                                                                                                                                         |
| 09:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                                                                                      |
| |  hash predicates: l_suppkey = s_suppkey                                                                                                                                                                                                 |
| |  runtime filters: RF010 <- s_suppkey                                                                                                                                                                                                    |
| |                                                                                                                                                                                                                                         |
| |--18:EXCHANGE [BROADCAST]                                                                                                                                                                                                                |
| |  |                                                                                                                                                                                                                                      |
| |  01:SCAN HDFS [default.s_supplier_parquet_impala]                                                                                                                                                                                       |
| |     partitions=1/1 files=1 size=1.46MB                                                                                                                                                                                                  |
| |     runtime filters: RF002 -> s_nationkey                                                                                                                                                                                               |
| |                                                                                                                                                                                                                                         |
| 08:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                                                                                      |
| |  hash predicates: l_partkey = p_partkey                                                                                                                                                                                                 |
| |  runtime filters: RF012 <- p_partkey                                                                                                                                                                                                    |
| |                                                                                                                                                                                                                                         |
| |--17:EXCHANGE [BROADCAST]                                                                                                                                                                                                                |
| |  |                                                                                                                                                                                                                                      |
| |  00:SCAN HDFS [default.p_part_parquet_impala]                                                                                                                                                                                           |
| |     partitions=1/1 files=1 size=13.20MB                                                                                                                                                                                                 |
| |     predicates: p_type = 'ECONOMY ANODIZED STEEL'                                                                                                                                                                                       |
| |                                                                                                                                                                                                                                         |
| 02:SCAN HDFS [default.l_lineitem_parquet_impala]                                                                                                                                                                                          |
|    partitions=1/1 files=3 size=381.40MB                                                                                                                                                                                                   |
|    runtime filters: RF008 -> l_orderkey, RF010 -> l_suppkey, RF012 -> l_partkey                                                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
Fetched 96 row(s) in 0.02s
15/04/2019 16:00:31.845
--------------------------------------Finished QUERY 8.----------------------------------

--------------------------------------STARTED  QUERY 9. ---------------------------------
15/04/2019 16:00:31.854
Starting Impala Shell without Kerberos authentication
Connected to b05cdd87a09f:21000
Server version: impalad version 2.12.0-cdh5.16.1 RELEASE (build 4a3775ef6781301af81b23bca45a9faeca5e761d)
Query: explain select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, year(to_date(o_orderdate)) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from p_part_parquet_impala, s_supplier_parquet_impala, l_lineitem_parquet_impala, ps_partsupp_parquet_impala, o_orders_parquet_impala, n_nation_parquet_impala where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%green%' ) as profit group by nation, o_year order by nation, o_year desc
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Explain String                                                                                                                                                                                            |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Max Per-Host Resource Reservation: Memory=162.81MB                                                                                                                                                        |
| Per-Host Resource Estimates: Memory=1.37GB                                                                                                                                                                |
| WARNING: The following tables are missing relevant table and/or column statistics.                                                                                                                        |
| default.l_lineitem_parquet_impala, default.n_nation_parquet_impala, default.o_orders_parquet_impala, default.p_part_parquet_impala, default.ps_partsupp_parquet_impala, default.s_supplier_parquet_impala |
|                                                                                                                                                                                                           |
| PLAN-ROOT SINK                                                                                                                                                                                            |
| |                                                                                                                                                                                                         |
| 20:MERGING-EXCHANGE [UNPARTITIONED]                                                                                                                                                                       |
| |  order by: nation ASC, o_year DESC                                                                                                                                                                      |
| |                                                                                                                                                                                                         |
| 12:SORT                                                                                                                                                                                                   |
| |  order by: nation ASC, o_year DESC                                                                                                                                                                      |
| |                                                                                                                                                                                                         |
| 19:AGGREGATE [FINALIZE]                                                                                                                                                                                   |
| |  output: sum:merge(amount)                                                                                                                                                                              |
| |  group by: nation, o_year                                                                                                                                                                               |
| |                                                                                                                                                                                                         |
| 18:EXCHANGE [HASH(nation,o_year)]                                                                                                                                                                         |
| |                                                                                                                                                                                                         |
| 11:AGGREGATE [STREAMING]                                                                                                                                                                                  |
| |  output: sum(l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity)                                                                                                                           |
| |  group by: n_name, year(to_date(o_orderdate))                                                                                                                                                           |
| |                                                                                                                                                                                                         |
| 10:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                                                      |
| |  hash predicates: s_nationkey = n_nationkey                                                                                                                                                             |
| |  runtime filters: RF000 <- n_nationkey                                                                                                                                                                  |
| |                                                                                                                                                                                                         |
| |--17:EXCHANGE [BROADCAST]                                                                                                                                                                                |
| |  |                                                                                                                                                                                                      |
| |  05:SCAN HDFS [default.n_nation_parquet_impala]                                                                                                                                                         |
| |     partitions=1/1 files=1 size=3.25KB                                                                                                                                                                  |
| |                                                                                                                                                                                                         |
| 09:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                                                      |
| |  hash predicates: l_orderkey = o_orderkey                                                                                                                                                               |
| |  runtime filters: RF002 <- o_orderkey                                                                                                                                                                   |
| |                                                                                                                                                                                                         |
| |--16:EXCHANGE [BROADCAST]                                                                                                                                                                                |
| |  |                                                                                                                                                                                                      |
| |  04:SCAN HDFS [default.o_orders_parquet_impala]                                                                                                                                                         |
| |     partitions=1/1 files=2 size=111.36MB                                                                                                                                                                |
| |                                                                                                                                                                                                         |
| 08:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                                                      |
| |  hash predicates: l_partkey = ps_partkey, l_suppkey = ps_suppkey                                                                                                                                        |
| |  runtime filters: RF004 <- ps_partkey, RF005 <- ps_suppkey                                                                                                                                              |
| |                                                                                                                                                                                                         |
| |--15:EXCHANGE [BROADCAST]                                                                                                                                                                                |
| |  |                                                                                                                                                                                                      |
| |  03:SCAN HDFS [default.ps_partsupp_parquet_impala]                                                                                                                                                      |
| |     partitions=1/1 files=1 size=107.99MB                                                                                                                                                                |
| |                                                                                                                                                                                                         |
| 07:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                                                      |
| |  hash predicates: l_suppkey = s_suppkey                                                                                                                                                                 |
| |  runtime filters: RF008 <- s_suppkey                                                                                                                                                                    |
| |                                                                                                                                                                                                         |
| |--14:EXCHANGE [BROADCAST]                                                                                                                                                                                |
| |  |                                                                                                                                                                                                      |
| |  01:SCAN HDFS [default.s_supplier_parquet_impala]                                                                                                                                                       |
| |     partitions=1/1 files=1 size=1.46MB                                                                                                                                                                  |
| |     runtime filters: RF000 -> s_nationkey, RF005 -> default.s_supplier_parquet_impala.s_suppkey                                                                                                         |
| |                                                                                                                                                                                                         |
| 06:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                                                      |
| |  hash predicates: l_partkey = p_partkey                                                                                                                                                                 |
| |  runtime filters: RF010 <- p_partkey                                                                                                                                                                    |
| |                                                                                                                                                                                                         |
| |--13:EXCHANGE [BROADCAST]                                                                                                                                                                                |
| |  |                                                                                                                                                                                                      |
| |  00:SCAN HDFS [default.p_part_parquet_impala]                                                                                                                                                           |
| |     partitions=1/1 files=1 size=13.20MB                                                                                                                                                                 |
| |     predicates: p_name LIKE '%green%'                                                                                                                                                                   |
| |     runtime filters: RF004 -> default.p_part_parquet_impala.p_partkey                                                                                                                                   |
| |                                                                                                                                                                                                         |
| 02:SCAN HDFS [default.l_lineitem_parquet_impala]                                                                                                                                                          |
|    partitions=1/1 files=3 size=381.40MB                                                                                                                                                                   |
|    runtime filters: RF002 -> l_orderkey, RF004 -> l_partkey, RF005 -> l_suppkey, RF008 -> l_suppkey, RF010 -> l_partkey                                                                                   |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
Fetched 74 row(s) in 0.02s
15/04/2019 16:00:32.063
--------------------------------------Finished QUERY 9.----------------------------------

--------------------------------------STARTED  QUERY 10. ---------------------------------
15/04/2019 16:00:32.071
Starting Impala Shell without Kerberos authentication
Connected to b05cdd87a09f:21000
Server version: impalad version 2.12.0-cdh5.16.1 RELEASE (build 4a3775ef6781301af81b23bca45a9faeca5e761d)
Query: explain select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from c_customer_parquet_impala, o_orders_parquet_impala, l_lineitem_parquet_impala, n_nation_parquet_impala where c_custkey = o_custkey and l_orderkey = o_orderkey and to_date(o_orderdate) >= to_date('1993-10-01') and to_date(o_orderdate) < to_date(date_add(cast('1993-10-01' as timestamp), interval 3 month)) and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc limit 20
+----------------------------------------------------------------------------------------------------------------------------------------+
| Explain String                                                                                                                         |
+----------------------------------------------------------------------------------------------------------------------------------------+
| Max Per-Host Resource Reservation: Memory=83.56MB                                                                                      |
| Per-Host Resource Estimates: Memory=1.05GB                                                                                             |
| WARNING: The following tables are missing relevant table and/or column statistics.                                                     |
| default.c_customer_parquet_impala, default.l_lineitem_parquet_impala, default.n_nation_parquet_impala, default.o_orders_parquet_impala |
|                                                                                                                                        |
| PLAN-ROOT SINK                                                                                                                         |
| |                                                                                                                                      |
| 16:MERGING-EXCHANGE [UNPARTITIONED]                                                                                                    |
| |  order by: sum(l_extendedprice * (1 - l_discount)) DESC                                                                              |
| |  limit: 20                                                                                                                           |
| |                                                                                                                                      |
| 08:TOP-N [LIMIT=20]                                                                                                                    |
| |  order by: sum(l_extendedprice * (1 - l_discount)) DESC                                                                              |
| |                                                                                                                                      |
| 15:AGGREGATE [FINALIZE]                                                                                                                |
| |  output: sum:merge(l_extendedprice * (1 - l_discount))                                                                               |
| |  group by: c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment                                                       |
| |                                                                                                                                      |
| 14:EXCHANGE [HASH(c_custkey,c_name,c_acctbal,c_phone,n_name,c_address,c_comment)]                                                      |
| |                                                                                                                                      |
| 07:AGGREGATE [STREAMING]                                                                                                               |
| |  output: sum(l_extendedprice * (1 - l_discount))                                                                                     |
| |  group by: c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment                                                       |
| |                                                                                                                                      |
| 06:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                   |
| |  hash predicates: c_nationkey = n_nationkey                                                                                          |
| |  runtime filters: RF000 <- n_nationkey                                                                                               |
| |                                                                                                                                      |
| |--13:EXCHANGE [BROADCAST]                                                                                                             |
| |  |                                                                                                                                   |
| |  03:SCAN HDFS [default.n_nation_parquet_impala]                                                                                      |
| |     partitions=1/1 files=1 size=3.25KB                                                                                               |
| |                                                                                                                                      |
| 05:HASH JOIN [INNER JOIN, PARTITIONED]                                                                                                 |
| |  hash predicates: o_custkey = c_custkey                                                                                              |
| |  runtime filters: RF002 <- c_custkey                                                                                                 |
| |                                                                                                                                      |
| |--12:EXCHANGE [HASH(c_custkey)]                                                                                                       |
| |  |                                                                                                                                   |
| |  00:SCAN HDFS [default.c_customer_parquet_impala]                                                                                    |
| |     partitions=1/1 files=1 size=23.54MB                                                                                              |
| |     runtime filters: RF000 -> c_nationkey                                                                                            |
| |                                                                                                                                      |
| 11:EXCHANGE [HASH(o_custkey)]                                                                                                          |
| |                                                                                                                                      |
| 04:HASH JOIN [INNER JOIN, PARTITIONED]                                                                                                 |
| |  hash predicates: l_orderkey = o_orderkey                                                                                            |
| |  runtime filters: RF004 <- o_orderkey                                                                                                |
| |                                                                                                                                      |
| |--10:EXCHANGE [HASH(o_orderkey)]                                                                                                      |
| |  |                                                                                                                                   |
| |  01:SCAN HDFS [default.o_orders_parquet_impala]                                                                                      |
| |     partitions=1/1 files=2 size=111.36MB                                                                                             |
| |     predicates: to_date(o_orderdate) < '1994-01-01', to_date(o_orderdate) >= '1993-10-01'                                            |
| |     runtime filters: RF002 -> o_custkey                                                                                              |
| |                                                                                                                                      |
| 09:EXCHANGE [HASH(l_orderkey)]                                                                                                         |
| |                                                                                                                                      |
| 02:SCAN HDFS [default.l_lineitem_parquet_impala]                                                                                       |
|    partitions=1/1 files=3 size=381.40MB                                                                                                |
|    predicates: l_returnflag = 'R'                                                                                                      |
|    runtime filters: RF004 -> l_orderkey                                                                                                |
+----------------------------------------------------------------------------------------------------------------------------------------+
Fetched 62 row(s) in 0.02s
15/04/2019 16:00:32.291
--------------------------------------Finished QUERY 10.----------------------------------

--------------------------------------STARTED  QUERY 11. ---------------------------------
15/04/2019 16:00:32.300
Starting Impala Shell without Kerberos authentication
Connected to b05cdd87a09f:21000
Server version: impalad version 2.12.0-cdh5.16.1 RELEASE (build 4a3775ef6781301af81b23bca45a9faeca5e761d)
Query: explain create view q11_part_tmp_cached as select ps_partkey,sum(ps_supplycost * ps_availqty) as part_value from ps_partsupp_parquet_impala,s_supplier_parquet_impala,n_nation_parquet_impala where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'GERMANY' group by ps_partkey
ERROR: AnalysisException: Syntax error in line 1:
explain create view q11_part_tmp_cached as ...
               ^
Encountered: VIEW
Expected: EXTERNAL, STRAIGHT_JOIN, TABLE

CAUSED BY: Exception: Syntax error

Could not execute command: explain create view q11_part_tmp_cached as select ps_partkey,sum(ps_supplycost * ps_availqty) as part_value from ps_partsupp_parquet_impala,s_supplier_parquet_impala,n_nation_parquet_impala where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'GERMANY' group by ps_partkey
15/04/2019 16:00:32.489
--------------------------------------Finished QUERY 11.----------------------------------

--------------------------------------STARTED  QUERY 12. ---------------------------------
15/04/2019 16:00:32.498
Starting Impala Shell without Kerberos authentication
Connected to b05cdd87a09f:21000
Server version: impalad version 2.12.0-cdh5.16.1 RELEASE (build 4a3775ef6781301af81b23bca45a9faeca5e761d)
Query: explain select l_shipmode, sum(case when o_orderpriority ='1-URGENT' or o_orderpriority ='2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from o_orders_parquet_impala, l_lineitem_parquet_impala where o_orderkey = l_orderkey and l_shipmode in ('MAIL', 'SHIP') and to_date(l_commitdate) < to_date(l_receiptdate) and to_date(l_shipdate) < to_date(l_commitdate) and to_date(l_receiptdate) >= to_date('1994-01-01') and to_date(l_receiptdate) < to_date(date_add(cast('1994-01-01' as timestamp), interval 1 year)) group by l_shipmode order by l_shipmode
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Explain String                                                                                                                                                                                                            |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Max Per-Host Resource Reservation: Memory=99.00MB                                                                                                                                                                         |
| Per-Host Resource Estimates: Memory=855.00MB                                                                                                                                                                              |
| WARNING: The following tables are missing relevant table and/or column statistics.                                                                                                                                        |
| default.l_lineitem_parquet_impala, default.o_orders_parquet_impala                                                                                                                                                        |
|                                                                                                                                                                                                                           |
| PLAN-ROOT SINK                                                                                                                                                                                                            |
| |                                                                                                                                                                                                                         |
| 09:MERGING-EXCHANGE [UNPARTITIONED]                                                                                                                                                                                       |
| |  order by: l_shipmode ASC                                                                                                                                                                                               |
| |                                                                                                                                                                                                                         |
| 04:SORT                                                                                                                                                                                                                   |
| |  order by: l_shipmode ASC                                                                                                                                                                                               |
| |                                                                                                                                                                                                                         |
| 08:AGGREGATE [FINALIZE]                                                                                                                                                                                                   |
| |  output: sum:merge(CASE WHEN o_orderpriority IN ('1-URGENT', '2-HIGH') THEN 1 ELSE 0 END), sum:merge(CASE WHEN o_orderpriority != '1-URGENT' AND o_orderpriority != '2-HIGH' THEN 1 ELSE 0 END)                         |
| |  group by: l_shipmode                                                                                                                                                                                                   |
| |                                                                                                                                                                                                                         |
| 07:EXCHANGE [HASH(l_shipmode)]                                                                                                                                                                                            |
| |                                                                                                                                                                                                                         |
| 03:AGGREGATE [STREAMING]                                                                                                                                                                                                  |
| |  output: sum(CASE WHEN o_orderpriority IN ('1-URGENT', '2-HIGH') THEN 1 ELSE 0 END), sum(CASE WHEN o_orderpriority != '1-URGENT' AND o_orderpriority != '2-HIGH' THEN 1 ELSE 0 END)                                     |
| |  group by: l_shipmode                                                                                                                                                                                                   |
| |                                                                                                                                                                                                                         |
| 02:HASH JOIN [INNER JOIN, PARTITIONED]                                                                                                                                                                                    |
| |  hash predicates: l_orderkey = o_orderkey                                                                                                                                                                               |
| |  runtime filters: RF000 <- o_orderkey                                                                                                                                                                                   |
| |                                                                                                                                                                                                                         |
| |--06:EXCHANGE [HASH(o_orderkey)]                                                                                                                                                                                         |
| |  |                                                                                                                                                                                                                      |
| |  00:SCAN HDFS [default.o_orders_parquet_impala]                                                                                                                                                                         |
| |     partitions=1/1 files=2 size=111.36MB                                                                                                                                                                                |
| |                                                                                                                                                                                                                         |
| 05:EXCHANGE [HASH(l_orderkey)]                                                                                                                                                                                            |
| |                                                                                                                                                                                                                         |
| 01:SCAN HDFS [default.l_lineitem_parquet_impala]                                                                                                                                                                          |
|    partitions=1/1 files=3 size=381.40MB                                                                                                                                                                                   |
|    predicates: l_shipmode IN ('MAIL', 'SHIP'), to_date(l_receiptdate) < '1995-01-01', to_date(l_receiptdate) >= '1994-01-01', to_date(l_commitdate) < to_date(l_receiptdate), to_date(l_shipdate) < to_date(l_commitdate) |
|    runtime filters: RF000 -> l_orderkey                                                                                                                                                                                   |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
Fetched 38 row(s) in 0.02s
15/04/2019 16:00:32.725
--------------------------------------Finished QUERY 12.----------------------------------

--------------------------------------STARTED  QUERY 13. ---------------------------------
15/04/2019 16:00:32.734
Starting Impala Shell without Kerberos authentication
Connected to b05cdd87a09f:21000
Server version: impalad version 2.12.0-cdh5.16.1 RELEASE (build 4a3775ef6781301af81b23bca45a9faeca5e761d)
Query: explain select c_count, count(*) as custdist  from ( select c_custkey,count(o_orderkey) as c_count from c_customer_parquet_impala  left outer join o_orders_parquet_impala  on c_custkey = o_custkey and o_comment not like '%special%requests%' group by c_custkey) as c_orders group by c_count order by custdist desc, c_count desc
+------------------------------------------------------------------------------------+
| Explain String                                                                     |
+------------------------------------------------------------------------------------+
| Max Per-Host Resource Reservation: Memory=114.75MB                                 |
| Per-Host Resource Estimates: Memory=620.75MB                                       |
| WARNING: The following tables are missing relevant table and/or column statistics. |
| default.c_customer_parquet_impala, default.o_orders_parquet_impala                 |
|                                                                                    |
| PLAN-ROOT SINK                                                                     |
| |                                                                                  |
| 10:MERGING-EXCHANGE [UNPARTITIONED]                                                |
| |  order by: count(*) DESC, c_count DESC                                           |
| |                                                                                  |
| 05:SORT                                                                            |
| |  order by: count(*) DESC, c_count DESC                                           |
| |                                                                                  |
| 09:AGGREGATE [FINALIZE]                                                            |
| |  output: count:merge(*)                                                          |
| |  group by: c_count                                                               |
| |                                                                                  |
| 08:EXCHANGE [HASH(c_count)]                                                        |
| |                                                                                  |
| 04:AGGREGATE [STREAMING]                                                           |
| |  output: count(*)                                                                |
| |  group by: count(o_orderkey)                                                     |
| |                                                                                  |
| 03:AGGREGATE [FINALIZE]                                                            |
| |  output: count(o_orderkey)                                                       |
| |  group by: c_custkey                                                             |
| |                                                                                  |
| 02:HASH JOIN [RIGHT OUTER JOIN, PARTITIONED]                                       |
| |  hash predicates: o_custkey = c_custkey                                          |
| |  runtime filters: RF000 <- c_custkey                                             |
| |                                                                                  |
| |--07:EXCHANGE [HASH(c_custkey)]                                                   |
| |  |                                                                               |
| |  00:SCAN HDFS [default.c_customer_parquet_impala]                                |
| |     partitions=1/1 files=1 size=23.54MB                                          |
| |                                                                                  |
| 06:EXCHANGE [HASH(o_custkey)]                                                      |
| |                                                                                  |
| 01:SCAN HDFS [default.o_orders_parquet_impala]                                     |
|    partitions=1/1 files=2 size=111.36MB                                            |
|    predicates: NOT o_comment LIKE '%special%requests%'                             |
|    runtime filters: RF000 -> o_custkey                                             |
+------------------------------------------------------------------------------------+
Fetched 42 row(s) in 0.01s
15/04/2019 16:00:32.936
--------------------------------------Finished QUERY 13.----------------------------------

--------------------------------------STARTED  QUERY 14. ---------------------------------
15/04/2019 16:00:32.945
Starting Impala Shell without Kerberos authentication
Connected to b05cdd87a09f:21000
Server version: impalad version 2.12.0-cdh5.16.1 RELEASE (build 4a3775ef6781301af81b23bca45a9faeca5e761d)
Query: explain select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice*(1-l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from l_lineitem_parquet_impala, p_part_parquet_impala where l_partkey = p_partkey and to_date(l_shipdate) >= to_date('1995-09-01') and to_date(l_shipdate) < to_date(date_add(cast('1995-09-01' as timestamp), interval 1 month))
+--------------------------------------------------------------------------------------------------------------------------------------------------------+
| Explain String                                                                                                                                         |
+--------------------------------------------------------------------------------------------------------------------------------------------------------+
| Max Per-Host Resource Reservation: Memory=4.88MB                                                                                                       |
| Per-Host Resource Estimates: Memory=424.88MB                                                                                                           |
| WARNING: The following tables are missing relevant table and/or column statistics.                                                                     |
| default.l_lineitem_parquet_impala, default.p_part_parquet_impala                                                                                       |
|                                                                                                                                                        |
| PLAN-ROOT SINK                                                                                                                                         |
| |                                                                                                                                                      |
| 07:AGGREGATE [FINALIZE]                                                                                                                                |
| |  output: sum:merge(CASE WHEN p_type LIKE 'PROMO%' THEN l_extendedprice * (1 - l_discount) ELSE 0 END), sum:merge(l_extendedprice * (1 - l_discount)) |
| |                                                                                                                                                      |
| 06:EXCHANGE [UNPARTITIONED]                                                                                                                            |
| |                                                                                                                                                      |
| 03:AGGREGATE                                                                                                                                           |
| |  output: sum(CASE WHEN p_type LIKE 'PROMO%' THEN l_extendedprice * (1 - l_discount) ELSE 0 END), sum(l_extendedprice * (1 - l_discount))             |
| |                                                                                                                                                      |
| 02:HASH JOIN [INNER JOIN, PARTITIONED]                                                                                                                 |
| |  hash predicates: l_partkey = p_partkey                                                                                                              |
| |  runtime filters: RF000 <- p_partkey                                                                                                                 |
| |                                                                                                                                                      |
| |--05:EXCHANGE [HASH(p_partkey)]                                                                                                                       |
| |  |                                                                                                                                                   |
| |  01:SCAN HDFS [default.p_part_parquet_impala]                                                                                                        |
| |     partitions=1/1 files=1 size=13.20MB                                                                                                              |
| |                                                                                                                                                      |
| 04:EXCHANGE [HASH(l_partkey)]                                                                                                                          |
| |                                                                                                                                                      |
| 00:SCAN HDFS [default.l_lineitem_parquet_impala]                                                                                                       |
|    partitions=1/1 files=3 size=381.40MB                                                                                                                |
|    predicates: to_date(l_shipdate) < '1995-10-01', to_date(l_shipdate) >= '1995-09-01'                                                                 |
|    runtime filters: RF000 -> l_partkey                                                                                                                 |
+--------------------------------------------------------------------------------------------------------------------------------------------------------+
Fetched 30 row(s) in 0.01s
15/04/2019 16:00:33.152
--------------------------------------Finished QUERY 14.----------------------------------

--------------------------------------STARTED  QUERY 15. ---------------------------------
15/04/2019 16:00:33.161
Starting Impala Shell without Kerberos authentication
Connected to b05cdd87a09f:21000
Server version: impalad version 2.12.0-cdh5.16.1 RELEASE (build 4a3775ef6781301af81b23bca45a9faeca5e761d)
Query: explain create view v_revenue (supplier_no, total_revenue) as select l_suppkey, sum(l_extendedprice * (1 - l_discount)) from l_lineitem_parquet_impala where to_date(l_shipdate) >= to_date('1996-01-01') and to_date(l_shipdate) < to_date(date_add(cast('1996-01-01' as timestamp), interval 3 month)) group by l_suppkey
ERROR: AnalysisException: Syntax error in line 1:
explain create view v_revenue (supplier_no,...
               ^
Encountered: VIEW
Expected: EXTERNAL, STRAIGHT_JOIN, TABLE

CAUSED BY: Exception: Syntax error

Could not execute command: explain create view v_revenue (supplier_no, total_revenue) as select l_suppkey, sum(l_extendedprice * (1 - l_discount)) from l_lineitem_parquet_impala where to_date(l_shipdate) >= to_date('1996-01-01') and to_date(l_shipdate) < to_date(date_add(cast('1996-01-01' as timestamp), interval 3 month)) group by l_suppkey
15/04/2019 16:00:33.355
--------------------------------------Finished QUERY 15.----------------------------------

--------------------------------------STARTED  QUERY 16. ---------------------------------
15/04/2019 16:00:33.363
Starting Impala Shell without Kerberos authentication
Connected to b05cdd87a09f:21000
Server version: impalad version 2.12.0-cdh5.16.1 RELEASE (build 4a3775ef6781301af81b23bca45a9faeca5e761d)
Query: explain select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from ps_partsupp_parquet_impala, p_part_parquet_impala where p_partkey = ps_partkey and p_brand <> 'Brand#45' and p_type not like 'MEDIUM POLISHED%'  and p_size in (49, 14, 23, 45, 19, 3, 36, 9) and ps_suppkey not in ( select s_suppkey from s_supplier_parquet_impala where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size limit 20000
+-----------------------------------------------------------------------------------------------------------------------+
| Explain String                                                                                                        |
+-----------------------------------------------------------------------------------------------------------------------+
| Max Per-Host Resource Reservation: Memory=141.06MB                                                                    |
| Per-Host Resource Estimates: Memory=821.86MB                                                                          |
| WARNING: The following tables are missing relevant table and/or column statistics.                                    |
| default.p_part_parquet_impala, default.ps_partsupp_parquet_impala, default.s_supplier_parquet_impala                  |
|                                                                                                                       |
| PLAN-ROOT SINK                                                                                                        |
| |                                                                                                                     |
| 14:MERGING-EXCHANGE [UNPARTITIONED]                                                                                   |
| |  order by: count(ps_suppkey) DESC, p_brand ASC, p_type ASC, p_size ASC                                              |
| |  limit: 20000                                                                                                       |
| |                                                                                                                     |
| 07:TOP-N [LIMIT=20000]                                                                                                |
| |  order by: count(ps_suppkey) DESC, p_brand ASC, p_type ASC, p_size ASC                                              |
| |                                                                                                                     |
| 13:AGGREGATE [FINALIZE]                                                                                               |
| |  output: count:merge(ps_suppkey)                                                                                    |
| |  group by: p_brand, p_type, p_size                                                                                  |
| |                                                                                                                     |
| 12:EXCHANGE [HASH(p_brand,p_type,p_size)]                                                                             |
| |                                                                                                                     |
| 06:AGGREGATE [STREAMING]                                                                                              |
| |  output: count(ps_suppkey)                                                                                          |
| |  group by: p_brand, p_type, p_size                                                                                  |
| |                                                                                                                     |
| 11:AGGREGATE                                                                                                          |
| |  group by: p_brand, p_type, p_size, ps_suppkey                                                                      |
| |                                                                                                                     |
| 10:EXCHANGE [HASH(p_brand,p_type,p_size,ps_suppkey)]                                                                  |
| |                                                                                                                     |
| 05:AGGREGATE [STREAMING]                                                                                              |
| |  group by: p_brand, p_type, p_size, ps_suppkey                                                                      |
| |                                                                                                                     |
| 04:HASH JOIN [NULL AWARE LEFT ANTI JOIN, BROADCAST]                                                                   |
| |  hash predicates: ps_suppkey = s_suppkey                                                                            |
| |                                                                                                                     |
| |--09:EXCHANGE [BROADCAST]                                                                                            |
| |  |                                                                                                                  |
| |  02:SCAN HDFS [default.s_supplier_parquet_impala]                                                                   |
| |     partitions=1/1 files=1 size=1.46MB                                                                              |
| |     predicates: s_comment LIKE '%Customer%Complaints%'                                                              |
| |                                                                                                                     |
| 03:HASH JOIN [INNER JOIN, BROADCAST]                                                                                  |
| |  hash predicates: ps_partkey = p_partkey                                                                            |
| |  runtime filters: RF000 <- p_partkey                                                                                |
| |                                                                                                                     |
| |--08:EXCHANGE [BROADCAST]                                                                                            |
| |  |                                                                                                                  |
| |  01:SCAN HDFS [default.p_part_parquet_impala]                                                                       |
| |     partitions=1/1 files=1 size=13.20MB                                                                             |
| |     predicates: p_brand != 'Brand#45', p_size IN (49, 14, 23, 45, 19, 3, 36, 9), NOT p_type LIKE 'MEDIUM POLISHED%' |
| |                                                                                                                     |
| 00:SCAN HDFS [default.ps_partsupp_parquet_impala]                                                                     |
|    partitions=1/1 files=1 size=107.99MB                                                                               |
|    runtime filters: RF000 -> ps_partkey                                                                               |
+-----------------------------------------------------------------------------------------------------------------------+
Fetched 54 row(s) in 0.02s
15/04/2019 16:00:33.587
--------------------------------------Finished QUERY 16.----------------------------------

--------------------------------------STARTED  QUERY 17. ---------------------------------
15/04/2019 16:00:33.595
Starting Impala Shell without Kerberos authentication
Connected to b05cdd87a09f:21000
Server version: impalad version 2.12.0-cdh5.16.1 RELEASE (build 4a3775ef6781301af81b23bca45a9faeca5e761d)
Query: explain select sum(l_extendedprice) / 7.0 as avg_yearly from l_lineitem_parquet_impala, p_part_parquet_impala where p_partkey = l_partkey and  p_brand = 'Brand#23' and p_container = 'MED BOX'  and l_quantity < ( select 0.2 * avg(l_quantity) from l_lineitem_parquet_impala where l_partkey = p_partkey )
+----------------------------------------------------------------------------------------------+
| Explain String                                                                               |
+----------------------------------------------------------------------------------------------+
| Max Per-Host Resource Reservation: Memory=110.94MB                                           |
| Per-Host Resource Estimates: Memory=820.94MB                                                 |
| WARNING: The following tables are missing relevant table and/or column statistics.           |
| default.l_lineitem_parquet_impala, default.p_part_parquet_impala                             |
|                                                                                              |
| PLAN-ROOT SINK                                                                               |
| |                                                                                            |
| 12:AGGREGATE [FINALIZE]                                                                      |
| |  output: sum:merge(l_extendedprice)                                                        |
| |                                                                                            |
| 11:EXCHANGE [UNPARTITIONED]                                                                  |
| |                                                                                            |
| 06:AGGREGATE                                                                                 |
| |  output: sum(l_extendedprice)                                                              |
| |                                                                                            |
| 05:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]                                                   |
| |  hash predicates: p_partkey = l_partkey                                                    |
| |  other join predicates: l_quantity < 0.2 * avg(l_quantity)                                 |
| |  runtime filters: RF000 <- l_partkey                                                       |
| |                                                                                            |
| |--09:AGGREGATE [FINALIZE]                                                                   |
| |  |  output: avg:merge(l_quantity)                                                          |
| |  |  group by: l_partkey                                                                    |
| |  |                                                                                         |
| |  08:EXCHANGE [HASH(l_partkey)]                                                             |
| |  |                                                                                         |
| |  03:AGGREGATE [STREAMING]                                                                  |
| |  |  output: avg(l_quantity)                                                                |
| |  |  group by: l_partkey                                                                    |
| |  |                                                                                         |
| |  02:SCAN HDFS [default.l_lineitem_parquet_impala]                                          |
| |     partitions=1/1 files=3 size=381.40MB                                                   |
| |                                                                                            |
| 10:EXCHANGE [HASH(p_partkey)]                                                                |
| |                                                                                            |
| 04:HASH JOIN [INNER JOIN, BROADCAST]                                                         |
| |  hash predicates: l_partkey = p_partkey                                                    |
| |  runtime filters: RF002 <- p_partkey                                                       |
| |                                                                                            |
| |--07:EXCHANGE [BROADCAST]                                                                   |
| |  |                                                                                         |
| |  01:SCAN HDFS [default.p_part_parquet_impala]                                              |
| |     partitions=1/1 files=1 size=13.20MB                                                    |
| |     predicates: p_container = 'MED BOX', p_brand = 'Brand#23'                              |
| |     runtime filters: RF000 -> p_partkey                                                    |
| |                                                                                            |
| 00:SCAN HDFS [default.l_lineitem_parquet_impala]                                             |
|    partitions=1/1 files=3 size=381.40MB                                                      |
|    runtime filters: RF000 -> default.l_lineitem_parquet_impala.l_partkey, RF002 -> l_partkey |
+----------------------------------------------------------------------------------------------+
Fetched 49 row(s) in 0.01s
15/04/2019 16:00:33.798
--------------------------------------Finished QUERY 17.----------------------------------

--------------------------------------STARTED  QUERY 18. ---------------------------------
15/04/2019 16:00:33.807
Starting Impala Shell without Kerberos authentication
Connected to b05cdd87a09f:21000
Server version: impalad version 2.12.0-cdh5.16.1 RELEASE (build 4a3775ef6781301af81b23bca45a9faeca5e761d)
Query: explain select c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) from c_customer_parquet_impala, o_orders_parquet_impala, l_lineitem_parquet_impala where o_orderkey in ( select l_orderkey from l_lineitem_parquet_impala group by l_orderkey having sum(l_quantity) > 300 ) and c_custkey = o_custkey and o_orderkey = l_orderkey group by c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice order by o_totalprice desc, o_orderdate limit 100
+-------------------------------------------------------------------------------------------------------+
| Explain String                                                                                        |
+-------------------------------------------------------------------------------------------------------+
| Max Per-Host Resource Reservation: Memory=205.50MB                                                    |
| Per-Host Resource Estimates: Memory=1.22GB                                                            |
| WARNING: The following tables are missing relevant table and/or column statistics.                    |
| default.c_customer_parquet_impala, default.l_lineitem_parquet_impala, default.o_orders_parquet_impala |
|                                                                                                       |
| PLAN-ROOT SINK                                                                                        |
| |                                                                                                     |
| 17:MERGING-EXCHANGE [UNPARTITIONED]                                                                   |
| |  order by: o_totalprice DESC, o_orderdate ASC                                                       |
| |  limit: 100                                                                                         |
| |                                                                                                     |
| 09:TOP-N [LIMIT=100]                                                                                  |
| |  order by: o_totalprice DESC, o_orderdate ASC                                                       |
| |                                                                                                     |
| 16:AGGREGATE [FINALIZE]                                                                               |
| |  output: sum:merge(l_quantity)                                                                      |
| |  group by: c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice                                 |
| |                                                                                                     |
| 15:EXCHANGE [HASH(c_name,c_custkey,o_orderkey,o_orderdate,o_totalprice)]                              |
| |                                                                                                     |
| 08:AGGREGATE [STREAMING]                                                                              |
| |  output: sum(l_quantity)                                                                            |
| |  group by: c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice                                 |
| |                                                                                                     |
| 07:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]                                                            |
| |  hash predicates: o_orderkey = l_orderkey                                                           |
| |  runtime filters: RF000 <- l_orderkey                                                               |
| |                                                                                                     |
| |--14:AGGREGATE [FINALIZE]                                                                            |
| |  |  output: sum:merge(l_quantity)                                                                   |
| |  |  group by: l_orderkey                                                                            |
| |  |  having: sum(l_quantity) > 300                                                                   |
| |  |                                                                                                  |
| |  13:EXCHANGE [HASH(l_orderkey)]                                                                     |
| |  |                                                                                                  |
| |  04:AGGREGATE [STREAMING]                                                                           |
| |  |  output: sum(l_quantity)                                                                         |
| |  |  group by: l_orderkey                                                                            |
| |  |                                                                                                  |
| |  03:SCAN HDFS [default.l_lineitem_parquet_impala]                                                   |
| |     partitions=1/1 files=3 size=381.40MB                                                            |
| |                                                                                                     |
| 06:HASH JOIN [INNER JOIN, BROADCAST]                                                                  |
| |  hash predicates: o_custkey = c_custkey                                                             |
| |  runtime filters: RF002 <- c_custkey                                                                |
| |                                                                                                     |
| |--12:EXCHANGE [BROADCAST]                                                                            |
| |  |                                                                                                  |
| |  00:SCAN HDFS [default.c_customer_parquet_impala]                                                   |
| |     partitions=1/1 files=1 size=23.54MB                                                             |
| |                                                                                                     |
| 05:HASH JOIN [INNER JOIN, PARTITIONED]                                                                |
| |  hash predicates: l_orderkey = o_orderkey                                                           |
| |  runtime filters: RF004 <- o_orderkey                                                               |
| |                                                                                                     |
| |--11:EXCHANGE [HASH(o_orderkey)]                                                                     |
| |  |                                                                                                  |
| |  01:SCAN HDFS [default.o_orders_parquet_impala]                                                     |
| |     partitions=1/1 files=2 size=111.36MB                                                            |
| |     runtime filters: RF000 -> o_orderkey, RF002 -> o_custkey                                        |
| |                                                                                                     |
| 10:EXCHANGE [HASH(l_orderkey)]                                                                        |
| |                                                                                                     |
| 02:SCAN HDFS [default.l_lineitem_parquet_impala]                                                      |
|    partitions=1/1 files=3 size=381.40MB                                                               |
|    runtime filters: RF000 -> default.l_lineitem_parquet_impala.l_orderkey, RF004 -> l_orderkey        |
+-------------------------------------------------------------------------------------------------------+
Fetched 66 row(s) in 0.02s
15/04/2019 16:00:34.017
--------------------------------------Finished QUERY 18.----------------------------------

--------------------------------------STARTED  QUERY 19. ---------------------------------
15/04/2019 16:00:34.026
Starting Impala Shell without Kerberos authentication
Connected to b05cdd87a09f:21000
Server version: impalad version 2.12.0-cdh5.16.1 RELEASE (build 4a3775ef6781301af81b23bca45a9faeca5e761d)
Query: explain select sum(l_extendedprice * (1 - l_discount) ) as revenue from l_lineitem_parquet_impala, p_part_parquet_impala where ( p_partkey = l_partkey and p_brand = 'Brand#12' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 1 and l_quantity <= 1 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#23' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#34' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 20 and l_quantity <= 20 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' )
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Explain String                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Max Per-Host Resource Reservation: Memory=2.94MB                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Per-Host Resource Estimates: Memory=646.94MB                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| WARNING: The following tables are missing relevant table and/or column statistics.                                                                                                                                                                                                                                                                                                                                                                                            |
| default.l_lineitem_parquet_impala, default.p_part_parquet_impala                                                                                                                                                                                                                                                                                                                                                                                                              |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| PLAN-ROOT SINK                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| |                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| 06:AGGREGATE [FINALIZE]                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| |  output: sum:merge(l_extendedprice * (1 - l_discount))                                                                                                                                                                                                                                                                                                                                                                                                                      |
| |                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| 05:EXCHANGE [UNPARTITIONED]                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| |                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| 03:AGGREGATE                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| |  output: sum(l_extendedprice * (1 - l_discount))                                                                                                                                                                                                                                                                                                                                                                                                                            |
| |                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| 02:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| |  hash predicates: l_partkey = p_partkey                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| |  other predicates: ((p_brand = 'Brand#12' AND p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') AND l_quantity >= 1 AND l_quantity <= 11 AND p_size <= 5) OR (p_brand = 'Brand#23' AND p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') AND l_quantity >= 10 AND l_quantity <= 20 AND p_size <= 10) OR (p_brand = 'Brand#34' AND p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') AND l_quantity >= 20 AND l_quantity <= 30 AND p_size <= 15)) |
| |  runtime filters: RF000 <- p_partkey                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| |                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| |--04:EXCHANGE [BROADCAST]                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| |  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| |  01:SCAN HDFS [default.p_part_parquet_impala]                                                                                                                                                                                                                                                                                                                                                                                                                               |
| |     partitions=1/1 files=1 size=13.20MB                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| |     predicates: p_size >= 1                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| |                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| 00:SCAN HDFS [default.l_lineitem_parquet_impala]                                                                                                                                                                                                                                                                                                                                                                                                                              |
|    partitions=1/1 files=3 size=381.40MB                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|    predicates: l_shipmode IN ('AIR', 'AIR REG'), l_shipinstruct = 'DELIVER IN PERSON'                                                                                                                                                                                                                                                                                                                                                                                         |
|    runtime filters: RF000 -> l_partkey                                                                                                                                                                                                                                                                                                                                                                                                                                        |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
Fetched 30 row(s) in 0.02s
15/04/2019 16:00:34.251
--------------------------------------Finished QUERY 19.----------------------------------

--------------------------------------STARTED  QUERY 20. ---------------------------------
15/04/2019 16:00:34.260
Starting Impala Shell without Kerberos authentication
Connected to b05cdd87a09f:21000
Server version: impalad version 2.12.0-cdh5.16.1 RELEASE (build 4a3775ef6781301af81b23bca45a9faeca5e761d)
Query: explain select s_name, s_address from s_supplier_parquet_impala, n_nation_parquet_impala where s_suppkey in ( select ps_suppkey from ps_partsupp_parquet_impala where ps_partkey in ( select p_partkey from p_part_parquet_impala where p_name like 'forest%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from l_lineitem_parquet_impala where l_partkey = ps_partkey and l_suppkey = ps_suppkey and to_date(l_shipdate) >= to_date('1994-01-01') and to_date(l_shipdate) < to_date(date_add(cast('1994-01-01' as timestamp), interval 1 year)) ) ) and s_nationkey = n_nationkey and n_name = 'CANADA' order by s_name
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Explain String                                                                                                                                                                       |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Max Per-Host Resource Reservation: Memory=128.81MB                                                                                                                                   |
| Per-Host Resource Estimates: Memory=1.05GB                                                                                                                                           |
| WARNING: The following tables are missing relevant table and/or column statistics.                                                                                                   |
| default.l_lineitem_parquet_impala, default.n_nation_parquet_impala, default.p_part_parquet_impala, default.ps_partsupp_parquet_impala, default.s_supplier_parquet_impala             |
|                                                                                                                                                                                      |
| PLAN-ROOT SINK                                                                                                                                                                       |
| |                                                                                                                                                                                    |
| 18:MERGING-EXCHANGE [UNPARTITIONED]                                                                                                                                                  |
| |  order by: s_name ASC                                                                                                                                                              |
| |                                                                                                                                                                                    |
| 10:SORT                                                                                                                                                                              |
| |  order by: s_name ASC                                                                                                                                                              |
| |                                                                                                                                                                                    |
| 09:HASH JOIN [RIGHT SEMI JOIN, PARTITIONED]                                                                                                                                          |
| |  hash predicates: ps_suppkey = s_suppkey                                                                                                                                           |
| |  runtime filters: RF000 <- s_suppkey                                                                                                                                               |
| |                                                                                                                                                                                    |
| |--17:EXCHANGE [HASH(s_suppkey)]                                                                                                                                                     |
| |  |                                                                                                                                                                                 |
| |  08:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                                                              |
| |  |  hash predicates: s_nationkey = n_nationkey                                                                                                                                     |
| |  |  runtime filters: RF008 <- n_nationkey                                                                                                                                          |
| |  |                                                                                                                                                                                 |
| |  |--15:EXCHANGE [BROADCAST]                                                                                                                                                        |
| |  |  |                                                                                                                                                                              |
| |  |  01:SCAN HDFS [default.n_nation_parquet_impala]                                                                                                                                 |
| |  |     partitions=1/1 files=1 size=3.25KB                                                                                                                                          |
| |  |     predicates: n_name = 'CANADA'                                                                                                                                               |
| |  |                                                                                                                                                                                 |
| |  00:SCAN HDFS [default.s_supplier_parquet_impala]                                                                                                                                  |
| |     partitions=1/1 files=1 size=1.46MB                                                                                                                                             |
| |     runtime filters: RF008 -> s_nationkey                                                                                                                                          |
| |                                                                                                                                                                                    |
| 16:EXCHANGE [HASH(ps_suppkey)]                                                                                                                                                       |
| |                                                                                                                                                                                    |
| 07:HASH JOIN [RIGHT SEMI JOIN, PARTITIONED]                                                                                                                                          |
| |  hash predicates: l_partkey = ps_partkey, l_suppkey = ps_suppkey                                                                                                                   |
| |  other join predicates: ps_availqty > 0.5 * sum(l_quantity)                                                                                                                        |
| |  runtime filters: RF002 <- ps_partkey, RF003 <- ps_suppkey                                                                                                                         |
| |                                                                                                                                                                                    |
| |--14:EXCHANGE [HASH(ps_partkey,ps_suppkey)]                                                                                                                                         |
| |  |                                                                                                                                                                                 |
| |  06:HASH JOIN [LEFT SEMI JOIN, BROADCAST]                                                                                                                                          |
| |  |  hash predicates: ps_partkey = p_partkey                                                                                                                                        |
| |  |  runtime filters: RF006 <- p_partkey                                                                                                                                            |
| |  |                                                                                                                                                                                 |
| |  |--13:EXCHANGE [BROADCAST]                                                                                                                                                        |
| |  |  |                                                                                                                                                                              |
| |  |  03:SCAN HDFS [default.p_part_parquet_impala]                                                                                                                                   |
| |  |     partitions=1/1 files=1 size=13.20MB                                                                                                                                         |
| |  |     predicates: p_name LIKE 'forest%'                                                                                                                                           |
| |  |                                                                                                                                                                                 |
| |  02:SCAN HDFS [default.ps_partsupp_parquet_impala]                                                                                                                                 |
| |     partitions=1/1 files=1 size=107.99MB                                                                                                                                           |
| |     runtime filters: RF000 -> ps_suppkey, RF006 -> ps_partkey                                                                                                                      |
| |                                                                                                                                                                                    |
| 12:AGGREGATE [FINALIZE]                                                                                                                                                              |
| |  output: sum:merge(l_quantity)                                                                                                                                                     |
| |  group by: l_partkey, l_suppkey                                                                                                                                                    |
| |                                                                                                                                                                                    |
| 11:EXCHANGE [HASH(l_partkey,l_suppkey)]                                                                                                                                              |
| |                                                                                                                                                                                    |
| 05:AGGREGATE [STREAMING]                                                                                                                                                             |
| |  output: sum(l_quantity)                                                                                                                                                           |
| |  group by: l_partkey, l_suppkey                                                                                                                                                    |
| |                                                                                                                                                                                    |
| 04:SCAN HDFS [default.l_lineitem_parquet_impala]                                                                                                                                     |
|    partitions=1/1 files=3 size=381.40MB                                                                                                                                              |
|    predicates: to_date(l_shipdate) < '1995-01-01', to_date(l_shipdate) >= '1994-01-01'                                                                                               |
|    runtime filters: RF000 -> default.l_lineitem_parquet_impala.l_suppkey, RF002 -> default.l_lineitem_parquet_impala.l_partkey, RF003 -> default.l_lineitem_parquet_impala.l_suppkey |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
Fetched 70 row(s) in 0.02s
15/04/2019 16:00:34.478
--------------------------------------Finished QUERY 20.----------------------------------

--------------------------------------STARTED  QUERY 21. ---------------------------------
15/04/2019 16:00:34.487
Starting Impala Shell without Kerberos authentication
Connected to b05cdd87a09f:21000
Server version: impalad version 2.12.0-cdh5.16.1 RELEASE (build 4a3775ef6781301af81b23bca45a9faeca5e761d)
Query: explain select s_name, count(*) as numwait from s_supplier_parquet_impala, l_lineitem_parquet_impala l1, o_orders_parquet_impala, n_nation_parquet_impala where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from l_lineitem_parquet_impala l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from l_lineitem_parquet_impala l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'SAUDI ARABIA' group by s_name order by numwait desc, s_name limit 100
+----------------------------------------------------------------------------------------------------------------------------------------+
| Explain String                                                                                                                         |
+----------------------------------------------------------------------------------------------------------------------------------------+
| Max Per-Host Resource Reservation: Memory=128.88MB                                                                                     |
| Per-Host Resource Estimates: Memory=1.37GB                                                                                             |
| WARNING: The following tables are missing relevant table and/or column statistics.                                                     |
| default.l_lineitem_parquet_impala, default.n_nation_parquet_impala, default.o_orders_parquet_impala, default.s_supplier_parquet_impala |
|                                                                                                                                        |
| PLAN-ROOT SINK                                                                                                                         |
| |                                                                                                                                      |
| 21:MERGING-EXCHANGE [UNPARTITIONED]                                                                                                    |
| |  order by: count(*) DESC, s_name ASC                                                                                                 |
| |  limit: 100                                                                                                                          |
| |                                                                                                                                      |
| 12:TOP-N [LIMIT=100]                                                                                                                   |
| |  order by: count(*) DESC, s_name ASC                                                                                                 |
| |                                                                                                                                      |
| 20:AGGREGATE [FINALIZE]                                                                                                                |
| |  output: count:merge(*)                                                                                                              |
| |  group by: s_name                                                                                                                    |
| |                                                                                                                                      |
| 19:EXCHANGE [HASH(s_name)]                                                                                                             |
| |                                                                                                                                      |
| 11:AGGREGATE [STREAMING]                                                                                                               |
| |  output: count(*)                                                                                                                    |
| |  group by: s_name                                                                                                                    |
| |                                                                                                                                      |
| 10:HASH JOIN [LEFT ANTI JOIN, PARTITIONED]                                                                                             |
| |  hash predicates: l1.l_orderkey = l3.l_orderkey                                                                                      |
| |  other join predicates: l3.l_suppkey != l1.l_suppkey                                                                                 |
| |                                                                                                                                      |
| |--18:EXCHANGE [HASH(l3.l_orderkey)]                                                                                                   |
| |  |                                                                                                                                   |
| |  05:SCAN HDFS [default.l_lineitem_parquet_impala l3]                                                                                 |
| |     partitions=1/1 files=3 size=381.40MB                                                                                             |
| |     predicates: l3.l_receiptdate > l3.l_commitdate                                                                                   |
| |                                                                                                                                      |
| 09:HASH JOIN [RIGHT SEMI JOIN, PARTITIONED]                                                                                            |
| |  hash predicates: l2.l_orderkey = l1.l_orderkey                                                                                      |
| |  other join predicates: l2.l_suppkey != l1.l_suppkey                                                                                 |
| |  runtime filters: RF000 <- l1.l_orderkey                                                                                             |
| |                                                                                                                                      |
| |--17:EXCHANGE [HASH(l1.l_orderkey)]                                                                                                   |
| |  |                                                                                                                                   |
| |  08:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                |
| |  |  hash predicates: s_nationkey = n_nationkey                                                                                       |
| |  |  runtime filters: RF002 <- n_nationkey                                                                                            |
| |  |                                                                                                                                   |
| |  |--15:EXCHANGE [BROADCAST]                                                                                                          |
| |  |  |                                                                                                                                |
| |  |  03:SCAN HDFS [default.n_nation_parquet_impala]                                                                                   |
| |  |     partitions=1/1 files=1 size=3.25KB                                                                                            |
| |  |     predicates: n_name = 'SAUDI ARABIA'                                                                                           |
| |  |                                                                                                                                   |
| |  07:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                |
| |  |  hash predicates: l1.l_orderkey = o_orderkey                                                                                      |
| |  |  runtime filters: RF004 <- o_orderkey                                                                                             |
| |  |                                                                                                                                   |
| |  |--14:EXCHANGE [BROADCAST]                                                                                                          |
| |  |  |                                                                                                                                |
| |  |  02:SCAN HDFS [default.o_orders_parquet_impala]                                                                                   |
| |  |     partitions=1/1 files=2 size=111.36MB                                                                                          |
| |  |     predicates: o_orderstatus = 'F'                                                                                               |
| |  |                                                                                                                                   |
| |  06:HASH JOIN [INNER JOIN, BROADCAST]                                                                                                |
| |  |  hash predicates: l1.l_suppkey = s_suppkey                                                                                        |
| |  |  runtime filters: RF006 <- s_suppkey                                                                                              |
| |  |                                                                                                                                   |
| |  |--13:EXCHANGE [BROADCAST]                                                                                                          |
| |  |  |                                                                                                                                |
| |  |  00:SCAN HDFS [default.s_supplier_parquet_impala]                                                                                 |
| |  |     partitions=1/1 files=1 size=1.46MB                                                                                            |
| |  |     runtime filters: RF002 -> s_nationkey                                                                                         |
| |  |                                                                                                                                   |
| |  01:SCAN HDFS [default.l_lineitem_parquet_impala l1]                                                                                 |
| |     partitions=1/1 files=3 size=381.40MB                                                                                             |
| |     predicates: l1.l_receiptdate > l1.l_commitdate                                                                                   |
| |     runtime filters: RF004 -> l1.l_orderkey, RF006 -> l1.l_suppkey                                                                   |
| |                                                                                                                                      |
| 16:EXCHANGE [HASH(l2.l_orderkey)]                                                                                                      |
| |                                                                                                                                      |
| 04:SCAN HDFS [default.l_lineitem_parquet_impala l2]                                                                                    |
|    partitions=1/1 files=3 size=381.40MB                                                                                                |
|    runtime filters: RF000 -> l2.l_orderkey                                                                                             |
+----------------------------------------------------------------------------------------------------------------------------------------+
Fetched 81 row(s) in 0.02s
15/04/2019 16:00:34.709
--------------------------------------Finished QUERY 21.----------------------------------

--------------------------------------STARTED  QUERY 22. ---------------------------------
15/04/2019 16:00:34.718
Starting Impala Shell without Kerberos authentication
Connected to b05cdd87a09f:21000
Server version: impalad version 2.12.0-cdh5.16.1 RELEASE (build 4a3775ef6781301af81b23bca45a9faeca5e761d)
Query: explain select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone, 1,2) as cntrycode, c_acctbal from c_customer_parquet_impala where substring (c_phone,1,2) in ('13','31','23','29','30','18','17') and c_acctbal > ( select avg(c_acctbal) from c_customer_parquet_impala where c_acctbal > 0.00 and substring (c_phone,1,2) in ('13','31','23','29','30','18','17') ) and not exists ( select * from o_orders_parquet_impala where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode
+---------------------------------------------------------------------------------------------------------------+
| Explain String                                                                                                |
+---------------------------------------------------------------------------------------------------------------+
| Max Per-Host Resource Reservation: Memory=81.94MB                                                             |
| Per-Host Resource Estimates: Memory=513.94MB                                                                  |
| WARNING: The following tables are missing relevant table and/or column statistics.                            |
| default.c_customer_parquet_impala, default.o_orders_parquet_impala                                            |
|                                                                                                               |
| PLAN-ROOT SINK                                                                                                |
| |                                                                                                             |
| 15:MERGING-EXCHANGE [UNPARTITIONED]                                                                           |
| |  order by: cntrycode ASC                                                                                    |
| |                                                                                                             |
| 07:SORT                                                                                                       |
| |  order by: cntrycode ASC                                                                                    |
| |                                                                                                             |
| 14:AGGREGATE [FINALIZE]                                                                                       |
| |  output: count:merge(*), sum:merge(c_acctbal)                                                               |
| |  group by: cntrycode                                                                                        |
| |                                                                                                             |
| 13:EXCHANGE [HASH(cntrycode)]                                                                                 |
| |                                                                                                             |
| 06:AGGREGATE [STREAMING]                                                                                      |
| |  output: count(*), sum(c_acctbal)                                                                           |
| |  group by: substring(c_phone, 1, 2)                                                                         |
| |                                                                                                             |
| 05:HASH JOIN [RIGHT ANTI JOIN, PARTITIONED]                                                                   |
| |  hash predicates: o_custkey = c_custkey                                                                     |
| |                                                                                                             |
| |--12:EXCHANGE [HASH(c_custkey)]                                                                              |
| |  |                                                                                                          |
| |  04:NESTED LOOP JOIN [INNER JOIN, BROADCAST]                                                                |
| |  |  predicates: c_acctbal > avg(c_acctbal)                                                                  |
| |  |                                                                                                          |
| |  |--10:EXCHANGE [BROADCAST]                                                                                 |
| |  |  |                                                                                                       |
| |  |  09:AGGREGATE [FINALIZE]                                                                                 |
| |  |  |  output: avg:merge(c_acctbal)                                                                         |
| |  |  |                                                                                                       |
| |  |  08:EXCHANGE [UNPARTITIONED]                                                                             |
| |  |  |                                                                                                       |
| |  |  02:AGGREGATE                                                                                            |
| |  |  |  output: avg(c_acctbal)                                                                               |
| |  |  |                                                                                                       |
| |  |  01:SCAN HDFS [default.c_customer_parquet_impala]                                                        |
| |  |     partitions=1/1 files=1 size=23.54MB                                                                  |
| |  |     predicates: c_acctbal > 0.00, substring(c_phone, 1, 2) IN ('13', '31', '23', '29', '30', '18', '17') |
| |  |                                                                                                          |
| |  00:SCAN HDFS [default.c_customer_parquet_impala]                                                           |
| |     partitions=1/1 files=1 size=23.54MB                                                                     |
| |     predicates: substring(c_phone, 1, 2) IN ('13', '31', '23', '29', '30', '18', '17')                      |
| |                                                                                                             |
| 11:EXCHANGE [HASH(o_custkey)]                                                                                 |
| |                                                                                                             |
| 03:SCAN HDFS [default.o_orders_parquet_impala]                                                                |
|    partitions=1/1 files=2 size=111.36MB                                                                       |
+---------------------------------------------------------------------------------------------------------------+
Fetched 53 row(s) in 0.02s
15/04/2019 16:00:34.940
--------------------------------------Finished QUERY 22.----------------------------------

15/04/2019 16:00:34.947
